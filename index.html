<!DOCTYPE html><html lang="en | zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Jocelyn's Blog</title><meta name="author" content="yilingzhang"><meta name="copyright" content="yilingzhang"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Every Day is My Day">
<meta property="og:type" content="website">
<meta property="og:title" content="Jocelyn&#39;s Blog">
<meta property="og:url" content="http://yilingzhang.gitee.io/index.html">
<meta property="og:site_name" content="Jocelyn&#39;s Blog">
<meta property="og:description" content="Every Day is My Day">
<meta property="og:locale">
<meta property="og:image" content="http://yilingzhang.gitee.io/img/selfie.JPG">
<meta property="article:author" content="yilingzhang">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://yilingzhang.gitee.io/img/selfie.JPG"><link rel="shortcut icon" href="/img/love_32px.png"><link rel="canonical" href="http://yilingzhang.gitee.io/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'Just',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = { 
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2021-04-16 13:48:58'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    })(window)</script><meta name="generator" content="Hexo 5.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="/img/selfie.JPG" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">24</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">12</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">12</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" target="_blank" rel="noopener" href="https://music.apple.com/cn/playlist/fav/pl.u-yZyVEjrFYkEpKjk"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page" target="_blank" rel="noopener" href="https://ohmyphotography.lofter.com/"><i class="fa-fw fas fa-video"></i><span> Gallery</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="page" id="body-wrap"><header class="full_page" id="page-header" style="background-image: url('/img/banner/homepage_pic.JPG')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Jocelyn's Blog</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> List</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" target="_blank" rel="noopener" href="https://music.apple.com/cn/playlist/fav/pl.u-yZyVEjrFYkEpKjk"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page" target="_blank" rel="noopener" href="https://ohmyphotography.lofter.com/"><i class="fa-fw fas fa-video"></i><span> Gallery</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="site-info"><h1 id="site-title">Jocelyn's Blog</h1><div id="site-subtitle"><span id="subtitle"></span></div><div id="site_social_icons"><a class="social-icon" href="mailto:jocelynzhang1119@icloud.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="https://blog.csdn.net/weixin_43893431" target="_blank" title="CSDN"><i class="fas fa-paper-plane"></i></a></div></div><div id="scroll-down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2021/04/13/Stat-03-Non-Negative-Matrix-Factorization/" title="Stat-03-Non-Negative Matrix Factorization">     <img class="post_bg" src="/img/banner/paofu.JPG" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Stat-03-Non-Negative Matrix Factorization"></a></div><div class="recent-post-info"><a class="article-title" href="/2021/04/13/Stat-03-Non-Negative-Matrix-Factorization/" title="Stat-03-Non-Negative Matrix Factorization">Stat-03-Non-Negative Matrix Factorization</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2021-04-13T01:02:11.000Z" title="Created 2021-04-13 09:02:11">2021-04-13</time></span></div><div class="content">Non-negative matrix factorization非负矩阵分解(Non-negative matrix factorization, NMF)是在矩阵中所有元素均为非负数约束条件下的矩阵分解方法。

基本思想：给定一个非负矩阵V，NMF能找到一个非负矩阵W和一个非负矩阵H，使得矩阵W和H的乘积近似等于矩阵V中的值




W矩阵：基础图象矩阵（基矩阵，特征矩阵），相当于从原矩阵V中抽取出来的特征
H矩阵：系数矩阵
≈：目前暂时无法做到完全相等
因为是约等于，存在损失函数E（V = WH+E，最优化E = min|V-WH|)

实质是一个优化问题，通过一定的优化方法来求解特征矩阵W和系数矩阵H加权和原理上等效为线性方程组
应用特征学习聚类比K-means算法更优之处为：NMF是一种软聚类（一个元素可被分为多种类型）
</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2021/04/12/Phrase-for-Response-Letter/" title="Phrase for Response Letter">     <img class="post_bg" src="/img/cover/responseletter.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Phrase for Response Letter"></a></div><div class="recent-post-info"><a class="article-title" href="/2021/04/12/Phrase-for-Response-Letter/" title="Phrase for Response Letter">Phrase for Response Letter</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2021-04-12T00:03:31.000Z" title="Created 2021-04-12 08:03:31">2021-04-12</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Records/">Records</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/Tips/">Tips</a></span></div><div class="content">
According to the associate editor and reviewers’ comments, we have made extensive modifications to our manuscript and supplemented extra data to make our results convincing.

In this revised version, changes to our manuscript were all highlighted within the document by using red colored text.

Thank you for your nice comments on our article. According to your suggestions, we have supplemented several data here and corrected several mistakes in our previous draft. Based on your comments, we also ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2021/04/10/Git-love-RProject-push-your-project-to-Github-Gitee/" title="Git love RProject--push your project to Github/Gitee!">     <img class="post_bg" src="/img/cover/Rgit.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Git love RProject--push your project to Github/Gitee!"></a></div><div class="recent-post-info"><a class="article-title" href="/2021/04/10/Git-love-RProject-push-your-project-to-Github-Gitee/" title="Git love RProject--push your project to Github/Gitee!">Git love RProject--push your project to Github/Gitee!</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2021-04-10T03:19:29.000Z" title="Created 2021-04-10 11:19:29">2021-04-10</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/toolsLearning/">toolsLearning</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/Git/">Git</a></span></div><div class="content">
  p{
    font-size:18px;
    line-height:1.7em;

  }


R project
为什么要用R project：乱七八糟随手新建脚本的习惯该改掉了!想找以前代码的时候真的想哭！！
git：菜鸡终于发现了git的妙用了！把自己的项目整个推送到github/gitee上，然后但凡修改都能找到前后对比，改错了也能及时改回来

R project的结构123456789101112131415└── my_project├── src # 这部分用来装R函数或者其他的可执行文件│ ├── bin # 可执行文件或者外程序包比如java包│ └── scripts # R函数脚本├── output # 输出数据 ignore├── data # 数据文件，你不会想把这个上传git的，进.gitignore│ ├── raw # 原始数据 ignore│ └── processed #中间文件 ignore├── reports # 报告，保存一些rmd生成的pdf/ppt，再也不用担心我的进展汇报啦├── README.md # 项目简介├── ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2021/04/08/scATAC-seq-Analysis/" title="scATAC-seq Analysis">     <img class="post_bg" src="/img/cover/scATAC.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="scATAC-seq Analysis"></a></div><div class="recent-post-info"><a class="article-title" href="/2021/04/08/scATAC-seq-Analysis/" title="scATAC-seq Analysis">scATAC-seq Analysis</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2021-04-08T11:01:25.000Z" title="Created 2021-04-08 19:01:25">2021-04-08</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Single-Cell/">Single Cell</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/scATAC-seq/">scATAC-seq</a></span></div><div class="content">教程：http://xuzhougeng.top/tags/atac-seq
ArchR install1234567891011conda create -n ArchRsource activate ArchRconda install -c conda-forge r-base ###R version 4.0.3if (!requireNamespace(&quot;devtools&quot;, quietly = TRUE)) install.packages(&quot;devtools&quot;)if (!requireNamespace(&quot;BiocManager&quot;, quietly = TRUE)) install.packages(&quot;BiocManager&quot;)devtools::install_github(&quot;GreenleafLab/ArchR&quot;, ref=&quot;master&quot;, repos = BiocManager::repositories())library(ArchR)Arch ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2021/04/06/TOEFL-writing-05/" title="TOEFL-writing-05">     <img class="post_bg" src="/img/cover/TOEFL-writing-04.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="TOEFL-writing-05"></a></div><div class="recent-post-info"><a class="article-title" href="/2021/04/06/TOEFL-writing-05/" title="TOEFL-writing-05">TOEFL-writing-05</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2021-04-06T00:48:39.000Z" title="Created 2021-04-06 08:48:39">2021-04-06</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/TOEFL-Writing/">TOEFL-Writing</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/TOEFL/">TOEFL</a></span></div><div class="content">
  p{
    font-size:18px;
    line-height:1.7em;

  }

九大话题
教育类学生层面
教室内：
academic learning(more knowledge, trigger interest)


教室外:
skils(interpersonal skills, time management skills);
qualities(independent, persistent)
professional development(locate careers, promote)



例题：Schools should require young children (aged 5-11) to work together in a small group instead of working alone during the process of learning many actvitles.
小组合作：

academic learningmore knowledge, trigger interest
personal de ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2021/04/04/conda-mamba-Installation/" title="conda/mamba Installation">     <img class="post_bg" src="/img/cover/conda.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="conda/mamba Installation"></a></div><div class="recent-post-info"><a class="article-title" href="/2021/04/04/conda-mamba-Installation/" title="conda/mamba Installation">conda/mamba Installation</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2021-04-04T03:42:27.000Z" title="Created 2021-04-04 11:42:27">2021-04-04</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/toolsLearning/">toolsLearning</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/conda/">conda</a></span></div><div class="content">Conda 是⼀个开源的软件包管理系统和环境管理系统，用于安装多个版本的软件包及其依赖关系，并在它们之间轻松切换。Conda 主要是为 Python 程序创建的，适⽤于 Linux，OSX和 Windows，也可以打包和分发其他软件，如 R 和 Scala。
conda 配置镜像Conda 的默认配置属于开箱即用的类型，但如果我们想要更好⽤，还有⼀些设定需要注意。
Conda 默认的包channel是Anaconda公司的默认频道。另外还存在⼀个开源频道：conda-forge。condaforge 的包往往⽐官⽅更新更快，也更全，通常我们会直接把频道加⼊到 conda 的默认设置⾥。对于其他自己维护的频道，⽐如 pytorch，如果需要，我们也可以自行添加。
123# 生成condarc配置文件；conda config --add channels conda-forgeconda config --append channels pytorch
另外，如果Conda在国内更新很慢，可以搜索anaconda清华源添加清华大学的国内镜像进行包的更新。
显示目前设置的所有镜像源，在执行 ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2021/04/01/Metagenomics/" title="Metagenomics Analysis">     <img class="post_bg" src="/img/cover/Metagenomics.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Metagenomics Analysis"></a></div><div class="recent-post-info"><a class="article-title" href="/2021/04/01/Metagenomics/" title="Metagenomics Analysis">Metagenomics Analysis</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2021-04-01T11:31:45.000Z" title="Created 2021-04-01 19:31:45">2021-04-01</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Metagenomics/">Metagenomics</a></span></div><div class="content">
通过single end示例数据了解qiime2分析过程。
尝试利用pair end示例数据进行16S数据分析。


Qiime2introductionQIIME 2是一款强大、可扩展和去中心化的微生物组分析平台，强调数据分析透明。QIIME 2可以使研究者从原始DNA序列开始分析，直接获取出版级的统计和图片结果。
主要特点：

整合分析流程、自动化追踪数据来源
语义类型系统，自动识别输入文件类型
插件系统可扩展微生物分析功能种类
支持多种用户界面，如API、命令行、图形界面

QIIME 2是对QIIME 1完全重新设计并重写的微生物组分析流程。QIIME 2保留了QIIME 1强大和广泛使用的优点，同时改进了其众多不足之处。
QIIME 2当前支持从头到尾的完整微生物组分析流程。通常QIIME 2插件功能，不断有新功能可用。可以在可用插件列表中查找当前可用的插件。在未来可用插件页列出了正在开发的插件。
installation
conda环境安装QIIME2（推荐）Install QIIME 2 within a conda environmentmkdir -p 2020.1 ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2021/03/31/eCLIP-Analysis/" title="eCLIP Analysis">     <img class="post_bg" src="/img/cover/eCLIP.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="eCLIP Analysis"></a></div><div class="recent-post-info"><a class="article-title" href="/2021/03/31/eCLIP-Analysis/" title="eCLIP Analysis">eCLIP Analysis</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2021-03-31T00:19:05.000Z" title="Created 2021-03-31 08:19:05">2021-03-31</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/eCLIP/">eCLIP</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/eCLIP/">eCLIP</a></span></div><div class="content">
文献：https://www.nature.com/articles/nmeth.3810
方法：https://www.encodeproject.org/documents/739ca190-8d43-4a68-90ce-1a0ddfffc6fd/@@download/attachment/eCLIP_analysisSOP_v2.2.pdf
 建库原理：
软件都在/publis/shaojf/Course/NGS/Tools/eCLIP.tools
X 表示cross-link的位置，在read2

Read1包括barcodeRead 2 前几个碱基叫Random-mer（UMI），UMI碱基放在name里面测序长度比读段长，要去接头
分析路线
Fastqc查看质量及adapter
Demultiplex分离in-line barcode及UMI处理+cutadapt
STAR比对（adaptor一般出现在末端，STAR用local模式，有没有adaptor影响不大）
基于UMI删除PCR重复（Barcode一样的放到一个fastq，算作Tech rep）
合并技术重复（得到 ...</div></div></div><div class="recent-post-item"><div class="post_cover left_radius"><a href="/2021/03/30/WES-Project/" title="WES Project">     <img class="post_bg" src="/img/cover/WES.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="WES Project"></a></div><div class="recent-post-info"><a class="article-title" href="/2021/03/30/WES-Project/" title="WES Project">WES Project</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2021-03-30T08:38:50.000Z" title="Created 2021-03-30 16:38:50">2021-03-30</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/WES/">WES</a></span></div><div class="content">
  p{
    font-size:18px;
    line-height:1.7em;

  }


环境配置GATK本次作业使用的GATK版本为4.2.0.0数据库文件来源：/public/workspace/lincs/wes_cancer/data
github-GATK官网
由于GATK的更新，ftp链接于2020年6月1日关闭，所有数据库文件都迁移至谷歌云存储：Google Cloud-genomics public data文件下载需要先conda/mamba安装gsutil



阿里云和Broad Institute合作提供了GATK软件分析流程。由Broad Institute提供的GATK流程最佳实践用工作流定义语言（WDL）编写，通过批量计算集成的Cromwell工作流引擎解析执行。用户将为作业运行时实际消耗的计算和存储资源付费，不需要支付资源之外的附加费用。需要先开通阿里云的OSS并创建好Bucket，输入、输出文件都需要保存在OSS。  阿里云-GATK支持  



Reference

12345678910# referenceascp  -i ...</div></div></div><div class="recent-post-item"><div class="post_cover right_radius"><a href="/2021/03/25/CUT-Tag-Analysis/" title="CUT&amp;Tag Analysis">     <img class="post_bg" src="/img/cover/CUT&amp;Tag.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="CUT&amp;Tag Analysis"></a></div><div class="recent-post-info"><a class="article-title" href="/2021/03/25/CUT-Tag-Analysis/" title="CUT&amp;Tag Analysis">CUT&amp;Tag Analysis</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">Created</span><time datetime="2021-03-25T09:37:16.000Z" title="Created 2021-03-25 17:37:16">2021-03-25</time></span><span class="article-meta"><span class="article-meta__separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/CUT-Tag/">CUT&amp;Tag</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/CUT-Tag/">CUT&amp;Tag</a></span></div><div class="content">
有一个隐藏的节点可以用，ssh 192.168.1.23 (有24个线程)
jobs命令，查看后台有没有任务在运行
IGV可以save session回到之前的界面

分析流程参考： https://yezhengstat.github.io/CUTTag_tutorial数据来源： https://www.nature.com/articles/s41467-019-09982-5 
主要步骤：
质量监控（fastqc，multiqc）（略）
读段比对（bowtie2）（略）及利用spike-in计算scale factor
sam过滤及格式转换（samtools、bedtools）及归一化
Peak calling（SEACR、MACS2）
motif识别（MEME）
IGV可视化
deeptools可视化及homer注释（可选）


BlackList

被设为黑名单后，不能当做是peakcall peak之后，用Black List过滤一下
Bam文件http://genome.ucsc.edu/FAQ/FAQformat.html#format1
相当于压缩文件，要用sam ...</div></div></div><nav id="pagination"><div class="pagination"><span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-info-avatar is-center"><img class="avatar-img" src="/img/selfie.JPG" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">yilingzhang</div><div class="author-info__description">Every Day is My Day</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">24</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">Tags</div><div class="length-num">12</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">Categories</div><div class="length-num">12</div></a></div></div><div class="card-info-social-icons is-center"><a class="social-icon" href="mailto:jocelynzhang1119@icloud.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="https://blog.csdn.net/weixin_43893431" target="_blank" title="CSDN"><i class="fas fa-paper-plane"></i></a></div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Post</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2021/04/13/Stat-03-Non-Negative-Matrix-Factorization/" title="Stat-03-Non-Negative Matrix Factorization"><img src="/img/banner/paofu.JPG" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Stat-03-Non-Negative Matrix Factorization"/></a><div class="content"><a class="title" href="/2021/04/13/Stat-03-Non-Negative-Matrix-Factorization/" title="Stat-03-Non-Negative Matrix Factorization">Stat-03-Non-Negative Matrix Factorization</a><time datetime="2021-04-13T01:02:11.000Z" title="Created 2021-04-13 09:02:11">2021-04-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/04/12/Phrase-for-Response-Letter/" title="Phrase for Response Letter"><img src="/img/cover/responseletter.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Phrase for Response Letter"/></a><div class="content"><a class="title" href="/2021/04/12/Phrase-for-Response-Letter/" title="Phrase for Response Letter">Phrase for Response Letter</a><time datetime="2021-04-12T00:03:31.000Z" title="Created 2021-04-12 08:03:31">2021-04-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/04/10/Git-love-RProject-push-your-project-to-Github-Gitee/" title="Git love RProject--push your project to Github/Gitee!"><img src="/img/cover/Rgit.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Git love RProject--push your project to Github/Gitee!"/></a><div class="content"><a class="title" href="/2021/04/10/Git-love-RProject-push-your-project-to-Github-Gitee/" title="Git love RProject--push your project to Github/Gitee!">Git love RProject--push your project to Github/Gitee!</a><time datetime="2021-04-10T03:19:29.000Z" title="Created 2021-04-10 11:19:29">2021-04-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/04/08/scATAC-seq-Analysis/" title="scATAC-seq Analysis"><img src="/img/cover/scATAC.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="scATAC-seq Analysis"/></a><div class="content"><a class="title" href="/2021/04/08/scATAC-seq-Analysis/" title="scATAC-seq Analysis">scATAC-seq Analysis</a><time datetime="2021-04-08T11:01:25.000Z" title="Created 2021-04-08 19:01:25">2021-04-08</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/04/06/TOEFL-writing-05/" title="TOEFL-writing-05"><img src="/img/cover/TOEFL-writing-04.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="TOEFL-writing-05"/></a><div class="content"><a class="title" href="/2021/04/06/TOEFL-writing-05/" title="TOEFL-writing-05">TOEFL-writing-05</a><time datetime="2021-04-06T00:48:39.000Z" title="Created 2021-04-06 08:48:39">2021-04-06</time></div></div></div></div><div class="card-widget card-categories"><div class="item-headline">
            <i class="fas fa-folder-open"></i>
            <span>Categories</span>
            <a class="card-more-btn" href="/categories/" title="More">
    <i class="fas fa-angle-right"></i></a>
            </div>
            <ul class="card-category-list" id="aside-cat-list">
            <li class="card-category-list-item "><a class="card-category-list-link" href="/categories/CUT-Tag/"><span class="card-category-list-name">CUT&Tag</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Functional-Genomics/"><span class="card-category-list-name">Functional Genomics</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Metagenomics/"><span class="card-category-list-name">Metagenomics</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/RNA-seq/"><span class="card-category-list-name">RNA-seq</span><span class="card-category-list-count">2</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Records/"><span class="card-category-list-name">Records</span><span class="card-category-list-count">3</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/STAT/"><span class="card-category-list-name">STAT</span><span class="card-category-list-count">2</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Single-Cell/"><span class="card-category-list-name">Single Cell</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/TOEFL/"><span class="card-category-list-name">TOEFL</span><span class="card-category-list-count">1</span></a></li>
            </ul></div><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>Tags</span></div><div class="card-tag-cloud"><a href="/tags/Adobe-Illustrator/" style="font-size: 1.1em; color: #999">Adobe Illustrator</a> <a href="/tags/CUT-Tag/" style="font-size: 1.1em; color: #999">CUT&Tag</a> <a href="/tags/Debug/" style="font-size: 1.1em; color: #999">Debug</a> <a href="/tags/Functional-Genomics/" style="font-size: 1.1em; color: #999">Functional Genomics</a> <a href="/tags/Git/" style="font-size: 1.1em; color: #999">Git</a> <a href="/tags/RNA-seq/" style="font-size: 1.3em; color: #99a1ac">RNA-seq</a> <a href="/tags/Stat/" style="font-size: 1.3em; color: #99a1ac">Stat</a> <a href="/tags/TOEFL/" style="font-size: 1.5em; color: #99a9bf">TOEFL</a> <a href="/tags/Tips/" style="font-size: 1.3em; color: #99a1ac">Tips</a> <a href="/tags/conda/" style="font-size: 1.1em; color: #999">conda</a> <a href="/tags/eCLIP/" style="font-size: 1.1em; color: #999">eCLIP</a> <a href="/tags/scATAC-seq/" style="font-size: 1.1em; color: #999">scATAC-seq</a></div></div><div class="card-widget card-archives"><div class="item-headline"><i class="fas fa-archive"></i><span>Archives</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/04/"><span class="card-archive-list-date">April 2021</span><span class="card-archive-list-count">7</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/03/"><span class="card-archive-list-date">March 2021</span><span class="card-archive-list-count">8</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2021/02/"><span class="card-archive-list-date">February 2021</span><span class="card-archive-list-count">9</span></a></li></ul></div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>Info</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">Article :</div><div class="item-count">24</div></div><div class="webinfo-item"><div class="item-name">Total Count :</div><div class="item-count">37.7k</div></div><div class="webinfo-item"><div class="item-name">UV :</div><div class="item-count" id="busuanzi_value_site_uv"></div></div><div class="webinfo-item"><div class="item-name">PV :</div><div class="item-count" id="busuanzi_value_site_pv"></div></div><div class="webinfo-item"><div class="item-name">Last Push :</div><div class="item-count" id="last-push-date" data-lastPushDate="2021-04-16T05:48:57.695Z"></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2021 By yilingzhang</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="darkmode" type="button" title="Toggle Between Light And Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle between single-column and double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="Setting"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="Back To Top"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"><script>function subtitleType () {
  if (true) { 
    var typed = new Typed("#subtitle", {
      strings: "Every Day is My Day".split(","),
      startDelay: 300,
      typeSpeed: 150,
      loop: true,
      backSpeed: 50
    })
  } else {
    document.getElementById("subtitle").innerHTML = 'Every Day is My Day'
  }
}

if (true) {
  if (typeof Typed === 'function') {
    subtitleType()
  } else {
    getScript('https://cdn.jsdelivr.net/npm/typed.js/lib/typed.min.js').then(subtitleType)
  }
} else {
  subtitleType()
}</script></div><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="true"></script><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/click-heart.min.js" async="async" mobile="false"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>