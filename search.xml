<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>AI Learning</title>
    <url>/2021/02/17/AI-Learning/</url>
    <content><![CDATA[<h1 id="界面-版本-快捷键"><a href="#界面-版本-快捷键" class="headerlink" title="界面/版本/快捷键"></a>界面/版本/快捷键</h1><h2 id="版本挑选"><a href="#版本挑选" class="headerlink" title="版本挑选"></a>版本挑选</h2><h2 id="CS6-CC2018-CC2020"><a href="#CS6-CC2018-CC2020" class="headerlink" title="CS6/CC2018/CC2020"></a>CS6/CC2018/CC2020</h2><h2 id="AI输出格式"><a href="#AI输出格式" class="headerlink" title="AI输出格式"></a>AI输出格式</h2><p>.ai 工程文件<br>.eps 矢量图<br>.tif 位图<br>.pdf 最稳定</p>
<hr>
<h2 id="设置-快捷键"><a href="#设置-快捷键" class="headerlink" title="设置+快捷键"></a>设置+快捷键</h2><ol>
<li>出血边：相当于margin，预留给打印等的装订，一般0.3px</li>
<li><code>ALT+滚动滑轮/ctrl+加减键</code>：放大缩小 (CTRL+0：恢复到默认大小)</li>
<li><code>空格键+鼠标左键</code>：抓手工具</li>
<li><code>CTRL+R</code>:标尺</li>
<li><code>CTRL+;</code>:参考线</li>
<li><code>CTRL+&quot;</code>:网格</li>
<li><code>CTRL+Y</code>：轮廓模式，可以看到轮廓边缘</li>
<li><code>CTRL+ALT+Y</code>：像素模式  </li>
</ol>
<hr>
<h1 id="选择工具组-描边-缩放工具"><a href="#选择工具组-描边-缩放工具" class="headerlink" title="选择工具组/描边/缩放工具"></a>选择工具组/描边/缩放工具</h1><h2 id="选择工具组"><a href="#选择工具组" class="headerlink" title="选择工具组"></a>选择工具组</h2><p><code>选择工具(V)</code>:选择、移动、缩放、旋转（按shift表示等比缩放）<br><code>直接选择(A)</code>:选择、移动、变形<br>显示/隐藏定界框：<code>ctrl+shift+B</code><br>显示/隐藏边缘：<code>ctrl+H</code><br>套索工具：自由选择需要的锚点</p>
]]></content>
      <categories>
        <category>toolsLearning</category>
      </categories>
      <tags>
        <tag>Adobe Illustrator</tag>
      </tags>
  </entry>
  <entry>
    <title>Functional Genomics-01-BioinfoAna of Transcriptional Regulation</title>
    <url>/2021/03/02/Functional-Genomics-01-BioinfoAna-of-Transcriptional-Regulation/</url>
    <content><![CDATA[<h1 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h1><ol>
<li><strong>表达(gene expression)</strong>:基因在生物体内的转录、剪接、翻译以及转变成具有生物活性的蛋白质分子之前的所有加工过程。<br>从一套基本不变的基因组中产生出多元化的细胞类型，是由调控基因活性的各种信号途径所控制。</li>
<li><strong>转录因子(transcr iption factor, TF)</strong>: 也称反式作用因子，有序地结合在目标基因启动子(promoter)序列中的特殊位点，启动基因的转录和控制基因的转录效率。<br> 根据转录因子的作用特点可分为二类:<ul>
<li>普遍转录因子，它们与RNA聚合酶II共同组成转录起始复合体时，转录才能在正确的位置开始。包括TFIID，TFIIA，TFIIF，TFIIE，TFIIH等;</li>
<li>组织细胞特异性转录因子，这些TF是在特异的组织细胞或是受到一些类固醇激素/生长因子的刺激后，开始表达某些特异蛋白质分子时，才需要的一类转录因子。</li>
</ul>
</li>
<li><strong>转录因子的结合位点(transcription factor binding site, TFBS)</strong>: 转录因子调节基因表达时，与基因模板链结合的区域，又被称为顺式作用元件。长度从几个到几十个碱基不等。</li>
<li>**模体(motif)**：转录因子的结合位点的特定模式。不是一段序列</li>
</ol>
<hr>
<h1 id="基因转录调节的基本模式"><a href="#基因转录调节的基本模式" class="headerlink" title="基因转录调节的基本模式"></a>基因转录调节的基本模式</h1><p><img src="/img/article/functionalgenomics/basic.png" alt="basic mode"></p>
<ol>
<li>启动子：启动子一般位于真核基因转录起始点上游 200bp以内。包括至少一个转录起始点以及一个以上的机能组件。启动子是基因的一个组成部分，控制基因表达（转录）的起始时间和表达的程度。</li>
<li>TATA盒：共有序列是TATAAAA，通常位于转录起始点上游-25~-30bp，决定转录的方向和精确的转录起始点。TATA盒是基本转录因子TFIID结合位点。</li>
<li>上游启动子元件：除TATA盒外，GC盒（GGGCGG）和 CAAT盒（GCCAAT）也是很多基因常见的，它们通常位于转录起始点上游-30~-110bp区域</li>
<li>RNA聚合酶：以一条DNA链或RNA为模板催化由核苷5′-三磷酸合成RNA的酶。是催化以DNA为模板(template)、三磷酸核糖核苷为底物、通过磷酸二酯键而聚合的合成RNA的酶。</li>
<li>顺式作用元件(cis-acting element): 存在于基因旁侧序列中能影响基因表达的序列。顺式作用元件包括启动子、增强子、调控序列和可诱导元件等，作用是参与基因表达的调控。顺式作用元件本身不编码任何蛋白质，仅仅提供一个作用位点，要与反式作用因子相互作用而起作用。</li>
</ol>
<hr>
<h1 id="基因转录调节机制的研究方法"><a href="#基因转录调节机制的研究方法" class="headerlink" title="基因转录调节机制的研究方法"></a>基因转录调节机制的研究方法</h1><h2 id="实验方法"><a href="#实验方法" class="headerlink" title="实验方法"></a>实验方法</h2><h3 id="荧光素酶报告基因-luciferase-report-gene-："><a href="#荧光素酶报告基因-luciferase-report-gene-：" class="headerlink" title="荧光素酶报告基因(luciferase report gene)："></a>荧光素酶报告基因(luciferase report gene)：</h3><p>检测转录因子与目的基因启动子区DNA相互作用，荧光素酶的表达量与转录因子的作用强度成正比。 </p>
<h3 id="凝胶迁移-EMSA-electrophoreticmobility-shift-assays"><a href="#凝胶迁移-EMSA-electrophoreticmobility-shift-assays" class="headerlink" title="凝胶迁移(EMSA, electrophoreticmobility shift assays):"></a>凝胶迁移(EMSA, electrophoreticmobility shift assays):</h3><p>是一种用于蛋白与核酸相互作用的技术，可用于定性和定量分析。最初是用于转录因子与启动子相互作用的验证性实验，也可应用与蛋白DNA、蛋白-RNA互作研究。EMSA主要基于蛋白-探针复合物在在凝胶电泳过程中迁移较慢的原理。</p>
<h3 id="DNase足迹法-DNase-footprinting-："><a href="#DNase足迹法-DNase-footprinting-：" class="headerlink" title="DNase足迹法(DNase footprinting)："></a>DNase足迹法(DNase footprinting)：</h3><p>鉴别RNA聚合酶等蛋白质在DNA上结合位点的方法。不仅能找到与特异性DNA结合的目标蛋白，而且能告知目标蛋白结合在哪些碱基部位。（原理：蛋白质结合在DNA片段上，能保护结合部位不被DNase破坏，DNA分子经酶切作用后遗留下该片段(亦称“足迹”)，进而可以确定它的序列）</p>
<h3 id="染色质免疫沉淀-ChIP-chromatin-immunoprecipitation"><a href="#染色质免疫沉淀-ChIP-chromatin-immunoprecipitation" class="headerlink" title="染色质免疫沉淀(ChIP, chromatin immunoprecipitation)"></a>染色质免疫沉淀(ChIP, chromatin immunoprecipitation)</h3><ul>
<li>创立者: 20世纪80年代末Alexander Varshavsky等人(Cell. 1988,53(6): 937-947 )</li>
<li>原理:<br>活细胞采用甲醛交联后裂解，染色体分离成为一定大小的片段，然后用特异性抗体免疫沉淀目标蛋白与DNA交联的复合物，对特定靶蛋白与DNA片段进行富集。采用低pH值反交联，DNA与蛋白质之间的Schiff键（-C=N-）水解，释放DNA片段。通过对目标片段的纯化与检测，获得DNA与蛋白质相互作用的序列信息。</li>
<li>应用: 主要用来分析目标基因有没有活性、或者分析一种已知蛋白（转录因子）的靶基因有哪些。</li>
<li>特点：<ol>
<li>针对某一特定候选转录因子，是否特异性结合于所调节的靶基因某一预定区域内，如启动子区，进行检测。</li>
<li>对同一DNA底物, 可以运用多种不同的抗体, 分别进行免疫共沉淀,以确定多种结合蛋白在同一染色质片段上的结合</li>
</ol>
</li>
</ul>
<h3 id="高通量实验测定-ChIP-chip-ChIP-seq"><a href="#高通量实验测定-ChIP-chip-ChIP-seq" class="headerlink" title="高通量实验测定(ChIP-chip, ChIP-seq)"></a>高通量实验测定(ChIP-chip, ChIP-seq)</h3><ol>
<li><strong>ChIP-chip</strong>:</li>
</ol>
<ul>
<li>创立者:2000年，Richard A. Young等人(Science.2000, 290(5500): 2306-2309)</li>
<li>原理:<br>该方法首先使用固定剂将DNA染色质断裂为0.2-1kp的碱基段;然后用针对特异性蛋白质的抗体进行ChIP，将富集的蛋白质一DNA复合物进行扩增，再将扩增的DNA片断与覆盖欲检测基因组的芯片进行杂交，使用芯片扫描仪对芯片的信息进行处理。</li>
<li>特点:<br> ChIP和芯片技术的联合运用<br> 全基因组范围内的定位分析<br> 靶基因群的高通量分析</li>
<li>不足：分辨率较低，大于200bp；只能检测已知序列</li>
</ul>
<ol start="2">
<li><strong>ChIP-seq</strong>:</li>
</ol>
<ul>
<li>创立者： 2007年，Steven J.M. Jones等人 (Science. 2000, 290(5500): 2306-2309 )</li>
<li>定义：<br>ChIP-seq是将深度测序技术与ChIP实验相结合，分析全基因组范围内DNA结合蛋白结合位点、组蛋白修饰、核小体定位或DNA甲基化的高通量方法，可以应用到任何基因组序列已知的物种，并能确切得到每一个片段的序列信息</li>
<li>原理：<ul>
<li>首先通过染色质免疫共沉淀技术（ChIP）特异性地富集目的蛋白结合的DNA片段，并对其进行纯化与文库构建；</li>
<li>然后对富集得到的DNA片段进行高通量测序。</li>
<li>研究人员通过将获得的数百万条序列标签精确定位到基因组上，从而获得全基因组范围内与组蛋白、转录因子等互作的DNA区段信息。</li>
</ul>
</li>
<li>特点：<ul>
<li>染色质免疫沉淀后的DNA，直接进行高通量测序 </li>
<li>是一个“开放系统”。它可以检测更小的结合区段、未知的结合位点、结合位点内的突变情况和蛋白亲合力较低的区段</li>
<li>成本低，周期短，省去了标记和杂交等步骤，并且无需多次重复实验，效率高</li>
<li>分辨率可提高到30～50bp</li>
</ul>
</li>
</ul>
<h2 id="转录因子结合位点的信息学预测方法"><a href="#转录因子结合位点的信息学预测方法" class="headerlink" title="转录因子结合位点的信息学预测方法"></a>转录因子结合位点的信息学预测方法</h2><p>问题：转录因子结合位点一般在6-12bp间，ChIPchip分辨率200-800bp, ChIP-seq在100bp或更高， 因此要对现有的高通量数据进行处理。<br>1.转录因子结合位点定位：根据若干个motif，在所研究的某个基因启动子区域内，搜索相应转录因子可能的结合位点。<br>2.转录因子结合位点的识别：通过收集多个基因启动子序列，在其中寻找具有统计显著性的短片段，作为同一转录因子可能的结合位点。</p>
<h3 id="转录因子结合位点的表示方式"><a href="#转录因子结合位点的表示方式" class="headerlink" title="转录因子结合位点的表示方式"></a>转录因子结合位点的表示方式</h3><h4 id="（一）共性序列-consensus-sequence"><a href="#（一）共性序列-consensus-sequence" class="headerlink" title="（一）共性序列(consensus sequence)"></a>（一）共性序列(consensus sequence)</h4><ul>
<li>将能与同一个转录因子结合的所有DNA片段按照对应位置进行排列，在每个位置上选择最可能出现的碱基,就组成了该转录因子结合位点的共性序列。</li>
<li>共性序列中用A、C、G、T之外的字母来表示结合位点中各个位置上可能出现的碱基组合，这些字母称为IUPAC简并码。</li>
<li>共性序列的表示方法简明易懂，却不能够反映每个位置上不同碱基出现的概率。</li>
</ul>
<p><img src="/img/article/functionalgenomics/IUPAC.png" alt="IUPAC"></p>
<h4 id="（二）位置频率矩阵-position-frequency-matrix"><a href="#（二）位置频率矩阵-position-frequency-matrix" class="headerlink" title="（二）位置频率矩阵(position frequency matrix)"></a>（二）位置频率矩阵(position frequency matrix)</h4><p>位置频率矩阵可以反映出每个位置上不同碱基出现的概率。</p>
<ul>
<li>该模型的一个前提假设是各个位置上碱基出现的概率相互独立。</li>
<li>矩阵每一列表示模体相应位置上四种碱基出现的概率。</li>
</ul>
<p><img src="/img/article/functionalgenomics/PFM.png" alt="PFM"></p>
<h3 id="三-序列标识图-sequence-logo"><a href="#三-序列标识图-sequence-logo" class="headerlink" title="(三)序列标识图(sequence logo)"></a>(三)序列标识图(sequence logo)</h3><ul>
<li>序列标识图依次绘出模体中各个位置上出现的碱基，每个位置上所有碱基的高度和反映了该位置上碱基的一致性，每个碱基字母的大小与碱基在该位置上出现<br>的频率成正比。</li>
<li>这种表示方法直观地给出模体各个位置上碱基出现的倾向性和整个模体的序列的一致性。</li>
</ul>
<p><img src="/img/article/functionalgenomics/methods.png" alt="methods"></p>
]]></content>
      <categories>
        <category>Functional Genomics</category>
      </categories>
      <tags>
        <tag>Functional Genomics</tag>
      </tags>
  </entry>
  <entry>
    <title>Stat-01-MDS</title>
    <url>/2021/02/22/Stat-01-MDS/</url>
    <content><![CDATA[<p><strong>MDS(Multi-dimetional Scaling, 多维标度法)</strong></p>
<ul>
<li><p>核心目的:<br>对于距离矩阵D,在低维空间中寻找一个矩阵Z，使得Z构成的欧式距离矩阵B尽可能和原来矩阵D保持一致。此种多维标度法也被称为主坐标分析。（把所有的距离矩阵，找一个低维的欧氏距离去接近）</p>
</li>
<li><p>具体推导详见goodnote笔记</p>
</li>
<li><p>R语言通过MDS对GTEx数据进行降维</p>
</li>
<li><p>当dist矩阵本身为欧氏距离时，MDS == PCA<br>MDS更强调对不同种类的dist转换<br>PCA强调用线性组合表示variable</p>
</li>
</ul>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment">#########################</span></span><br><span class="line"><span class="comment"># Data 2021-02-22</span></span><br><span class="line"><span class="comment"># Author zhangyl</span></span><br><span class="line"><span class="comment"># MDS</span></span><br><span class="line"><span class="comment">#########################</span></span><br><span class="line"></span><br><span class="line">rm(<span class="built_in">list</span> = ls())</span><br><span class="line"></span><br><span class="line"><span class="comment"># -----------------------------------&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</span></span><br><span class="line"><span class="comment"># MDS</span></span><br><span class="line"><span class="comment"># -----------------------------------&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</span></span><br><span class="line">load(<span class="string">&quot;./data/GTEx.RData&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># tissue的注释文件</span></span><br><span class="line">accession.df = read.csv(file=<span class="string">&quot;./data/GTEx_accession_table.csv&quot;</span>)</span><br><span class="line">annotation.df = read.csv(file=<span class="string">&quot;./data/GTEx_v7_Annotations_SampleAttributesDS.txt&quot;</span>,header = <span class="built_in">T</span>,sep = <span class="string">&quot;\t&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># make matrix </span></span><br><span class="line">GTEx.TPM.gene.mat.only_TPM = log2(GTEx.TPM.gene.mat[,<span class="built_in">c</span>(-<span class="number">1</span>,-<span class="number">2</span>)]+<span class="number">1</span>)</span><br><span class="line">rownames(GTEx.TPM.gene.mat.only_TPM) = <span class="built_in">as.character</span>(GTEx.TPM.gene.mat$Name)</span><br><span class="line"></span><br><span class="line"><span class="comment"># get tissue info </span></span><br><span class="line">tissue_info = <span class="built_in">as.character</span>(annotation.df$SMTS[match(accession_id_vec,annotation.df$SAMPID)])</span><br><span class="line"></span><br><span class="line"><span class="comment"># run MDS</span></span><br><span class="line">dist.mat = dist(t(GTEx.TPM.gene.mat.only_TPM), method = <span class="string">&quot;minkowski&quot;</span>, p=<span class="number">5</span>)</span><br><span class="line">dist.mat = <span class="built_in">sqrt</span>(<span class="number">2</span>*(<span class="number">1</span> - <span class="built_in">abs</span>(cor(GTEx.TPM.gene.mat.only_TPM,method = <span class="string">&quot;kendall&quot;</span>))))</span><br><span class="line"></span><br><span class="line">MDS_res = cmdscale(dist.mat,eig=<span class="literal">TRUE</span>, k=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">MDS_xy.df = data.frame(MDS_1 = MDS_res$points[,<span class="number">1</span>],</span><br><span class="line">                       MDS_2 = MDS_res$points[,<span class="number">2</span>],</span><br><span class="line">                       tissue = factor(tissue_info))</span><br><span class="line"></span><br><span class="line"><span class="comment"># plot with ggplot2</span></span><br><span class="line">library(ggplot2)</span><br><span class="line"></span><br><span class="line">ggplot(data = MDS_xy.df, aes(MDS_1,MDS_2,color=tissue)) + </span><br><span class="line">  geom_point()  + </span><br><span class="line">  geom_text(aes(label=tissue)) + </span><br><span class="line">  theme_bw()</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>STAT</category>
      </categories>
      <tags>
        <tag>Stat</tag>
      </tags>
  </entry>
  <entry>
    <title>Stat-02-tSNE</title>
    <url>/2021/02/23/Stat-02-tSNE/</url>
    <content><![CDATA[<h1 id="线性降维与非线性降维"><a href="#线性降维与非线性降维" class="headerlink" title="线性降维与非线性降维"></a><strong>线性降维与非线性降维</strong></h1><ul>
<li>线性降维(Linear dimensionality reduction)<ul>
<li>主成分分析(PCA)</li>
<li>多维坐标变换(MDS)</li>
<li>聚类分析(Clustering)</li>
</ul>
</li>
<li>非线性降维(Nonlinear dimensionality reduction)<ul>
<li>lsomap (等度量映射)</li>
<li>LLE (局部线性嵌入)</li>
<li>t-SNE (t分布-随机近邻嵌入)</li>
</ul>
</li>
</ul>
<p>非线性降维属于流形学习的一部分（流形是局部具有欧几里得空间性质的空间，流形学习是指把高位空间整到低维去，使得欧氏距离重新生效，MDS是保留原有距离特征）</p>
<hr>
<h1 id="t-SNE的直观理解"><a href="#t-SNE的直观理解" class="headerlink" title="t-SNE的直观理解"></a>t-SNE的直观理解</h1><p><a href="https://www.seas.harvard.edu/courses/cs281/papers/tsne.pdf">Visualizing data using t-SNE, Laurens van der Maaten and Geoffrey Hintton, Journel of machine learning research, 2008.</a></p>
<ol>
<li>随机选择起始点;</li>
<li>计算高维空间这些样本点的概率分布F1;</li>
<li>计算低维空间这些样本点的概率分布F2;</li>
<li>迭代:如果能够使F1与F2概率分布尽可能的接近则降维成功</li>
</ol>
<hr>
<h1 id="信息熵与KL散度"><a href="#信息熵与KL散度" class="headerlink" title="信息熵与KL散度"></a>信息熵与KL散度</h1><h2 id="信息熵"><a href="#信息熵" class="headerlink" title="信息熵"></a>信息熵</h2><p>衡量不确定性的大小，信息熵越大，携带的不确定性越多</p>
<h2 id="KL散度-Kullback-Leibler-Divergence"><a href="#KL散度-Kullback-Leibler-Divergence" class="headerlink" title="KL散度(Kullback-Leibler Divergence)"></a>KL散度(Kullback-Leibler Divergence)</h2><p>也叫相对熵，利用KL散度来衡量两个分布是否相似</p>
<p>e.g. 正常样本与癌症样本 D(KL)计算dist——&gt; MDS可视化 D(KL)&gt;0.5发生变化</p>
<hr>
<h1 id="SNE的数学过程"><a href="#SNE的数学过程" class="headerlink" title="SNE的数学过程"></a>SNE的数学过程</h1><ol>
<li>先通过欧氏距离表示点的概率分布，分低维和高维情况；</li>
<li>目标是希望高维和低维之间的分布尽可能相同；</li>
<li>初始化时需要设置参数<strong>困惑度</strong>(perplrxity),SNE会通过二分搜索的方法计算最佳的初始化方差，一般困惑度选择5~50；</li>
<li>对目标函数进行迭代优化，可以增加扰动，防止局部最优；</li>
</ol>
<hr>
<h1 id="t-SNE相对于SNE的提升"><a href="#t-SNE相对于SNE的提升" class="headerlink" title="t-SNE相对于SNE的提升"></a>t-SNE相对于SNE的提升</h1><ol>
<li>t-SNE解决了概率不对成的问题，高位情况下Pij为对称；</li>
<li>t-SNE使用t分布作为降维后的概率分布（SNE用的是正态分布）</li>
</ol>
<hr>
<h1 id="t-SNE的优缺点"><a href="#t-SNE的优缺点" class="headerlink" title="t-SNE的优缺点"></a>t-SNE的优缺点</h1><ul>
<li>优点:<ul>
<li>非常优秀的降维可视化方法，对各种数据集的表现都非常好!</li>
</ul>
</li>
<li>缺点:<ul>
<li>基本只用于可视化;</li>
<li>t-SNE倾向保留局部特征，有的时候会“只见树木不见森林”（可以先做pca）;</li>
<li>t-SNE结果中的距离没有太大意义，因为都是计算的概率;</li>
<li>t-SNE训练速度比较慢</li>
</ul>
</li>
<li>特点:<ul>
<li>受初值影响（调试时需要set.seed）</li>
</ul>
</li>
</ul>
<hr>
<h1 id="R语言计算t-SNE"><a href="#R语言计算t-SNE" class="headerlink" title="R语言计算t-SNE"></a>R语言计算t-SNE</h1><figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment">#########################</span></span><br><span class="line"><span class="comment"># Data 2021-02-27</span></span><br><span class="line"><span class="comment"># Author zhangyl</span></span><br><span class="line"><span class="comment"># t-SNE</span></span><br><span class="line"><span class="comment">#########################</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># load package </span></span><br><span class="line">library(Rtsne)</span><br><span class="line"></span><br><span class="line">SD.vector &lt;- apply(GTEx.TPM.gene.mat[,<span class="built_in">c</span>(-<span class="number">1</span>,-<span class="number">2</span>)],<span class="number">1</span>,FUN=<span class="keyword">function</span>(x)&#123;sd(x)&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># select top3000</span></span><br><span class="line">GTEx.TPM.gene.mat.log2 &lt;- log2(GTEx.TPM.gene.mat[,<span class="built_in">c</span>(-<span class="number">1</span>,-<span class="number">2</span>)]+<span class="number">1</span>)</span><br><span class="line">GTEx.TPM.gene.mat.log2.top3000 &lt;- GTEx.TPM.gene.mat.log2[order(SD.vector,decreasing = <span class="built_in">F</span>),]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Rtsne()</span></span><br><span class="line"><span class="comment"># matrix 行是基因，列是variables</span></span><br><span class="line"><span class="comment"># perplexity 5~50</span></span><br><span class="line"></span><br><span class="line">set.seed(<span class="number">20210227</span>)</span><br><span class="line">tSNE_res &lt;- Rtsne(t(GTEx.TPM.gene.mat.log2.top3000),dims = <span class="number">3</span>,perplexity = <span class="number">10</span>,pca = <span class="built_in">T</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># plot region </span></span><br><span class="line">tSNE_res.df &lt;- as.data.frame(tSNE_res$Y)</span><br><span class="line">colnames(tSNE_res.df) &lt;- <span class="built_in">c</span>(<span class="string">&quot;tSNE1&quot;</span>,<span class="string">&quot;tSNE2&quot;</span>,<span class="string">&quot;tSNE3&quot;</span>)</span><br><span class="line">tSNE_res.df$tissue &lt;- tissue_info</span><br><span class="line"></span><br><span class="line">ggplot(data = tSNE_res.df, aes(tSNE1,tSNE2,color=tissue)) + </span><br><span class="line">  geom_point()  + </span><br><span class="line">  geom_text(aes(label=tissue)) + </span><br><span class="line">  theme_bw()</span><br><span class="line"></span><br><span class="line">ggplot(data = tSNE_res.df, aes(tSNE1,tSNE3,color=tissue)) + </span><br><span class="line">  geom_point()  + </span><br><span class="line">  geom_text(aes(label=tissue)) + </span><br><span class="line">  theme_bw()</span><br><span class="line"></span><br><span class="line">ggplot(data = tSNE_res.df, aes(tSNE2,tSNE3,color=tissue)) + </span><br><span class="line">  geom_point()  + </span><br><span class="line">  geom_text(aes(label=tissue)) + </span><br><span class="line">  theme_bw()</span><br><span class="line"></span><br><span class="line"><span class="comment"># use plotly (3D)</span></span><br><span class="line">library(plotly)</span><br><span class="line"></span><br><span class="line">p &lt;- plot_ly(tSNE_res.df, x = ~tSNE1, y = ~tSNE2, z = ~tSNE3, color = ~tissue) %&gt;%</span><br><span class="line">  add_markers() %&gt;%</span><br><span class="line">  layout(scene = <span class="built_in">list</span>(xaxis = <span class="built_in">list</span>(title = <span class="string">&#x27;tSNE1&#x27;</span>),</span><br><span class="line">                      yaxis = <span class="built_in">list</span>(title = <span class="string">&#x27;tSNE2&#x27;</span>),</span><br><span class="line">                      zaxis = <span class="built_in">list</span>(title = <span class="string">&#x27;tSNE3&#x27;</span>)))</span><br><span class="line">p</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>STAT</category>
      </categories>
      <tags>
        <tag>Stat</tag>
      </tags>
  </entry>
  <entry>
    <title>TOEFL-Wordlist</title>
    <url>/2021/02/20/TOEFL-Wordlist/</url>
    <content><![CDATA[<p>210220</p>
<ol>
<li><p><strong>sentence</strong> n./vt. 判决，宣判<br>serve a sentence 服刑</p>
<ul>
<li>Tom will be sentenced to death/life imprisonment/three years in prison.</li>
</ul>
</li>
<li><p><strong>impact</strong> vi./vt.  影响(on, upon); 对。。。有影响；（天文）撞击</p>
</li>
<li><p><strong>complex</strong> == system n. 复合体；综合设施<br>a sports complex/building complex建筑群/to suffer from a guilt complex 内疚感</p>
<ul>
<li>This is just one of a whole complex of issue.</li>
</ul>
</li>
<li><p><strong>amount</strong> v. 总计，合计；等于，相当于；发展成，变成</p>
<ul>
<li>The bill amounts to $10.</li>
<li>They gave me some help in the beginning but it did not amount to much(== they did not give me much help)</li>
</ul>
</li>
<li><p><strong>outgassing</strong>  n.除气；脱气  adj. 除气的；释气的</p>
<ul>
<li>The origin of our present atmosphere is therefore a combination of terrestrial outgassing and interplanetary assault (further changed by later biological events). (20190810真题)</li>
<li>Little by little, the planet generated a new, secondary atmosphere by volcanic outgassing of volatile（挥发性的，不稳定的） materials from its interior. (2015年真题Earth’s Atmosphere)</li>
</ul>
</li>
<li><p>易混词</p>
<ul>
<li><p><strong>vary</strong></p>
<ul>
<li>variety: a variety ofbeedback mechanisms vs. a myriad of 大量的，无数的</li>
<li>various/varied</li>
<li>variable n.变量/invariable n.常量</li>
<li>invariable：不变地，一定地(== always/constantly/customarily/regularly)</li>
</ul>
</li>
<li><p><strong>effect</strong></p>
<ul>
<li>effect:  n.结果 v.造成  the oppposite effect</li>
<li>effective:  adj,有效性  vs. efficient有效率的/ineffective无效的</li>
<li>effectiveness:  n. 效力</li>
<li>affect:  vt.影响  affect my decision</li>
<li>affection:  n. 喜爱(for sb./sth.)</li>
</ul>
</li>
<li><p><strong>object</strong></p>
<ul>
<li>object:  n. 目标；物体；客体；宾语  v. 反对  Many local people object to the building of the new airport</li>
<li>objective:  n. 目的，目标  adj.客观的  an objective analysis</li>
<li>objection:  n. 异议  I have no objection to him coming to stay.</li>
<li>subject:  n. 主题；起因；科目；国民；主旋律  adj.易遭受…的  v.(使)臣服 </li>
<li>subjective:  adj. 主观的；个人的</li>
</ul>
</li>
<li><p><strong>economy</strong></p>
<ul>
<li>economy:  n.经济  The economy is in recession</li>
<li>economic:  adj.经济上的；合算的</li>
<li>economical:  adj.节俭的  an economical car to run/ He was economical in all areas of his life</li>
<li>economically:  adv.节俭的</li>
<li>econimics:  n.经济学</li>
</ul>
</li>
<li><p><strong>technique</strong></p>
<ul>
<li>technique:  n.技巧，技法  (==method/approach/means/craft)</li>
<li>technical:  adj.技术上的  offer technical support</li>
<li>technology(-ies):  n.技术；工艺  high technology/information technology</li>
<li>technological:  adj.技术的；工艺的  technological innovation  (== industrial/mechanical) </li>
</ul>
</li>
</ul>
</li>
</ol>
<hr>
<p>210221</p>
]]></content>
      <categories>
        <category>TOEFL</category>
      </categories>
      <tags>
        <tag>TOEFL</tag>
      </tags>
  </entry>
  <entry>
    <title>TOEFL-writing-00</title>
    <url>/2021/02/19/TOEFL-writing-00/</url>
    <content><![CDATA[<h1 id="题型"><a href="#题型" class="headerlink" title="题型"></a>题型</h1><ol>
<li>综合写作 20 min 150-225字</li>
</ol>
<ul>
<li>阅读：3分钟 300词<br>话题关于什么，分论点是什么</li>
<li>听力：2分钟 330词<br>针对阅读短文进行他的论点阐述，理由最重要的点<br>记笔记很重要!!!!</li>
</ul>
<ol start="2">
<li>独立写作 30 min 400字左右</li>
</ol>
<ul>
<li><p>题型分类</p>
<ul>
<li><p>维度1：内容<br> <strong>利弊题：好不好</strong><br> People <strong>should</strong> relax with hobbies or physical activities that are different from what they do in Work.</p>
<p> 逻辑起点(A or B or C)——&gt;逻辑终点</p>
<p> <strong>现象题：现象存在还是不存在，古今对比题</strong><br> Agree or disagree? Students nowadays do not respect their teachers as much as they did in the past.</p>
</li>
<li><p>维度2：选项<br> <strong>二选一</strong><br> It is better to relax by watching a movie or reading a book than relax by doing physical exercise</p>
<p> <strong>三选一</strong><br> In times of an econimic crisis, in which area should governments reduce its spending? 1)Arts. 2)Scientific research. 3)Parks and public gardens </p>
<p> <strong>一个选项</strong><br> It is a waste of money for government to fund space travel. </p>
<p> The best way for the government to improve health care is cleaning the enivironment.</p>
</li>
</ul>
</li>
<li><p>练习</p>
<blockquote>
<p>例1：People should relax with hobbies or physical activities that are different from what they do in work</p>
</blockquote>
<p>  利弊题+二选一：<br>  different hobbies and physical activities ——&gt; good</p>
<blockquote>
<p>例2：Which one is the most important for teacher of high school:   1) The ability to help students plan for their future;    2) The ability to find the students who need help most and help them;    3) Teach students how to learn outside the classroom.</p>
</blockquote>
<p>  利弊题+三选一：<br>  learn outside classrooms  ——&gt; good</p>
<blockquote>
<p>例3：Agree or disagree? Students nowadays do not respect their teachers as much as they did in the past.</p>
</blockquote>
<p>  现象题：now respect teachers</p>
</li>
</ul>
<hr>
<h1 id="破题方法"><a href="#破题方法" class="headerlink" title="破题方法"></a>破题方法</h1><h2 id="利弊题"><a href="#利弊题" class="headerlink" title="利弊题"></a>利弊题</h2><p>论证<strong>逻辑起点</strong>对于<strong>逻辑终点</strong>的好处</p>
<blockquote>
<p>例1：Compared with people who live in <strong>cities</strong>, people who live in rural areas can <strong>take better care of families</strong>.<br>逻辑起点：住在城市<br>逻辑终点：住在城市能更好的照顾家人</p>
</blockquote>
<p>理由说两大论点：</p>
<ol>
<li>cities ——&gt; more money：<br>education,<br>medical care</li>
<li>cities ——&gt; infrastructure:<br>supermarkert,<br>transportation </li>
</ol>
<blockquote>
<p>例2：If your teacher says something incorrect in a class, what will you do? 1) Interrupt your teacher right away; 2) keep silent;  3) correct your teacher after class.</p>
</blockquote>
<p>after class ——&gt; good<br>理由说两大论点：</p>
<ol>
<li>after class ——&gt; relationship:<br>respect<br>communicate;</li>
<li>after class ——&gt; academic performance:<br>errors<br>knowledge</li>
</ol>
<blockquote>
<p>例3：The best way for the government to improve health care is cleaning the environmment.</p>
</blockquote>
<p>法一：<br>clean environ. ——&gt; health care<br>方面说把health care 下切:</p>
<ol>
<li>clean environ. ——&gt; physical health: 理由说<br>air quality<br>food quality</li>
<li>clean environ. ——&gt; mental health: 理由说<br>less pressure<br>happiness</li>
</ol>
<p>法二:<br>需要重点与clean envirn.对比，扣题</p>
<ol>
<li>health education ——&gt; health care：(方面说)<br>knowledge<br>exercise</li>
<li>medical care ——&gt; health care: (方面说)<br>hopistals<br>experts</li>
</ol>
<h2 id="现象题"><a href="#现象题" class="headerlink" title="现象题"></a>现象题</h2><p>写法1：现象产生的原因——why<br>写法2：现象的具体体现——切点</p>
<blockquote>
<p>例1：Nowadays, younger people spend more time on improving the world than in the past.</p>
</blockquote>
<p>法一：<br>现象产生的两大原因（理由说）：</p>
<ol>
<li>busy ——&gt; now less time improve world: 忙于什么方面(方面说)<br>study<br>work</li>
<li>incapable ——&gt; now less time improve world：没有能力的具体体现(方面说)<br>money<br>knowledge</li>
</ol>
<p>法二：<br>有更多的时间改善环境，投身于科技(方面说)</p>
<ol>
<li>now less time improve world ——&gt; environment：改善环境的具体体现（方面说）<br>air quality<br>water quality</li>
<li>now less time improve world ——&gt; technology：投身科技的集体体现（方面说）<br>majors<br>suggestion</li>
</ol>
<h2 id="天使题"><a href="#天使题" class="headerlink" title="天使题"></a>天使题</h2><p>题目本身包含了两个点<br>作为两个总论点或某一段的两个分论点</p>
<blockquote>
<p>例1：The <strong>personal and work-related challenges</strong> we face now are different from those our parents and grandparents faced when they were young.</p>
</blockquote>
<blockquote>
<p>例2：Children should <strong>play and study</strong> rather than learn how to do household chores.</p>
</blockquote>
<blockquote>
<p>例3：People should relax with <strong>hobbies or physical activities</strong> that are different from what they do in work.</p>
</blockquote>
<blockquote>
<p>例4：The opinions of celebrities, such as <strong>entertainers and athletes</strong>, are more impor tant to the younger people than they are to the older people.</p>
</blockquote>
<p>celebrities ——&gt; young people<br>把young people分为stu和young adults</p>
<ol>
<li>celebrities ——&gt; students<br>entertainer: fashion<br>athlete: persistence</li>
<li>celebrities ——&gt; young adults<br>entertainer: friendship<br>athlete: value exercise</li>
</ol>
<h2 id="魔鬼题"><a href="#魔鬼题" class="headerlink" title="魔鬼题"></a>魔鬼题</h2><p>题目包含从句，破题时所有思路都落在逻辑终点上</p>
<blockquote>
<p>例1：Do you agree or disagree with the following statement? To <strong>truly enjoy a vacation (holiday)</strong>, people should leave their mobile phones at home.</p>
</blockquote>
<blockquote>
<p>例2：<strong>In order to attract good students</strong>, many universities spend a lot of money in society activities.</p>
</blockquote>
<blockquote>
<p>例3：To <strong>improve health</strong>, which aspect will you change in life? 1) kinds of food to eat 2 ) the amount of exercise 3 ) the amount of stress (15.12.20) </p>
</blockquote>
<p>more exercise ——&gt; health（全部指向health,方面说）</p>
<ol>
<li>more exercise ——&gt; physical health:<br>muscle<br>eyestrain</li>
<li>more exercise ——&gt; mental health<br>less worries<br>happiness</li>
</ol>
<hr>
<h1 id="题型写法"><a href="#题型写法" class="headerlink" title="题型写法"></a>题型写法</h1><p>核心原则：让题目的key words均匀分散在文章中，特别是自己的观点，要不断出现</p>
<h2 id="key-word选取-反面对比"><a href="#key-word选取-反面对比" class="headerlink" title="key word选取+反面对比"></a>key word选取+反面对比</h2><p>删除法：删除后对句子影响很大</p>
<ol>
<li><p>A or B<br>Compared with people who live in <strong>cities</strong>, people who live in <strong>rural areas</strong> can <strong>take better care of families.</strong><br>认为A重要，对比B</p>
</li>
<li><p>A orB or C<br>If your teacher says something <strong>incorrect</strong> in a class, what will you do?  1.) <strong>Interrupt</strong> your teacher <strong>right away</strong>;  2.) keep <strong>silent</strong>;  3.) correct your <strong>teacher after class</strong>.<br>相反，interrupt/silent…</p>
</li>
<li><p>A<br>The best way for the <strong>government</strong> to improve <strong>health care</strong> is <strong>cleaning the environment.</strong><br>如果不改善环境…</p>
</li>
</ol>
<h2 id="现象题-1"><a href="#现象题-1" class="headerlink" title="现象题"></a>现象题</h2><ol>
<li>自己观点</li>
</ol>
<p><strong>Contrary to these people’s opinions is my perspective that …. due to ..</strong> (e.g. due to the contributions to果/ due to因/ including小)</p>
<ul>
<li><p>现象产生的原因:<br>  <strong>Contrary to these people’s opinions is my perspective that …</strong>, due to因<br>  eg. due to less time and capability</p>
</li>
<li><p>现象的具体体现:<br>  <strong>Contrary to these people’s opinions is my perspective that …</strong>, including小<br>  eg. including the field of environment and technology</p>
</li>
</ul>
<ol start="2">
<li>观点总结<br> <strong>To conclude, only by considering those mentioned above can we draw the conclusio that…</strong></li>
</ol>
]]></content>
      <categories>
        <category>TOEFL-Writing</category>
      </categories>
      <tags>
        <tag>TOEFL</tag>
      </tags>
  </entry>
  <entry>
    <title>TOEFL-writing-01</title>
    <url>/2021/02/18/TOEFL-writing-01/</url>
    <content><![CDATA[<h1 id="全文结构"><a href="#全文结构" class="headerlink" title="全文结构"></a>全文结构</h1><p> 开头段&lt;60&gt;<br>     总论点1&lt;160&gt;（分论点1+分论点2）<br>     总论点2&lt;160&gt;（分论点1+分论点2）<br> 结尾段&lt;60&gt;</p>
<blockquote>
<p>例1：Some students enjoy taking distance learning courses on the computer or television. Other students would rather take all of their courses with a teacher in classroom. Which is these options do you think is better?</p>
</blockquote>
<p>破题：</p>
<ol>
<li>why：理由说（在线教育为什么好）</li>
<li>切逻辑终点(good)：方面说（好在什么方面）</li>
<li>切逻辑起点(distance learning)：方面说（有哪些种在线教育）</li>
</ol>
<p>观点：在线教育好</p>
<ul>
<li>对学生学习好<ul>
<li>能获得很多的知识</li>
<li>能激发学生学习兴趣</li>
</ul>
</li>
<li>对学生个人发展好<ul>
<li>培养人际交往能力</li>
<li>培养坚持不懈</li>
</ul>
</li>
</ul>
<hr>
<h1 id="开头段"><a href="#开头段" class="headerlink" title="开头段"></a>开头段</h1><h2 id="现象引入"><a href="#现象引入" class="headerlink" title="现象引入"></a>现象引入</h2><p>N，同位语，has been valued and even triggers a heated discussion over…题目改写：</p>
<ul>
<li><p>N：</p>
<ul>
<li>话题词汇（在线教育）</li>
<li>从题目中选择的中性词汇（教育、上课方式等）</li>
</ul>
</li>
<li><p>同位语</p>
<ul>
<li>N为中性词：the fundation of a quality life</li>
<li>N为褒义词：the objective everyone strives for</li>
</ul>
</li>
<li><p>over(whether/what引导的)名词性从句</p>
</li>
</ul>
<blockquote>
<p>Education, the foundation of a quality life, <strong>has been valued and even triggers a heated discussion over</strong> whether students should take courses online or in classrooms. (现象引入)</p>
</blockquote>
<h2 id="对方观点"><a href="#对方观点" class="headerlink" title="对方观点"></a>对方观点</h2><p>主语， in some people’s view,…<br>仅需阐明现象，不用加理由</p>
<blockquote>
<p>Learning in traditional classrooms, <strong>in some people’s views</strong>, continues to be an effective way.</p>
</blockquote>
<h2 id="自己观点"><a href="#自己观点" class="headerlink" title="自己观点"></a>自己观点</h2><p>Contrary to these people’s opinions is my perspective that …, due to … (e.g. due to the contributions to果/ due to因/ including小)</p>
<blockquote>
<p><strong>Contrary to these people’s opinions is my perspective that</strong> online learning, which requires students to attend classes on computers or televisions, is superior, <strong>due to the contributions to</strong> their academic performance <strong>and</strong> personal development. (自己观点)</p>
</blockquote>
<hr>
<h1 id="中间段"><a href="#中间段" class="headerlink" title="中间段"></a>中间段</h1><h2 id="总论点1"><a href="#总论点1" class="headerlink" title="总论点1"></a>总论点1</h2><p>看图说话：在线教育对学生学习好<br>加对比和分论点</p>
<blockquote>
<p><strong>What must be prioritized is that</strong> taking distance-learning courses, instead of having courses in traditional classrooms, is beneficial to students’ academic learning, by offering them more knowledge and triggering their enthusiasm in learning. (总论点)</p>
</blockquote>
<h3 id="分论点1"><a href="#分论点1" class="headerlink" title="分论点1"></a>分论点1</h3><p>短句</p>
<blockquote>
<p>**To begin with,**it is online education that provides students with the access to a large quantity of expertises. </p>
</blockquote>
<h3 id="解释1"><a href="#解释1" class="headerlink" title="解释1"></a>解释1</h3><p>长句<br>diatance learning ——&gt; knowledge<br>理由说：有search engine<br>方面说：学生能获得什么知识</p>
<p>针对正面的论证写反面</p>
<blockquote>
<p><strong>To begin with,</strong> it is online education that provides students with the access to a large quantity of expertise. (分论点1) <strong>In detail,</strong> on the Internet, students can acquire a wide range of knowledge in history, art and science, enlarging their knowledge base; <strong>in contrast,</strong> such a large amount of knowledge cannot be obtained when they are instructed by only one teacher in concrete classrooms. (解释1+反面对比)</p>
</blockquote>
<h3 id="分论点2"><a href="#分论点2" class="headerlink" title="分论点2"></a>分论点2</h3><p>短句</p>
<blockquote>
<p><strong>Moreover,</strong> never can we ignore the significance of distance ducation to students’ interest in learning. (分论点2 ) </p>
</blockquote>
<h3 id="解释2"><a href="#解释2" class="headerlink" title="解释2"></a>解释2</h3><p>长句<br>diatance learning ——&gt; interests<br>对于学习哪些方面有兴趣</p>
<blockquote>
<p><strong>To explain it further,</strong> by receiving education on the Internet, students will find it more interesting to deal with mathematical problems, do research, and write proposals; <strong>on the other hand,</strong> will they be passionate about these tasks when teachers always lecture in brick-and-mortar classrooms? ( 解释2 )</p>
</blockquote>
<h2 id="总论点2"><a href="#总论点2" class="headerlink" title="总论点2"></a>总论点2</h2><p>personal deve.</p>
<blockquote>
<p><strong>What should be equally worth discussing is that</strong> receiving distance education, rather than having traditional face-to-face courses, can promote students’ personal development, by honing their interpersonal skills and cultivating their persistence. ( 总论点)</p>
</blockquote>
<h3 id="分论点1-1"><a href="#分论点1-1" class="headerlink" title="分论点1"></a>分论点1</h3><blockquote>
<p><strong>To begin with,</strong> it is well-acknowledged taht educated on the Internet, students can practice their communication skills.</p>
</blockquote>
<h3 id="解释1-1"><a href="#解释1-1" class="headerlink" title="解释1"></a>解释1</h3><p>distance ——&gt; interpersonal<br>为什么能够培养社交能力</p>
<blockquote>
<p><strong>Specifically,</strong> only in online learning environments will students come across peop;e from diverse backgrounds, such as classmates, instructors and school administrators, with whom they can practice their tactics of socializing; <strong>on the contrary</strong>, under no circumstances will they interact with such a variety of people if they are educated in traditional classroom settings.</p>
</blockquote>
<h3 id="分论点2-1"><a href="#分论点2-1" class="headerlink" title="分论点2"></a>分论点2</h3><p>distance learning ——&gt; persistence<br>理由说：为什么会变的persistence</p>
<blockquote>
<p><strong>Additionally</strong>, when having a distance education program,students will become more determined. ( 分论点2 ) </p>
</blockquote>
<h3 id="解释2-1"><a href="#解释2-1" class="headerlink" title="解释2"></a>解释2</h3><p><strong>To be more specific</strong>, the more distance-learning courses they take on the Internet, the more distractions they will be exposed to, stimulating them to resist temptations and foster their persistence; however, it is impossible for them to encounter these lures in traditional classrooms.</p>
<h1 id="结尾段"><a href="#结尾段" class="headerlink" title="结尾段"></a>结尾段</h1><blockquote>
<p>Academic performance, <strong>the foundation of students’ future development</strong>, will be boosted when they receive online education. (总结总论点1) Personal development, <strong>essential contributors to students’ future success</strong>, will be<br>facilitated, if they are educated on the Internet. (总结总论<br>点2) <strong>To conclude, only by</strong> having distance education,<br><strong>instead of</strong> being taught in classrooms, <strong>can</strong> students reap numerous benefits. (总结全文)</p>
</blockquote>
<h1 id="模板总结"><a href="#模板总结" class="headerlink" title="模板总结"></a>模板总结</h1><h2 id="开头段-1"><a href="#开头段-1" class="headerlink" title="开头段"></a>开头段</h2><ol>
<li>…, 同位语, has been valued and even triggers a heated discussion over …</li>
<li>…, in some/many people’s view,…</li>
<li>Contrary to these people’s opinions is my perspective that …, due to the contributions to … and …<h2 id="中间段-1"><a href="#中间段-1" class="headerlink" title="中间段"></a>中间段</h2></li>
<li>What must be prioritized is that … /What is equally worth discussion is that…</li>
<li>Initially/ Firstly /To begin with,</li>
<li>To be more specific, /Specifically, / In detail, /To explain it further… + however, /in contrast, /on the contrary,/on the other hand,<h2 id="结尾段-1"><a href="#结尾段-1" class="headerlink" title="结尾段"></a>结尾段</h2></li>
<li>第一个理由，同位语，will…</li>
<li>第二个理由，同位语，will…</li>
<li>In conclusion, only + 状语 + 半倒装</li>
</ol>
]]></content>
      <categories>
        <category>TOEFL-Writing</category>
      </categories>
      <tags>
        <tag>TOEFL</tag>
      </tags>
  </entry>
  <entry>
    <title>TOEFL-writing-02</title>
    <url>/2021/02/20/TOEFL-writing-02/</url>
    <content><![CDATA[<h1 id="笔记概述"><a href="#笔记概述" class="headerlink" title="笔记概述"></a>笔记概述</h1><ol>
<li>专有名词<br> 固定说法，很难找到同义词的名词（eg. 电脑、台灯…）</li>
<li>意思（逻辑）<br>转折逻辑: however, but, although<br>并列逻辑: and, also, moreover, in addition<br>总分逻辑: such as, for example, one of which<br>因果逻辑: because, so, thus, therefore<br>顺序逻辑: first, and then, when, after</li>
</ol>
<hr>
<h1 id="阅读笔记"><a href="#阅读笔记" class="headerlink" title="阅读笔记"></a>阅读笔记</h1><p>topic sentence关键词：支持topic sentence的专有名词</p>
<h2 id="开头段："><a href="#开头段：" class="headerlink" title="开头段："></a>开头段：</h2><p>主题词，（3个）xxx（reason,goal…）</p>
<h2 id="中间段："><a href="#中间段：" class="headerlink" title="中间段："></a>中间段：</h2><p>如果有小标题，小标题就是TS<br>细节只记录支持TS的名词</p>
<hr>
<h1 id="听力笔记"><a href="#听力笔记" class="headerlink" title="听力笔记"></a>听力笔记</h1><p><strong>脑记意思</strong><br>（主）对比专名<br>（次）逻辑符号<br>竖着写，每行一个词</p>
<h2 id="开头段"><a href="#开头段" class="headerlink" title="开头段"></a>开头段</h2><p>记录男女<br>关注主旨句</p>
<h2 id="中间段"><a href="#中间段" class="headerlink" title="中间段"></a>中间段</h2><p>听，脑记意思，听听力是如何<strong>反驳阅读内容</strong><br>笔,仅记录<strong>反驳阅读的专有名词</strong>，即对比专名，和<strong>明显简单的逻辑</strong>，一定要筛选信息<br>适当<strong>缩写</strong>，不要试图把单词都能拼写完整</p>
<hr>
<h1 id="补笔记"><a href="#补笔记" class="headerlink" title="补笔记"></a>补笔记</h1><p>按照第三段、第一段、第二段的顺序串意思、单词记全</p>
]]></content>
      <categories>
        <category>TOEFL-Writing</category>
      </categories>
      <tags>
        <tag>TOEFL</tag>
      </tags>
  </entry>
  <entry>
    <title>TOEFL-writing-03</title>
    <url>/2021/02/20/TOEFL-writing-03/</url>
    <content><![CDATA[<h1 id="并列连词"><a href="#并列连词" class="headerlink" title="并列连词"></a>并列连词</h1><p>前后语法一致</p>
<ul>
<li>and, but, or, So</li>
<li>not…but…<br> not only…but also…<br> both…and…<br> neither…nor…<br> either…or…<br> …rather than…<br> as well as</li>
</ul>
<h1 id="副词和介词短语（状语）"><a href="#副词和介词短语（状语）" class="headerlink" title="副词和介词短语（状语）"></a>副词和介词短语（状语）</h1><p>不能并列两个相同的短语</p>
<ul>
<li>因为: because of / due to / owing to / thanks to / on account of / as a result of / as a consequence of</li>
<li>所以: <strong>thus, therefore, as a consequence, as a result</strong></li>
<li>转折: however, nevertheless, conversely, in contrast, on the contrary, on the other hand</li>
<li>让步: admittedly, despite / in spite of</li>
<li>递进: <strong>even</strong></li>
<li>无论: regardless of /disregarding</li>
<li>目的是: to/ in order to/ so as to/ for the sake of/ for the purpose of</li>
<li>通过做: via / by / through</li>
<li>没有做: without</li>
</ul>
<h1 id="特殊的平行结构：比较结构"><a href="#特殊的平行结构：比较结构" class="headerlink" title="特殊的平行结构：比较结构"></a>特殊的平行结构：比较结构</h1><p>A和B需要对等<br>A is more … than B<br>A, compared with B,…<br>A, unlike B, …<br>A, like B, …<br>A, in contrast to B,…</p>
<h1 id="插入语"><a href="#插入语" class="headerlink" title="插入语"></a>插入语</h1><h2 id="三大从句"><a href="#三大从句" class="headerlink" title="三大从句"></a>三大从句</h2><p>定语从句: She is a girl, <em>who is happy</em>.<br>状语从句: <em>When the sun rises</em>, she goes to school.<br>名词性从句：<br>    主语从句: <em>What I like</em> are apples.<br>    宾语从句: I think <em>that it is great</em>.<br>    表语从句: His suggestion is <em>that we should stay here</em>.<br>    同位语从句: I heard the news <em>that our team had won</em>.</p>
<h2 id="形式主语-形式宾语"><a href="#形式主语-形式宾语" class="headerlink" title="形式主语/形式宾语"></a>形式主语/形式宾语</h2><ul>
<li>形式主语：<br>  X + is + n/adj.<br>  -&gt; It is + n/adj + X.  <strong>e.g.</strong> That students are afraid of exams is well-acknowledged.<br>  -&gt; It is well-acknowledged that students are afraid of exams.</li>
</ul>
<ul>
<li><p>形式宾语<br>  make, find ,think,feel.consider,believe + Y + adj/n<br>  -&gt; make, find ,think, feel,consider, believe + it + adj/n+ Y</p>
<p>  <strong>e.g.</strong> I think that we do exercise necessary.<br>  -&gt; I think it necessary that we do exercise.</p>
</li>
</ul>
<h2 id="特殊用法：介宾结构"><a href="#特殊用法：介宾结构" class="headerlink" title="特殊用法：介宾结构"></a>特殊用法：介宾结构</h2><p>Employees need to find meaning <em>in what they do</em>.<br>Humorous friends can communicate with people <em>about how they reduce pressure</em>.</p>
<h1 id="变化主语"><a href="#变化主语" class="headerlink" title="变化主语"></a>变化主语</h1><ol>
<li><p>避免总是用people<br> 非“人”名词、doing、it形式主语</p>
<blockquote>
<p>Researchers will benifit from receiving new ideas.改写：<br>  <strong>The adoption of new ideas</strong> will benifit researchers.<br>  <strong>Adopting new ideas</strong> will benifits researchers.<br>  <strong>It</strong> is beneficial for researchers to receive new ideas.</p>
</blockquote>
</li>
<li><p>给主语戴帽子<br> 状语从句、非谓语、介词短语</p>
<blockquote>
<p>Researchers will benifit from receiving new ideas.改写：<br>  <strong>After adopting new ideas</strong>, researfchers will benifit.<br>  <strong>Adopting new ideas,</strong> researchers will benefit.<br>  <strong>By adopting new ideas,/With new ideas adopted.</strong> researchers will benifit.</p>
</blockquote>
<blockquote>
<p>Employees are encouraged by their supervisor’s open-mindedness and will work diligently.改写：<br>  <strong>The supervisor’s open-mindedness</strong> encourages employees to work diligently.<br>  <strong>Being open-minded</strong> makes it possible for the supervisor t0 encourage employees to work diligently.<br>  <strong>It</strong> is encouraging for employees to see their supervisor ‘s open-mindedness, who thus will work diligently.<br>  <strong>When encouraged by their supervisor’s open-mindedness,</strong> employees will work diligently.<br>  <strong>Encouraged by their supervisor’s open-mindedness,</strong> employees will work diligently.<br>  <strong>By being encouraged by their supervisor’s open-mindedness</strong>, employees will work diligently.</p>
</blockquote>
</li>
</ol>
<h1 id="特殊句式"><a href="#特殊句式" class="headerlink" title="特殊句式"></a>特殊句式</h1><p><strong>强（强调）倒（倒装）更多（The more），而且(Not only but also)反问（反问句）</strong><br>|位置        | 句式                                                                  |<br>|:———-:|:——————————————————————–:|<br>| 2个总论点   | What                                                                 |<br>| 4个分论点   | it is … that/never…/only by doing/the more/<strong>not only but also</strong> |<br>| 4个正面展开 | it is … that/never…/only by doing/the more                       |<br>| 4个反面对比 |  it is … that/never…/only by doing/the more/<strong>how…?</strong>          |</p>
<h2 id="强调句-It-is-…-that-…"><a href="#强调句-It-is-…-that-…" class="headerlink" title="强调句 It is … that …"></a>强调句 It is … that …</h2><p>It is new friends that can bring different thoughts and new perspectives.<br>It is different thoughts and new perspectives that new friends can bring.<br>It is in the family of native speakers that people can learn a language more effectively.</p>
<h2 id="倒装句"><a href="#倒装句" class="headerlink" title="倒装句"></a>倒装句</h2><p>助动词+主语+剩下的谓语</p>
<ol>
<li><p>否定词放在句首+半倒装<br>否定词: never, seldom, rarely, barely, scarcely, hardly, little, neither, nor, under no circumstances, on no occasions, in no cases</p>
<blockquote>
<p>People under no circumstances live away from junk food.改写：<br>  Under no circumstances do people live away from junk food.</p>
</blockquote>
<ul>
<li>特殊：Not only + 半倒装，but also…<br>Not only will they hone tehir skills, but they can cultivate their personalities.</li>
</ul>
</li>
<li><p>Only+状语+半倒装<br> 状语的形式包括</p>
<ul>
<li>介词短语：by, through, via</li>
<li>状语从句：when sb do, if sb do</li>
<li>副词：then<blockquote>
<p>Only by using the Internet can people explore a wide range of information.<br>Only when people surf the Internet can they explore a wide range of information.</p>
</blockquote>
</li>
</ul>
</li>
</ol>
<h2 id="更多更多"><a href="#更多更多" class="headerlink" title="更多更多"></a>更多更多</h2><p><strong>The more+完整&amp;正常的句子，the more+完整&amp;正常的句子.</strong></p>
<ul>
<li>逗号的前后是两个完整的句子，即有主语和谓语</li>
<li>正常语序的句子，仅提前the more的部分</li>
<li>也可以是the less (修饰un和verb )以及the fewer (修饰cns)</li>
<li>只能the more两次，如果还有结果，可以用非谓语… ,doing或非限定性定语从句… ,which </li>
</ul>
<blockquote>
<p>1、The government invests in education more. Students benefit more.<br> -&gt;The more the government invests in education. the more students benefit.<br>  2、She works harder. She is more likely to win.<br> -&gt; The harder she works, the more likely she is to win.<br>  3、He has fewer chances to hike. He is less healthy. It makes it hard for him to concentrate on work.<br> -&gt; The fewer chances he has to hike, the less healthy he is. making it hard for him to concentrate on work.<br> -&gt; The fewer chances he has to hike, the less healthy he is, which makes it hard for him to concentrate on work.</p>
</blockquote>
<h2 id="反问句"><a href="#反问句" class="headerlink" title="反问句"></a>反问句</h2><p>How…?<br>Could…?</p>
]]></content>
      <categories>
        <category>TOEFL-Writing</category>
      </categories>
      <tags>
        <tag>TOEFL</tag>
      </tags>
  </entry>
  <entry>
    <title>RNA-seq: Spike-in/Housekeeping gene normalization</title>
    <url>/2021/03/04/RNA-seq-Spike-in-Housekeeping-gene-normalization/</url>
    <content><![CDATA[<p><strong>RNA-seq基本假设：</strong>  </p>
<ul>
<li> 绝大多数基因不发生表达量的变化  </li>
<li> 特别高表达的基因不发生表达量的变化</li>
</ul>
<p><strong>若不满足以上基本假设（癌旁组织等）：</strong>  </p>
<ol>
<li>使用ERCC RNA spike-ins，绝对定量，假设样本间ERCC的量相同  </li>
<li>假设housekeeping基因表达量变化量不大  </li>
</ol>
<hr>
<p><strong>ERCC(External RNA Controls Consortium, 外源RNA-SEQ标准库)</strong><br>建库时掺入外源rna，因为知道它的绝对量，可以计算<br>很贵<br>两种比例：Mix1，Mix2<br>分析思路：  </p>
<ul>
<li>与普通的RNA-Seq数据分析流程基本一致  </li>
<li>在构建Reference的时候需要把ERCC spike-in的序列一起添加到参考基因组，一起构建比对软件如HISAT2, STAR等的index文件;  </li>
<li>下游使用软件分析，认为sample之间spike-in的量是恒定相等的  </li>
<li>官网上下载后整理成fasta，贴到染色体后面，在构建index时把ERCC构建进去  </li>
</ul>
<hr>
<p><strong>Housekeeping gene</strong><br>RUVSeq package (Bioconductor)<br>在不同组织、器官、不同刺激下都表达，3000-4000个<br>2013-Trend in Genetics-Human housekeeping genes revisited 可以下载list of housekeeping gene  </p>
<ul>
<li>假设：sample之间housekeeping之间的表达量基本不发生变化——&gt;校正（不需要再用Quantile,RLE,TMM等做校正） </li>
<li>本质: 是对RNA-Seq数据进行矫正(Normalization),矫正过后的count数据，可以正常进行差异表达分析，如使用edgeR或者DESeq2等  </li>
<li>输入：原始表达矩阵+认为不变的gene id list   </li>
<li>输出：经过校正的表达矩阵（count/FPKM/TPM/CPM…)      </li>
</ul>
<hr>
<h1 id="spike-in-or-housekeeping-gene-normalization"><a href="#spike-in-or-housekeeping-gene-normalization" class="headerlink" title="spike-in or housekeeping gene normalization"></a>spike-in or housekeeping gene normalization</h1><figure class="highlight r"><table><tr><td class="code"><pre><span class="line">rm(<span class="built_in">list</span>=ls())</span><br><span class="line"></span><br><span class="line"><span class="comment"># BiocManager::install(&quot;RUVSeq&quot;)</span></span><br><span class="line">library(Biobase)</span><br><span class="line">library(BiocGenerics)</span><br><span class="line">library(parallel)</span><br><span class="line">library(EDASeq)</span><br><span class="line">library(ShortRead)</span><br><span class="line">library(BiocParallel)</span><br><span class="line">library(Biostrings)</span><br><span class="line">library(S4Vectors)</span><br><span class="line">library(stats4)</span><br><span class="line">library(IRanges)</span><br><span class="line">library(XVector)</span><br><span class="line">library(Rsamtools)</span><br><span class="line">library(GenomeInfoDb)</span><br><span class="line">library(GenomicAlignments)</span><br><span class="line">library(SummarizedExperiment)</span><br><span class="line">library(MatrixGenerics)</span><br><span class="line">library(matrixStats)</span><br><span class="line">library(edgeR)</span><br><span class="line">library(limma)</span><br><span class="line">library(RUVSeq)</span><br></pre></td></tr></table></figure>


<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">setwd(<span class="string">&quot;C:/Users/Surface/Desktop/Meng&#x27;s Lesson/RNA-seq/20200926-第5次直播-相关代码_数据_结果/20200926-第5次直播-相关代码_数据_结果/&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># load raw count table </span></span><br><span class="line">count_df &lt;- read.table(file = <span class="string">&quot;./293T-RNASeq-Ctrl_vs_KD.STAR.hg38.featureCounts.FixColName.tsv&quot;</span>,header = <span class="built_in">T</span>,sep = <span class="string">&quot;\t&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># load housekeeping gene list</span></span><br><span class="line">hsk_gene_df &lt;- read.table(file = <span class="string">&quot;./human_housekeeping_gene_list.txt&quot;</span>,header = <span class="built_in">T</span>,sep = <span class="string">&quot;\t&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># check in list gene number</span></span><br><span class="line"><span class="comment"># 95 genes not in the new version of housekeeping gene</span></span><br><span class="line">table(hsk_gene_df$gene_id %in% rownames(count_df))</span><br><span class="line"></span><br><span class="line"><span class="comment"># select Housekeeping gene list</span></span><br><span class="line">hsk_gene_id.count &lt;- count_df[rownames(count_df) %in% hsk_gene_df$gene_id,]</span><br><span class="line">hsk_gene_id.list &lt;- rownames(count_df)[rownames(count_df) %in% hsk_gene_df$gene_id]</span><br><span class="line"></span><br><span class="line"><span class="comment"># select upper 100~200</span></span><br><span class="line">mean.value &lt;- apply(hsk_gene_id.count, <span class="number">1</span>, mean)</span><br><span class="line"></span><br><span class="line">hsk_gene_id.list.select &lt;- hsk_gene_id.list[order(mean.value,decreasing = <span class="built_in">T</span>)][<span class="number">800</span>:<span class="number">1000</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># make sample info table</span></span><br><span class="line">sample_df &lt;- data.frame(</span><br><span class="line">  condition = as.factor(<span class="built_in">c</span>(<span class="built_in">rep</span>(<span class="string">&quot;ctrl&quot;</span>,<span class="number">2</span>), <span class="built_in">rep</span>(<span class="string">&quot;KD&quot;</span>,<span class="number">2</span>))),</span><br><span class="line">  row.names = colnames(count_df)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># make obj</span></span><br><span class="line">set.obj &lt;- newSeqExpressionSet(counts = as.matrix(count_df), phenoData = sample_df)</span><br><span class="line">set.obj</span><br><span class="line"></span><br><span class="line">plotPCA(set.obj)</span><br><span class="line">plotRLE(set.obj,ylim=<span class="built_in">c</span>(-<span class="number">1</span>,<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># normalize by housekeeping gene</span></span><br><span class="line">set.norm.obj &lt;- RUVg(set.obj, hsk_gene_id.list.select, k=<span class="number">2</span>)</span><br><span class="line">plotPCA(set.norm.obj)</span><br><span class="line">plotRLE(set.norm.obj,ylim=<span class="built_in">c</span>(-<span class="number">1</span>,<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># check normal count</span></span><br><span class="line">count_df.norm_hsk &lt;- normCounts(set.norm.obj)</span><br><span class="line">head(count_df.norm_hsk)</span><br><span class="line"></span><br><span class="line"><span class="comment"># check normalize colSums count</span></span><br><span class="line">colSums(count_df)</span><br><span class="line">colSums(count_df.norm_hsk)</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h1 id="find-DEGs-with-edgeR"><a href="#find-DEGs-with-edgeR" class="headerlink" title="find DEGs with edgeR"></a>find DEGs with edgeR</h1><p>差异表达分析步骤：  </p>
<ol>
<li>normalization  </li>
<li>estimate dispersion  </li>
<li>fit and find DEGs  </li>
</ol>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment"># condition table</span></span><br><span class="line">group_info = <span class="built_in">c</span>(<span class="built_in">rep</span>(<span class="string">&quot;ctrl&quot;</span>,<span class="number">2</span>), <span class="built_in">rep</span>(<span class="string">&quot;KD&quot;</span>,<span class="number">2</span>))</span><br><span class="line">design.mat &lt;- model.matrix(~group_info)</span><br><span class="line"></span><br><span class="line"><span class="comment"># build obj</span></span><br><span class="line">dge.list.obj &lt;- DGEList(counts = normCounts(set.norm.obj), group = group_info)</span><br><span class="line">dge.list.obj</span><br><span class="line"></span><br><span class="line">dge.list.obj &lt;- calcNormFactors(dge.list.obj,method = <span class="string">&quot;upperquartile&quot;</span>)</span><br><span class="line">dge.list.obj$samples</span><br><span class="line"></span><br><span class="line"><span class="comment"># Norm -&gt; estimate dispersion -&gt; find DEGs</span></span><br><span class="line">dge.list.obj &lt;- estimateDisp(dge.list.obj,design.mat)</span><br><span class="line">dge.list.obj$common.dispersion</span><br><span class="line">head(dge.list.obj$tagwise.dispersion)</span><br><span class="line"></span><br><span class="line"><span class="comment"># find DEGs</span></span><br><span class="line">fit &lt;- glmFit(dge.list.obj, design.mat)</span><br><span class="line">lrt &lt;- glmLRT(fit, coef=<span class="number">2</span>)</span><br><span class="line">DEGs.res.lrt &lt;- as.data.frame(topTags(lrt,n=nrow(count_df.norm_hsk),sort.by = <span class="string">&quot;logFC&quot;</span>))</span><br><span class="line">head(DEGs.res.lrt)</span><br></pre></td></tr></table></figure>
<p>可以发现，FDR基本上都等于1<br>原因：用的管家基因太多了<br>解决：找变化最小的100，200个来做  </p>
]]></content>
      <categories>
        <category>RNA-seq</category>
      </categories>
      <tags>
        <tag>RNA-seq</tag>
      </tags>
  </entry>
  <entry>
    <title>Troubleshooting</title>
    <url>/2021/02/04/Troubleshooting/</url>
    <content><![CDATA[<h2 id="【R】"><a href="#【R】" class="headerlink" title="【R】"></a>【R】</h2><ol>
<li><p>20200312<br>outlierKD(final_ns$CS.lymph.nodes..2004..,lymph)</p>
<blockquote>
<p>报错：$ operator is invalid for atomic vectors<br>解决：赋值给对象后在放入函数<br>lymph &lt;- final_ns$CS.lymph.nodes..2004..<br>outlierKD(final_ns,lymph)</p>
</blockquote>
</li>
<li><p>20200504<br>最无语最神经病的报错！！<br>kk &lt;- paste(“Surv(final_dat$Survival.months, final_dat$status)”,insertVar,sep=”~”);<br>fit_insertVar &lt;- survfit(as.formula(kk),data = final_dat)</p>
<blockquote>
<p>报错：找不到对象kk<br>解决：两个&lt;&lt;表示将kk设在全局<br>kk &lt;&lt;- paste(“Surv(final_dat$Survival.months, final_dat$status)”,insertVar,sep=”~”);</p>
</blockquote>
</li>
<li><p>201128<br>BiocManager::install(“hgu133a2.db”)</p>
<blockquote>
<p>Warning：installation of package ‘hgu133a2.db’ had non-zero exit status<br>解决：一般是依赖包的问题，先加载完所有的dependency就可以library了</p>
</blockquote>
</li>
<li><p>201224<br>BiocManager::install(“DOSE”)</p>
<blockquote>
<p>Warning message:<br>In file.copy(savedcopy, lib, recursive = TRUE) :<br>拷贝C:\Users\Surface\Documents\R\win-library\4.0\00LOCK\vctrs\libs\x64\vctrs.dll到C:\Users\Surface\Documents\R\win-library\4.0\vctrs\libs\x64\vctrs.dll时出了问题：Permission denied<br>解决：依赖的包现在正在环境下使用，需要把它先<code>detach()</code>，再安装</p>
</blockquote>
</li>
<li><p>210103<br>有的时候RStudio会突然卡住，只有右上角的最小化、关闭、窗口大小可以点，这个时候点一下那个窗口大小，再全屏一下就可以了，超级神奇</p>
</li>
<li><p>210201<br>BiocManager::install()</p>
<blockquote>
<p>Installation path not writeable, unable to update packages: boot, class,<br>codetools, foreign, KernSmooth, Matrix, nlme, nnet, spatial<br>解决：installed.packages()[, c(“Package”, “LibPath”)] 来查看所有的R包位置。<br>Sys.chmod(“file”,’777’) 设置装在哪里，其中file是你R包安装的位置</p>
</blockquote>
</li>
</ol>
<h2 id="【Python】"><a href="#【Python】" class="headerlink" title="【Python】"></a>【Python】</h2><ol>
<li>201128<blockquote>
<p>报错：python SyntaxError: EOL while scanning string literal<br>错误原因：字符串以 \ 结尾 或者字符串缺少引号。</p>
</blockquote>
</li>
</ol>
<h2 id="【Perl】"><a href="#【Perl】" class="headerlink" title="【Perl】"></a>【Perl】</h2><p>—To Be Continue—</p>
]]></content>
      <categories>
        <category>Records</category>
      </categories>
      <tags>
        <tag>Debug</tag>
      </tags>
  </entry>
  <entry>
    <title>RNA-seq: GSEA &amp; ssGSEA</title>
    <url>/2021/03/08/RNA-seq-GSEA-ssGSEA/</url>
    <content><![CDATA[<h1 id="GSEA（Gene-Set-Enrichment-Analysis）"><a href="#GSEA（Gene-Set-Enrichment-Analysis）" class="headerlink" title="GSEA（Gene Set Enrichment Analysis）"></a><strong>GSEA（Gene Set Enrichment Analysis）</strong></h1><p>该方法发表于2005年的<a href="https://www.pnas.org/content/pnas/102/43/15545.full.pdf">Gene set enrichment analysis: a knowledge-based approach forinterpreting genome-wide expression profiles</a>，是一种基于基因集的富集分析方法。</p>
<p>在对基因表达数据分析时，首先确定分析的目的，即选择MSigDB中的一个或多个功能基因集进行分析，然后基于基因表达数据与表型的关联度（也可以理解为表达量的变化）的大小进行排序。然后判断每个基因集内的基因是否富集于表型相关度排序后基因列表的上部或下部，从而判断此基因集内基因的协同变化对表型变化的影响。</p>
<p><img src="/img/article/RNA-seq/GSEA.png" alt="GSEA"></p>
<p>GSEA的输入是一个基因表达量矩阵，其中的样本分成了A和B两组，找到两组之间差异表达的基因，然后根据foldchange进行排序，用来表示基因在两组间表达量的变化趋势。排序之后的基因列表其顶部可以看做是上调的差异基因，其底部是下调的差异基因。GSEA分析的是一个基因集下的所有基因是否在这个排序列表的顶部或者底部富集，如果在顶部富集，我们可以说，从总体上看，该基因集是上调趋势，反之，如果在底部富集，则是下调趋势。</p>
<h1 id="ssGSEA-single-sample-Gene-Set-Enrichment-Analysis）"><a href="#ssGSEA-single-sample-Gene-Set-Enrichment-Analysis）" class="headerlink" title="ssGSEA(single sample Gene Set Enrichment Analysis）"></a><strong>ssGSEA(single sample Gene Set Enrichment Analysis）</strong></h1><ul>
<li><p>定义：</p>
</li>
<li><p>原理：</p>
</li>
<li><p>实现：</p>
</li>
<li><p>输入文件：</p>
</li>
<li></li>
</ul>
]]></content>
      <categories>
        <category>RNA-seq</category>
      </categories>
      <tags>
        <tag>RNA-seq</tag>
      </tags>
  </entry>
  <entry>
    <title>TOEFL-writing-04</title>
    <url>/2021/03/09/TOEFL-writing-04/</url>
    <content><![CDATA[<h1 id="对比总分结构"><a href="#对比总分结构" class="headerlink" title="对比总分结构"></a>对比总分结构</h1><p>总论点——阅读ts+听力ts——听力细节</p>
<p>[Total 260字+]开头段（3句）——第一个理由段（2句）——第二个理由段（2句）——第三个理由段（3句）——结尾段（1句）</p>
<h1 id="开头段"><a href="#开头段" class="headerlink" title="开头段"></a>开头段</h1><p><strong>主题(主语从句)</strong> is the focus of both the writer and the professor. In the writing, three <strong>三个TS的所属类别</strong>，including A, B and C, have been elaborated. The professor, however, claims that <strong>听力主旨</strong>.</p>
<h1 id="第一个理由段"><a href="#第一个理由段" class="headerlink" title="第一个理由段"></a>第一个理由段</h1><p>As opposed to the writer’s idea that <strong>阅读的TS1</strong>, the professor states that <strong>听力的TS1</strong>. He/She advances the theory by saying that <strong>听力的细节</strong>.</p>
<h1 id="第二个理由段"><a href="#第二个理由段" class="headerlink" title="第二个理由段"></a>第二个理由段</h1><p>The professor continues to discredit the writing’s assertion that <strong>阅读的TS2</strong>, by examining the fact that <strong>听力的TS2</strong>. In detail, he/she points out that <strong>听力的细节</strong>.</p>
<h1 id="结尾段"><a href="#结尾段" class="headerlink" title="结尾段"></a>结尾段</h1><p>An apparent divide exists between the writer and the professor on <strong>主题（名词）</strong>.</p>
<h1 id="行文原则"><a href="#行文原则" class="headerlink" title="行文原则"></a>行文原则</h1><h2 id="对比意识"><a href="#对比意识" class="headerlink" title="对比意识"></a>对比意识</h2><p><strong>仅写阅读和听力的对比</strong>内容</p>
<ul>
<li>阅读的某个细节是否需要写，取决于听力是否有针对这个点反驳</li>
<li>听力的某个细节是否需要写,取决于是否反驳阅读(应该是听力时已经筛选好了)</li>
</ul>
<h2 id="读者意识"><a href="#读者意识" class="headerlink" title="读者意识"></a>读者意识</h2><p>让一个没有读过阅读没有听过听力的人,看文章就能看懂</p>
<ul>
<li>对于文章的主题词进行解释</li>
<li>尽可能描述直接、清楚，哪怕字数多些</li>
</ul>
]]></content>
      <categories>
        <category>TOEFL-Writing</category>
      </categories>
      <tags>
        <tag>TOEFL</tag>
      </tags>
  </entry>
  <entry>
    <title>CUT&amp;Tag Analysis</title>
    <url>/2021/03/25/CUT-Tag-Analysis/</url>
    <content><![CDATA[<ul>
<li>有一个隐藏的节点可以用，ssh 192.168.1.23 (有24个线程)</li>
<li>jobs命令，查看后台有没有任务在运行</li>
<li>IGV可以save session回到之前的界面</li>
</ul>
<h1 id="分析流程"><a href="#分析流程" class="headerlink" title="分析流程"></a>分析流程</h1><p>参考： <a href="https://yezhengstat.github.io/CUTTag_tutorial">https://yezhengstat.github.io/CUTTag_tutorial</a><br>数据来源： <a href="https://www.nature.com/articles/s41467-019-09982-5">https://www.nature.com/articles/s41467-019-09982-5</a> </p>
<h2 id="主要步骤："><a href="#主要步骤：" class="headerlink" title="主要步骤："></a>主要步骤：</h2><ol>
<li>质量监控（fastqc，multiqc）（略）</li>
<li>读段比对（bowtie2）（略）及利用spike-in计算scale factor</li>
<li>sam过滤及格式转换（samtools、bedtools）及归一化</li>
<li>Peak calling（SEACR、MACS2）</li>
<li>motif识别（MEME）</li>
<li>IGV可视化</li>
<li>deeptools可视化及homer注释（可选）</li>
</ol>
<ul>
<li>BlackList</li>
</ul>
<p>被设为黑名单后，不能当做是peak<br>call peak之后，用Black List过滤一下</p>
<h3 id="Bam文件"><a href="#Bam文件" class="headerlink" title="Bam文件"></a>Bam文件</h3><p><a href="http://genome.ucsc.edu/FAQ/FAQformat.html#format1">http://genome.ucsc.edu/FAQ/FAQformat.html#format1</a></p>
<p>相当于压缩文件，要用samtools view看</p>
<h3 id="Bed文件格式"><a href="#Bed文件格式" class="headerlink" title="Bed文件格式"></a>Bed文件格式</h3><p>UCSC format</p>
<p>可以直接导入IGV</p>
<p>用于表示染色体区域</p>
<ol>
<li><p><strong>chrom</strong> - 染色体号; 例如，chr1，chrX……</p>
</li>
<li><p><strong>chromStart</strong> - feature在染色体上起始位置. 从0开始算，染色体上第一个碱基位置标记为0。</p>
</li>
<li><p><strong>chromEnd</strong> - feature在染色体上终止位置。染色体上前100个碱基片段的位置位置标记为：chromStart=0, chromEnd=100。 实际上，第100个碱基不属于当前片段中，当前片段的碱基应该是0-99。所以在BED文件中，起始位置从0开始，终止位置从1开始。</p>
</li>
<li><p><strong>name</strong> - BED行名，在基因组浏览器左边显示；</p>
</li>
<li><p><strong>score</strong> - 在基因组浏览器中显示的灰度设定，值介于0-1000；</p>
</li>
<li><p><strong>strand</strong> - 正负链标记. Either “.” (=no strand) or “+” or “-“.</p>
</li>
</ol>
<p>bedtools工具bamtobed: 将bam转bed</p>
<h3 id="Bedpe文件"><a href="#Bedpe文件" class="headerlink" title="Bedpe文件"></a>Bedpe文件</h3><p>用于表示双末端bed文件，一行里面有两个坐标，前三列一个坐标，三到六另一个</p>
<h1 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># ssh 192.168.1.23</span></span><br><span class="line">rootpath=/public/workspace/stu18230130/MyCourse/NGS-02/lab1-CUTTag/</span><br><span class="line"><span class="comment"># ---------------------------&gt;</span></span><br><span class="line"><span class="comment"># download and extract data</span></span><br><span class="line"><span class="comment"># ---------------------------&gt;</span></span><br><span class="line">mkdir -p <span class="variable">$rootpath</span>/data</span><br><span class="line"><span class="built_in">cd</span> <span class="variable">$rootpath</span>/data</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> SRR8435039 SRR8435040 SRR8435051 SRR8435052</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  wget https://sra-pub-run-odp.s3.amazonaws.com/sra/<span class="variable">$i</span>/<span class="variable">$i</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> SRR8435039 SRR8435040 SRR8435051 SRR8435052</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  fastq-dump -split-files <span class="variable">$i</span> &amp;</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">wait</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># wait 等待前面后台命令全部完成，在往下</span></span><br><span class="line"><span class="comment"># 先fastq-dump再gzip会比较快</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> SRR8435039 SRR8435040 SRR8435051 SRR8435052</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  gzip <span class="variable">$&#123;i&#125;</span>_1.fastq &amp;</span><br><span class="line">  gzip <span class="variable">$&#123;i&#125;</span>_2.fastq &amp;</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">wait</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># cd $rootpath</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ---------------------------&gt;</span></span><br><span class="line"><span class="comment"># QC and pre-processing</span></span><br><span class="line"><span class="comment"># ---------------------------&gt;</span></span><br><span class="line">mkdir -p <span class="variable">$rootpath</span>/1.QC</span><br><span class="line"><span class="comment"># cd $rootpath/1.QC </span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> SRR8435039 SRR8435040 SRR8435051 SRR8435052</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  fastqc -o <span class="variable">$rootpath</span>/1.QC/ <span class="variable">$rootpath</span>/data/<span class="variable">$&#123;i&#125;</span>_1.fastq.gz &amp;</span><br><span class="line">  fastqc -o <span class="variable">$rootpath</span>/1.QC/ <span class="variable">$rootpath</span>/data/<span class="variable">$&#123;i&#125;</span>_2.fastq.gz &amp;</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">wait</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ---------------------------&gt;</span></span><br><span class="line"><span class="comment"># mapping with bowtie2</span></span><br><span class="line"><span class="comment"># ---------------------------&gt;</span></span><br><span class="line"><span class="comment"># core 线程数</span></span><br><span class="line"><span class="comment"># 文件重命名策略：输出文件名称，SRR8435039:CTCF1，旧名字：新名字</span></span><br><span class="line">mkdir -p <span class="variable">$rootpath</span>/2.map/bowtie2_result</span><br><span class="line">mkdir -p <span class="variable">$rootpath</span>/2.map/bowtie2_summary</span><br><span class="line">bt2ref=/public/workspace/shaojf/Course/NGS/Reference/bowtie2_Index/GRCh38.bowtie2</span><br><span class="line">cores=4</span><br><span class="line"><span class="keyword">for</span> info <span class="keyword">in</span> SRR8435039:CTCF1 SRR8435040:CTCF2 SRR8435051:IgG1 SRR8435052:IgG2</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  i=`<span class="built_in">echo</span> <span class="variable">$info</span> | cut -d <span class="string">&quot;:&quot;</span> -f 1`</span><br><span class="line">  name=`<span class="built_in">echo</span> <span class="variable">$info</span> | cut -d <span class="string">&quot;:&quot;</span> -f 2`</span><br><span class="line">  bowtie2 --end-to-end --very-sensitive --no-mixed --no-discordant --phred33 \</span><br><span class="line">    -I 10 -X 700 -p <span class="variable">$cores</span> -x <span class="variable">$bt2ref</span> \</span><br><span class="line">    -1 <span class="variable">$rootpath</span>/data/<span class="variable">$&#123;i&#125;</span>_1.fastq.gz -2 <span class="variable">$rootpath</span>/data/<span class="variable">$&#123;i&#125;</span>_2.fastq.gz \</span><br><span class="line">    -S <span class="variable">$rootpath</span>/2.map/bowtie2_result/<span class="variable">$&#123;name&#125;</span>_bowtie2.sam \</span><br><span class="line">    &amp;&gt; <span class="variable">$rootpath</span>/2.map/bowtie2_summary/<span class="variable">$&#123;name&#125;</span>_bowtie2.txt &amp;</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">wait</span></span><br><span class="line"><span class="comment"># The paired-end reads are aligned by Bowtie2 using parameters --end-to-end --very-sensitive --no-mixed --no-discordant --phred33 -I 10 -X 700 for mapping of inserts 10-700 bp in length.</span></span><br><span class="line"><span class="comment"># Critical step: There is no need to trim reads from out standard 25x25 PE sequencing, as adapter sequences will not be included in reads of inserts &gt;25 bp. However, for users performing longer sequencing, reads will need to be trimmed by Cutadapt and mapped by --local --very-sensitive --no-mixed --no-discordant --phred33 -I 10 -X 700 to ignore any remaining adapter sequence at the 3’ ends of reads during mapping.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># U00096.3</span></span><br><span class="line"><span class="comment"># 可以去ncbi下载E.coli的ref</span></span><br><span class="line">spikeinref=/public/workspace/shaojf/Course/NGS/Reference/bowtie2_Index/Ecoli</span><br><span class="line"><span class="keyword">for</span> info <span class="keyword">in</span> SRR8435039:CTCF1 SRR8435040:CTCF2 SRR8435051:IgG1 SRR8435052:IgG2</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  i=`<span class="built_in">echo</span> <span class="variable">$info</span> | cut -d <span class="string">&quot;:&quot;</span> -f 1`</span><br><span class="line">  name=`<span class="built_in">echo</span> <span class="variable">$info</span> | cut -d <span class="string">&quot;:&quot;</span> -f 2`</span><br><span class="line">  bowtie2 --end-to-end --very-sensitive --no-mixed --no-discordant --phred33 \</span><br><span class="line">    -I 10 -X 700 -p <span class="variable">$cores</span> -x <span class="variable">$spikeinref</span> \</span><br><span class="line">    -1 <span class="variable">$rootpath</span>/data/<span class="variable">$&#123;i&#125;</span>_1.fastq.gz -2 <span class="variable">$rootpath</span>/data/<span class="variable">$&#123;i&#125;</span>_2.fastq.gz \</span><br><span class="line">    -S <span class="variable">$rootpath</span>/2.map/bowtie2_result/<span class="variable">$&#123;name&#125;</span>_bowtie2_spikeIn.sam \</span><br><span class="line">    &amp;&gt; <span class="variable">$rootpath</span>/2.map/bowtie2_summary/<span class="variable">$&#123;name&#125;</span>_bowtie2_spikeIn.txt &amp;</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">wait</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># grep &quot;rate&quot; 2.map/bowtie2_summary/*.txt</span></span><br><span class="line"><span class="comment"># 计算有多少对读段比对到E.coli上,再写到一个文件里，方便后面计算scale factor</span></span><br><span class="line"><span class="keyword">for</span> name <span class="keyword">in</span> CTCF1 CTCF2 IgG1 IgG2</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  seqDepthDouble=`samtools view -F 0x04 <span class="variable">$rootpath</span>/2.map/bowtie2_result/<span class="variable">$&#123;name&#125;</span>_bowtie2_spikeIn.sam | wc -l`</span><br><span class="line">  seqDepth=$((seqDepthDouble/<span class="number">2</span>))</span><br><span class="line">  <span class="built_in">echo</span> <span class="variable">$seqDepth</span> &gt; <span class="variable">$rootpath</span>/2.map/bowtie2_result/<span class="variable">$&#123;name&#125;</span>_bowtie2_spikeIn.seqDepth</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># In practice, we have found that the apparent duplication rate is low for high quality CUT&amp;Tag datasets, and even the apparent ‘duplicate’ fragments are likely to be true fragments. Thus, we do not recommend removing the duplicates.</span></span><br><span class="line"><span class="comment"># mkdir -p mkdir -p $rootpath/2.map/removeDuplicate/picard_summary</span></span><br><span class="line"><span class="comment"># for name in CTCF1 CTCF2 IgG1 IgG2</span></span><br><span class="line"><span class="comment"># do</span></span><br><span class="line"><span class="comment"># 	picard SortSam I=$rootpath/2.map/bowtie2_result/$&#123;name&#125;_bowtie2.sam \</span></span><br><span class="line"><span class="comment"># 		O=$rootpath/2.map/removeDuplicate/$&#123;name&#125;_bowtie2.sorted.sam SORT_ORDER=coordinate</span></span><br><span class="line"><span class="comment"># 	picard MarkDuplicates I=$rootpath/2.map/removeDuplicate/$&#123;name&#125;_bowtie2.sorted.sam \</span></span><br><span class="line"><span class="comment"># 		O=$rootpath/2.map/removeDuplicate/$&#123;name&#125;_bowtie2.sorted.dupMarked.sam METRICS_FILE=$rootpath/2.map/removeDuplicate/picard_summary/$&#123;name&#125;_picard.dupMark.txt</span></span><br><span class="line"><span class="comment"># done</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># -F unmap </span></span><br><span class="line">mkdir -p <span class="variable">$rootpath</span>/2.map/fragmentLen</span><br><span class="line"><span class="keyword">for</span> name <span class="keyword">in</span> CTCF1 CTCF2 IgG1 IgG2</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  samtools view -F 0x04 <span class="variable">$rootpath</span>/2.map/bowtie2_result/<span class="variable">$&#123;name&#125;</span>_bowtie2.sam | \</span><br><span class="line">    awk -F<span class="string">&#x27;\t&#x27;</span> <span class="string">&#x27;function abs(x)&#123;return ((x &lt; 0.0) ? -x : x)&#125; &#123;print abs($9)&#125;&#x27;</span> | \</span><br><span class="line">    sort | uniq -c | awk -v OFS=<span class="string">&quot;\t&quot;</span> <span class="string">&#x27;&#123;print $2, $1/2&#125;&#x27;</span> \</span><br><span class="line">    &gt; <span class="variable">$rootpath</span>/2.map/fragmentLen/<span class="variable">$&#123;name&#125;</span>_fragmentLen.txt &amp;</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ---------------------------------------&gt;</span></span><br><span class="line"><span class="comment"># filtering and file format conversion</span></span><br><span class="line"><span class="comment"># ---------------------------------------&gt;</span></span><br><span class="line"><span class="comment"># sam转成bam，并且留下Q10以上的</span></span><br><span class="line"><span class="comment"># 转成bedgraph格式</span></span><br><span class="line"><span class="comment"># -F INT   only include reads with none of the FLAGS in INT present [0]</span></span><br><span class="line"></span><br><span class="line">mkdir -p <span class="variable">$rootpath</span>/3.filter/</span><br><span class="line"><span class="keyword">for</span> name <span class="keyword">in</span> CTCF1 CTCF2 IgG1 IgG2</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  samtools view -bS -F 0x04 -q 10 <span class="variable">$rootpath</span>/2.map/bowtie2_result/<span class="variable">$&#123;name&#125;</span>_bowtie2.sam \</span><br><span class="line">    &gt;<span class="variable">$rootpath</span>/3.filter/<span class="variable">$&#123;name&#125;</span>_bowtie2.q10.bam &amp;</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">wait</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 转成bedpe</span></span><br><span class="line"><span class="keyword">for</span> name <span class="keyword">in</span> CTCF1 CTCF2 IgG1 IgG2</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  bedtools bamtobed -i <span class="variable">$rootpath</span>/3.filter/<span class="variable">$&#123;name&#125;</span>_bowtie2.q10.bam \</span><br><span class="line">  -bedpe &gt; <span class="variable">$rootpath</span>/3.filter/<span class="variable">$&#123;name&#125;</span>_bowtie2.bed &amp;</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">wait</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 上一步已转换成bedpe格式，用于表示双末端bed文件，一行里面有两个坐标，前三列一个坐标（正向测），三到六另一个（反向测）</span></span><br><span class="line"><span class="comment"># awk 第一列等于第四列（在同一染色体上）且终止-起始&lt;1000</span></span><br><span class="line"><span class="keyword">for</span> name <span class="keyword">in</span> CTCF1 CTCF2 IgG1 IgG2</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  awk <span class="string">&#x27;$1==$4 &amp;&amp; $6-$2 &lt; 1000 &#123;print $0&#125;&#x27;</span> <span class="variable">$rootpath</span>/3.filter/<span class="variable">$&#123;name&#125;</span>_bowtie2.bed \</span><br><span class="line">    &gt; <span class="variable">$rootpath</span>/3.filter/<span class="variable">$&#123;name&#125;</span>_bowtie2.clean.bed &amp;</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">wait</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果第一列相同，则按第二列从小到大排序，如果第二列相同，按照第三列从小到大排</span></span><br><span class="line"><span class="comment"># -k，1 只看第一列</span></span><br><span class="line"><span class="keyword">for</span> name <span class="keyword">in</span> CTCF1 CTCF2 IgG1 IgG2</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  cut -f 1,2,6 <span class="variable">$rootpath</span>/3.filter/<span class="variable">$&#123;name&#125;</span>_bowtie2.clean.bed | \</span><br><span class="line">  sort -k1,1 -k2,2n -k3,3n &gt; <span class="variable">$rootpath</span>/3.filter/<span class="variable">$&#123;name&#125;</span>_bowtie2.fragments.bed &amp;</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">wait</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># scale factor</span></span><br><span class="line"><span class="comment"># if [ expression ]</span></span><br><span class="line"><span class="comment"># then</span></span><br><span class="line"><span class="comment">#    Statement(s) to be executed if expression is true</span></span><br><span class="line"><span class="comment"># fi</span></span><br><span class="line"><span class="comment"># Shell expression求值。如果结果值是true，给定statement被执行。如果 expression 为false ，则没有语句将不会被执行。</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># bc-l 相当于一个计算器，用长浮点型来表示</span></span><br><span class="line"><span class="comment"># echo 1+3 | bc 把计算的公式穿给bc去运算</span></span><br><span class="line">chromSize=/public/workspace/shaojf/Course/NGS/Reference/bowtie2_Index/GRCh38.chrom.size</span><br><span class="line">长度</span><br><span class="line"><span class="keyword">for</span> name <span class="keyword">in</span> CTCF1 CTCF2 IgG1 IgG2</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  seqDepth=`cat <span class="variable">$rootpath</span>/2.map/bowtie2_result/<span class="variable">$&#123;name&#125;</span>_bowtie2_spikeIn.seqDepth`</span><br><span class="line">  <span class="keyword">if</span> [[ <span class="string">&quot;<span class="variable">$seqDepth</span>&quot;</span> -gt <span class="string">&quot;1&quot;</span> ]]</span><br><span class="line">  <span class="keyword">then</span></span><br><span class="line">      mkdir -p <span class="variable">$rootpath</span>/3.filter/bedgraph</span><br><span class="line">      scale_factor=`<span class="built_in">echo</span> <span class="string">&quot;10000 / <span class="variable">$seqDepth</span>&quot;</span> | bc -l`</span><br><span class="line">      <span class="built_in">echo</span> <span class="string">&quot;Scaling factor for <span class="variable">$name</span> is: <span class="variable">$scale_factor</span>&quot;</span></span><br><span class="line">      bedtools genomecov -<span class="built_in">bg</span> -scale <span class="variable">$scale_factor</span> \</span><br><span class="line">      	-i <span class="variable">$rootpath</span>/3.filter/<span class="variable">$&#123;name&#125;</span>_bowtie2.fragments.bed \</span><br><span class="line">      	-g <span class="variable">$chromSize</span> &gt; <span class="variable">$rootpath</span>/3.filter/bedgraph/<span class="variable">$&#123;name&#125;</span>_bowtie2.fragments.normalized.bedgraph &amp;</span><br><span class="line">  <span class="keyword">fi</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">wait</span></span><br><span class="line">mkdir -p <span class="variable">$rootpath</span>/3.filter/bigwig</span><br><span class="line"><span class="keyword">for</span> name <span class="keyword">in</span> CTCF1 CTCF2 IgG1 IgG2</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  bedSort <span class="variable">$rootpath</span>/3.filter/bedgraph/<span class="variable">$&#123;name&#125;</span>_bowtie2.fragments.normalized.bedgraph <span class="variable">$rootpath</span>/3.filter/bedgraph/<span class="variable">$&#123;name&#125;</span>_bowtie2.fragments.normalized.srt.bedgraph &amp;</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">wait</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 转bigwig方便可视化</span></span><br><span class="line"><span class="comment"># 用IGV打开，调颜色，bed文件第四列在IGV中会标注</span></span><br><span class="line"><span class="keyword">for</span> name <span class="keyword">in</span> CTCF1 CTCF2 IgG1 IgG2</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  bedGraphToBigWig <span class="variable">$rootpath</span>/3.filter/bedgraph/<span class="variable">$&#123;name&#125;</span>_bowtie2.fragments.normalized.srt.bedgraph <span class="variable">$chromSize</span> <span class="variable">$rootpath</span>/3.filter/bigwig/<span class="variable">$&#123;name&#125;</span>_bowtie2.fragments.normalized.bw &amp;</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">wait</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># -------------&gt;</span></span><br><span class="line"><span class="comment"># peak calling</span></span><br><span class="line"><span class="comment"># -------------&gt;</span></span><br><span class="line"><span class="comment"># SEACR</span></span><br><span class="line"><span class="comment"># SEACR is intended to call peaks and enriched regions from sparse CUT&amp;RUN or chromatin profiling data in which background is dominated by &quot;zeroes&quot; (i.e. regions with no read coverage).</span></span><br><span class="line"><span class="comment"># bash SEACR_1.3.sh &lt;experimental bedgraph&gt;.bg [&lt;control bedgraph&gt;.bg | &lt;FDR threshold&gt;] [norm | non] [relaxed | stringent] output prefix</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 加不加0.01差很多，把top1%作为peak</span></span><br><span class="line">seacr=/public/workspace/shaojf/anaconda3/bin/SEACR_1.3.sh</span><br><span class="line">mkdir -p <span class="variable">$rootpath</span>/4.peakCalling/</span><br><span class="line"><span class="keyword">for</span> pair <span class="keyword">in</span> CTCF1:IgG1 CTCF2:IgG2 <span class="comment">#ip组：ctl组</span></span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  name=`<span class="built_in">echo</span> <span class="variable">$pair</span> | cut -d <span class="string">&quot;:&quot;</span> -f 1`</span><br><span class="line">  control=`<span class="built_in">echo</span> <span class="variable">$pair</span> | cut -d <span class="string">&quot;:&quot;</span> -f 2`</span><br><span class="line">  bash <span class="variable">$seacr</span> \</span><br><span class="line">    <span class="variable">$rootpath</span>/3.filter/bedgraph/<span class="variable">$&#123;name&#125;</span>_bowtie2.fragments.normalized.bedgraph \</span><br><span class="line">    <span class="variable">$rootpath</span>/3.filter/bedgraph/<span class="variable">$&#123;control&#125;</span>_bowtie2.fragments.normalized.bedgraph \</span><br><span class="line">    non stringent <span class="variable">$rootpath</span>/4.peakCalling/<span class="variable">$&#123;name&#125;</span>_seacr_control.peaks &amp;</span><br><span class="line">  bash <span class="variable">$seacr</span> \</span><br><span class="line">    <span class="variable">$rootpath</span>/3.filter/bedgraph/<span class="variable">$&#123;name&#125;</span>_bowtie2.fragments.normalized.bedgraph \</span><br><span class="line">    0.01 \</span><br><span class="line">    non stringent <span class="variable">$rootpath</span>/4.peakCalling/<span class="variable">$&#123;name&#125;</span>_seacr_top0.01.peaks &amp;</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="built_in">wait</span></span><br><span class="line"></span><br><span class="line"><span class="comment">### alternative method with MACS2</span></span><br><span class="line"><span class="comment"># 单末端测序：给所有的读段延长到200/300bp的fragment</span></span><br><span class="line"><span class="comment"># 双末端测序：直接基于bam文件，用真正的长度。需要-f BAMPE </span></span><br><span class="line">mkdir -p <span class="variable">$rootpath</span>/4.peakCalling/MACS2</span><br><span class="line"><span class="keyword">for</span> pair <span class="keyword">in</span> CTCF1:IgG1 CTCF2:IgG2</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  name=`<span class="built_in">echo</span> <span class="variable">$pair</span> | cut -d <span class="string">&quot;:&quot;</span> -f 1`</span><br><span class="line">  control=`<span class="built_in">echo</span> <span class="variable">$pair</span> | cut -d <span class="string">&quot;:&quot;</span> -f 2`</span><br><span class="line">  macs2 callpeak -t <span class="variable">$rootpath</span>/3.filter/<span class="variable">$&#123;name&#125;</span>_bowtie2.q10.bam \</span><br><span class="line">        -c <span class="variable">$rootpath</span>/3.filter/<span class="variable">$&#123;control&#125;</span>_bowtie2.q10.bam \</span><br><span class="line">        -g hs -f BAMPE -n macs2_peak_q0.1.<span class="variable">$name</span> \</span><br><span class="line">        --outdir <span class="variable">$rootpath</span>/4.peakCalling/MACS2 \</span><br><span class="line">        -q 0.1 --keep-dup all \</span><br><span class="line">        2&gt;<span class="variable">$rootpath</span>/4.peakCalling/MACS2/macs2Peak_summary.<span class="variable">$name</span>.txt &amp;</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"><span class="comment">###</span></span><br><span class="line"></span><br><span class="line">Rscript cuttag.visualization.R /public/workspace/stu18230130/MyCourse/NGS-02/lab1-CUTTag CTCF,IgG 1,2 CTCF</span><br><span class="line"></span><br><span class="line"><span class="comment">###</span></span><br><span class="line"><span class="comment"># https://github.com/Boyle-Lab/Blacklist/tree/master/lists</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># -------------&gt;</span></span><br><span class="line"><span class="comment"># motif</span></span><br><span class="line"><span class="comment"># -------------&gt;</span></span><br><span class="line"><span class="comment"># MEME输入需要fasta格式</span></span><br><span class="line"><span class="comment"># 其他功能：想知道基因组上那些位置有某个motif,去基因组上scan</span></span><br><span class="line">mkdir -p <span class="variable">$rootpath</span>/5.motif/</span><br><span class="line">motifdb=/public/workspace/shaojf/Course/NGS/Reference/MEME/JASPAR2018_CORE_vertebrates_non-redundant.meme</span><br><span class="line">reffasta=/public/workspace/shaojf/Course/NGS/Reference/bowtie2_Index/GRCh38.fa</span><br><span class="line">blacklist=/public/workspace/shaojf/Course/NGS/Reference/ENCODE/blacklist.v2/hg38-blacklist.v2.bed</span><br><span class="line"></span><br><span class="line"><span class="comment"># - 表示从标准输入中获取</span></span><br><span class="line"><span class="comment"># sed &#x27;s?chr??&#x27; 把chr去掉</span></span><br><span class="line">bedtools intersect -u \</span><br><span class="line">  -a <span class="variable">$rootpath</span>/4.peakCalling/CTCF2_seacr_top0.01.peaks.stringent.bed \</span><br><span class="line">  -b <span class="variable">$rootpath</span>/4.peakCalling/CTCF1_seacr_top0.01.peaks.stringent.bed | \</span><br><span class="line">  bedtools intersect -v -a - -b &lt;(sed <span class="string">&#x27;s?chr??&#x27;</span> <span class="variable">$blacklist</span>) &gt; <span class="variable">$rootpath</span>/4.peakCalling/CTCF.overlapped.bed</span><br><span class="line">  </span><br><span class="line"><span class="comment"># 给坐标提取fasta，把两个重复的peak去交集</span></span><br><span class="line">bedtools getfasta -<span class="keyword">fi</span> <span class="variable">$reffasta</span> -fo <span class="variable">$rootpath</span>/5.motif/CTCF.overlapped.fa -bed <span class="variable">$rootpath</span>/4.peakCalling/CTCF.overlapped.bed</span><br><span class="line"></span><br><span class="line"><span class="comment"># -oc 强行用某个文件夹 -o 需要新建的文件夹 </span></span><br><span class="line"><span class="comment"># -db denovo找出来的和数据库比对 $motifdb已知的数据库</span></span><br><span class="line">meme-chip -o <span class="variable">$rootpath</span>/5.motif/meme.CTCF.overlapped -db <span class="variable">$motifdb</span> <span class="variable">$rootpath</span>/5.motif/CTCF.overlapped.fa</span><br><span class="line"><span class="comment"># for name in CTCF1 CTCF2</span></span><br><span class="line"><span class="comment"># do</span></span><br><span class="line"><span class="comment"># 	bedtools getfasta -fi $reffasta \</span></span><br><span class="line"><span class="comment"># 		-fo $rootpath/5.motif/$&#123;name&#125;_seacr_top0.01.peaks.stringent.fa \</span></span><br><span class="line"><span class="comment"># 		-bed $rootpath/4.peakCalling/$&#123;name&#125;_seacr_top0.01.peaks.stringent.bed &amp;</span></span><br><span class="line"><span class="comment"># done </span></span><br><span class="line"><span class="comment"># wait</span></span><br><span class="line"><span class="comment"># for name in CTCF1 CTCF2</span></span><br><span class="line"><span class="comment"># do</span></span><br><span class="line"><span class="comment"># 	meme-chip -o $rootpath/5.motif/meme.$name -db $motifdb $rootpath/5.motif/$&#123;name&#125;_seacr_top0.01.peaks.stringent.fa &amp;</span></span><br><span class="line"><span class="comment"># done</span></span><br><span class="line"><span class="comment"># wait</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>CUT&amp;Tag</category>
      </categories>
      <tags>
        <tag>CUT&amp;Tag</tag>
      </tags>
  </entry>
  <entry>
    <title>Paper-writing Tips</title>
    <url>/2021/03/17/Paper-writing-Tips/</url>
    <content><![CDATA[<h1 id="Word-amp-Phrase"><a href="#Word-amp-Phrase" class="headerlink" title="Word &amp; Phrase"></a>Word &amp; Phrase</h1><ol>
<li><p>and<br> , and 顺承关系，存在因果逻辑 （eg. 我昨天晚上晚睡了, and 我今天早上迟到了）<br> and 前后并列</p>
</li>
<li><p>however<br> however是强转折，隐含着否定前述结果或结论的意思，要么是你的实验结果和别人不一样，要么是否认自己的前期猜想。<br> 一般程度转折应该用regardless，even, despite。而且母语者很少在句首用however。<br> however就是“但你是个好人”里的“但”，但凡对前文有一丝留恋的，都没法说出口在句子开头。</p>
</li>
<li><p>Above (“the above method,” “mentioned above,” etc.) – Often, you are referring to something<br>preceding, but not necessarily above; a loose reference, convenient for writers, but not for<br>readers. Be specific. You know exactly what and where, but your readers may have to search<br>(sometimes through much preceding material).</p>
</li>
<li><p>Affect, effect – Affect is a verb and means to influence. Effect, as a verb, means to bring about;<br>as a noun, effect means result.</p>
</li>
<li><p>All of, both of – Just “all” or “both” will serve in most instances.</p>
</li>
<li><p>Alternate, alternative – Be sure which you mean.</p>
</li>
<li><p>And (to begin a sentence) – Quite proper. You may have been told not to do this in grade<br>school. But teacher’s purpose was to keep you from using fragmentary sentences; either “and” or<br>“but” may be used to begin complete sentences. And both are useful transitional words between<br>related or contrasting statements.</p>
</li>
<li><p>Apparently (apparent) – means obviously, clearly, plainly evident, but also means seemingly or<br>ostensibly as well as observably. You know the meaning that you intend, but readers may not.<br>Ambiguity results. Use obvious(ly), clear(ly), seeming(ly), evident(ly), observable or observably,<br>to remove all doubt.</p>
</li>
<li><p>Appear, appears – Seem(s)? “He always appears on the scene, but never seems to know what<br>to do.” “Marley’s ghost appeared but seemed harmless.”</p>
</li>
<li><p>As – Dialectal when used in place of that or whether; do not use “as” to mean because or<br>inasmuch as.<br>At the present time, at this point in time – Say “at present” or “now” if necessary at all.</p>
</li>
<li><p>Below – See comment about “above”.</p>
</li>
<li><p>But (to begin a sentence) – Go right ahead (see “And” and “However”). </p>
</li>
<li><p>By means of – Most often, just “by” will serve and save words.</p>
</li>
<li><p>Case – Can be ambiguous, misleading, or ludicrous because of different connotations; e.g., “In<br>the case of Scotch whiskey,….” Case also is a frequent offender in padded, drawn-out sentences.<br>For “in this case,” try “in this instance.”</p>
</li>
<li><p>Commas and punctuation – Not precisely a word-usuage matter except in relation to how<br>words are put together. The trend was toward less punctuation (particularly fewer commas), but<br>that demands careful writing, without misplaced or dangling elements. Do not omit commas<br>before the conjunctions in compound sentences. Most journals, but not all, use final commas<br>before ‘and” or “or” in series; check the journal.</p>
</li>
<li><p>Compare with, compare to – Compare with means to examine differences and similarities;<br>compare to means to represent as similar. One may conclude that the music of Brahms compares<br>to that of Beethoven, but to do that, one must first compare the music of Brahms with that of<br>Beethoven. (See also: Ian A. Greaves. On making comparisons: Reminded again. Science<br>226(4672):242. 1984.)</p>
</li>
<li><p>Comprise – Before misuse, comprise meant to contain, include, or encompass (not to constitute<br>or compose) and still does, despite two now opposite meanings. Use and meanings now are so<br>confused and mixed that “comprise” is best avoided altogether!</p>
</li>
<li><p>Correlated with, correlated to – Although things may be related to one another, things are<br>correlated with one another.</p>
</li>
<li><p>Different from, different than – Different from! Also, one thing differs from another, although<br>you may differ with your colleagues.</p>
</li>
<li><p>Due to – Make sure that you don’t mean because of. Due is an adjective modifier and must be<br>directly related to a noun, not to a concept or series of ideas gleaned from the rest of a statement.<br>“Due to the fact that…” is an attempt to weasel out.</p>
</li>
<li><p>During the course of, in the course of – Just use “during” or “in.”<br>Either….or, neither…nor – Apply to no more than two items or categories. Similarly, former<br>and latter refer only to the first and second of only two items or categories.</p>
</li>
<li><p>Etc. – Use at least two items or illustrations before “and so forth” or “etc.”</p>
</li>
<li><p>Experience(d) – To experience something is sensory; inanimate, unsensing things (lakes, soils,<br>enzymes, streambeds, farm fields, etc.) do not experience anything.</p>
</li>
<li><p>Following – “After” is more precise if “after” is the meaning intended. “After [not following] the<br>procession, the leader announced that the ceremony was over.” </p>
</li>
<li><p>High(er), low(er) – Much too often used, frequently ambiguously or imprecisely, for other<br>words such as greater, lesser, larger, smaller, more, fewer; e.g., “Occurrences of higher<br>concentrations were lower at higher levels of effluent outflow.” One interpretation is that greater<br>concentrations were fewer or less frequent as effluent volume(s) increased, but others also are<br>possible.</p>
</li>
<li><p>However – Place it more often within a sentence or major element rather than at the beginning<br>or end. “But” serves better at the beginning.</p>
</li>
<li><p>Hyphening of compound or unit modifiers – Often needed to clarify what is modifying what;<br>e.g., a small-grain harvest (harvest of small grain) is different from a small grain harvest (small<br>harvest of all grain), a fast acting dean isn’t necessarily as effective as a fast-acting dean, a batch<br>of (say, 20) 10-liter containers is different from a batch of 10 [1-] liter containers, and a man<br>eating fish is very different from a man-eating fish! Grammatically, adjectives are noun<br>modifiers, and the problem is when adjectives and nouns are used to modify other adjectives and<br>nouns. Adverbs (usually with “ly” endings), however, are adjective modifiers.</p>
</li>
<li><p>In order to – For brevity, just use “to”, the full phrase may be used, however [in order] to<br>achieve useless padding.</p>
</li>
<li><p>Irregardless – No, regardless. But irrespective might do.</p>
</li>
<li><p>It should be mentioned, noted, pointed out, emphasized, etc. – Such preambles often add<br>nothing but words. Just go ahead and say what is to be said.</p>
</li>
<li><p>It was found, determined, decided, felt, etc. – Are you being evasive? Why not put it frankly<br>and directly? (And how about that subjective “felt”?)</p>
</li>
<li><p>Less(er), few(er) – “Less” refers to quantity; “fewer” to number.</p>
</li>
<li><p>Majority, vast majority – See if most will do as well or better. Look up “vast.”</p>
</li>
<li><p>Myself – Not a substitute for me. “This paper has been reviewed by Dr. Smith and myself” and<br>“The report enclosed was prepared by Dr. Jones and myself” are incorrect as is “Don’t hesitate to<br>call Dr. Doe or myself”; me would have been correct in all instances. (Use of I also would have<br>been wrong in those examples.) Some correct uses of myself: I found the error myself. I myself<br>saw it happen. I am not myself today. I cannot convince myself. I locked myself out of the car.</p>
</li>
<li><p>Partially, partly – Compare the meanings (see also impartially). Partly is the better, simpler,<br>and more precise word when partly is meant.</p>
</li>
<li><p>Percent, percentage – Not the same; use percent only with a number. </p>
</li>
<li><p>Predominate, predominant – Predominate is a verb. Predominant is the adjective; as an adverb, predominantly (not “predominately”).</p>
</li>
<li><p>Prefixes – (mid, non, pre, pro, re, semi, un, etc.) – Usually not hyphened in U.S. usage except<br>before a proper name (pro-Iowa) or numerals (mid-60s) or when lack of a hyphen makes a word<br>ambiguous or awkward. Recover a fumble, but perhaps re-cover a sofa. Preengineered is better<br>hyphened as pre-engineered, one of the few exceptions so hyphened. Breaking pairs such as<br>predoctoral and postdoctoral into pre- and post-doctoral “forces” hyphening of both otherwise<br>unhyphened words.</p>
</li>
<li><p>Principle, principal – They’re different; make sure which you mean.<br>Prior to, previous to – Use before, preceding, or ahead of. There are prior and subsequent<br>events that occur before or after something else, but prior to is the same kind of atrocious use<br>that attempts to substitute “subsequent to” for “after.”</p>
</li>
<li><p>Proven – Although a proven adjective, stick to proved for the past participle.<br>Provided, providing – Provided (usually followed by “that”) is the conjunction; providing is the<br>participle.</p>
</li>
<li><p>Reason why – Omit why if reason is used as a noun. The reason is…; or, the reason is that… (i.e.,<br>the reason is the why).</p>
</li>
<li><p>Similar…as – No! If things are similar, they are similar to one another</p>
</li>
<li><p>Since – has a time connotation; use “because” or “inasmuch as” when either is the intended<br>meaning.</p>
</li>
<li><p>That and which – Two words that can help, when needed, to make intended meanings and<br>relationships unmistakable, which is important in reporting scientific information. If the clause<br>can be omitted without leaving the modified noun incomplete, use which and enclose the clause<br>within commas or parentheses; otherwise, use that.</p>
</li>
<li><p>To be – Frequently unnecessary. “The differences were [found] [to be] significant.”<br>Varying – Be careful to distinguish from various or differing. In saying that you used varying<br>amounts or varying conditions, you are implying individually changing amounts or conditions<br>rather than a selection of various or different ones. </p>
</li>
<li><p>Under way – two words except as adjective (e.g., “Further work on development is under way,<br>but the problem of underway repair has not be solved.”).</p>
</li>
<li><p>Where – Use when you mean where, but not for “in which,” “for which,” etc.<br>Which is, that were, who are, etc. – Often not needed. For example, “the data that were related<br>to age were analyzed first” means that the data related to age were analyzed first. Similarly, for<br>“the site, which is located near Ames,” try “the site, located near Ames” or “the site, near Ames.”<br>Rather than “all persons who were present voted,” just say that “all persons present voted.”<br>Rephrasing sometimes can help. Instead of “a survey, which was conducted in 1974” or “a<br>survey conducted in 1974,” try “a 1974 survey.”</p>
</li>
<li><p>While – Preferably not if, while writing, you mean and, but, although, or whereas.<br>Remember that a research report should communicate and record information as accurately and<br>concisely as possible. The purpose is to report, not to impress with elegance. Excess wordage,<br>tortuous construction, unnecessary detail, duplication, repetition, third-person passive pseudoobjectivism, etc., obstruct rather than facilitate communication. It’s the message that is important,<br>not sheer numbers of words. Use precise words and expressions of unmistakable meaning; avoid<br>the clouded, ambiguous, vague, and needlessly complex.<br>BEWARE OF MISPLACED or DANGLING MODIFIERS and PRONOUNANTECEDENT PROBLEMS! The difficulty here is that you, as the author, know exactly to<br>which each has reference even through not explicitly stated. Your reader, however, doesn’t have<br>this advantage, and the result may be confusing, misleading, or funny.</p>
</li>
</ol>
<p><strong>EXAMPLES:</strong><br>“Using multiple-regression techniques, the animals in Experiment I were…..”<br>“Based only on this doubtful inference, we find the conclusions not supported.”<br>“The determinations were made on samples using gas chromatography.”<br>“In assessing the damage, the plants exhibited numerous lesions.”<br>“The spiders were inadvertently discovered while repairing a faulty growth chamber.”<br>“Settling in the collected effluent, we observed what was determined to be….”<br>“The flavor was evaluated by an experienced taste panel, and it was deemed obnoxious.”<br>“All samples in Lot II were discarded when the authors found that they were contaminated with<br>alcohol, rendering them unstable.” [and unable to think clearly?]<br>“The guidelines were submitted to the deans, but they subsequently were ignored.”<br>“The contents were placed in 50-ml flasks, which after evaporating….” [let the contents run all<br>over?]</p>
<hr>
<h1 id="Painting"><a href="#Painting" class="headerlink" title="Painting"></a>Painting</h1><p><a href="https://smart.servier.com/smart_image/">https://smart.servier.com/smart_image/</a></p>
]]></content>
      <categories>
        <category>Records</category>
      </categories>
      <tags>
        <tag>Tips</tag>
      </tags>
  </entry>
  <entry>
    <title>WES Project</title>
    <url>/2021/03/30/WES-Project/</url>
    <content><![CDATA[<style>
  p{
    font-size:18px;
    line-height:1.7em;
  }
</style>

<h1 id="一、环境配置"><a href="#一、环境配置" class="headerlink" title="一、环境配置"></a>一、环境配置</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">/public/workspace/lincs/wes_cancer/data</span><br></pre></td></tr></table></figure>
<h1 id="二、数据下载"><a href="#二、数据下载" class="headerlink" title="二、数据下载"></a>二、数据下载</h1><h2 id="2-1-NCBI-prefetch"><a href="#2-1-NCBI-prefetch" class="headerlink" title="2.1 NCBI+prefetch"></a>2.1 NCBI+prefetch</h2><p>在NCBI页面查找数据后点击Run Selector，选择需要的数据，下载Metadata和Accession List两个文件</p>
 <center><img src="/imp/Figures/SRA-run.png" alt="SRA-run" style="zoom:45%;" /></center>

<p>依次读取SRR_Acc_List.txt的每一行，利用prefetch下载。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">cat 0.sra/sra.infor/SRR_Acc_List.txt | <span class="keyword">while</span> <span class="built_in">read</span> id</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  prefetch <span class="variable">$&#123;id&#125;</span> -O  ./0.sra</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>

<h2 id="2-2-ENA-Aspera"><a href="#2-2-ENA-Aspera" class="headerlink" title="2.2 ENA+Aspera"></a>2.2 ENA+Aspera</h2><p><a href="https://www.ebi.ac.uk/ena">ENA数据库: European Nucleotide</a><br>隶属于EBI，功能上应该是与SRA类似的，但是其搜索界面更加亲民，并且对于下载fastq文件以及检查下载数据完整性更加友好。  </p>
<p><strong>1.</strong> 首先，在数据库页面右上角搜索栏输入目标SRA检索号，确认后稍等片刻可得结果页面；   </p>
<p><img src="/img/Figures/ena.png" alt="ena"></p>
<p><strong>2.</strong> 其次，点击选取 Read File 即可查看该实验下所有的测序序列数据的信息，选择需要查看的信息，这里的五列分别为：run_accession，library_name，fastq_ftp，sra_md5，sra_aspera；  </p>
<img src="/img/Figures/ena_page2.png" style="zoom:80%;" />

<p><strong>3.</strong> 点击TSV，下载对应文件；  </p>
<p><img src="/img/Figures/download.png" alt="download"><br><strong>4.</strong> 利用shell处理，保留所需信息。观察文件发现，case1包含case1…和case1…ampliseq… ，只保留case1…；  </p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 提取包含case1且不包含ampliseq的行</span></span><br><span class="line">grep case1 filereport_read_run_PRJNA310728_tsv.txt | grep -v ampliseq &gt; matched_file.txt</span><br><span class="line"></span><br><span class="line"><span class="comment"># 提取SRR号，样本名，sra.ftp地址</span></span><br><span class="line">awk <span class="string">&#x27;&#123;print $2,$1,$6&#125;&#x27;</span> matched_file.txt | sed <span class="string">&#x27;s/_WES//&#x27;</span> &gt; config.sra</span><br></pre></td></tr></table></figure>
<p><img src="/img/Figures/awk-result.png" alt="awk-result"><br><strong>5.</strong> 利用Aspera批量下载,6.8G的文件下载了1个小时，速度大约为16M/s;</p>
<blockquote>
<p>Aspera:<br>-v verbose mode 唠叨模式，能让你实时知道程序在干啥<br>-T 取消加密，否则有时候数据下载不了<br>-i 提供私钥文件的地址，我也不知道干嘛的，反正不能少，地址一般是~/.aspera/connect/etc/asperaweb_id_dsa.openssh<br>-l 设置最大传输速度，一般200m到500m，如果不设置，反而速度会比较低，可能有个较低的默认值<br>-k 断点续传，一般设置为值1<br>-Q 不懂，一般加上它<br>-P 提供SSH port，一般是33001</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">cat 0.sra/sra.infor/config.sra | <span class="keyword">while</span> <span class="built_in">read</span> id; \</span><br><span class="line"><span class="keyword">do</span> <span class="built_in">echo</span> <span class="variable">$id</span></span><br><span class="line">arr=(<span class="variable">$id</span>)</span><br><span class="line">link=<span class="variable">$&#123;arr[2]&#125;</span></span><br><span class="line">srr=<span class="variable">$&#123;arr[1]&#125;</span></span><br><span class="line">ascp -i ~/.aspera/connect/etc/asperaweb_id_dsa.openssh \</span><br><span class="line">    -l 300M -k 1 -Q -T -P 33001 \</span><br><span class="line">    era-fasp@<span class="variable">$&#123;link&#125;</span> \</span><br><span class="line">    ./0.sra/ &gt; <span class="built_in">log</span>/ascp.log/<span class="variable">$&#123;srr&#125;</span>.<span class="built_in">log</span> 2&gt;&amp;1 &amp; </span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<center><img src="/img/Figures/ascp_loop.png" alt="acsp_loop" style="zoom:80%;" /></center>


<center><img src="/img/Figures/ascp_speed.png" alt="ascp-speed" style="zoom:80%;" /></center>

<p><strong>6.</strong> 最后利用MD5码确认数据的完整性。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 提取样本列和MD5列</span></span><br><span class="line">awk <span class="string">&#x27;&#123;print $2,$4&#125;&#x27;</span> matched_file.txt | sed <span class="string">&#x27;s/_WES//&#x27;</span> &gt; sra.md5</span><br><span class="line"></span><br><span class="line"><span class="comment"># 利用md5sum命令生成下载数据的md5码</span></span><br><span class="line"><span class="comment"># md5sum</span></span><br><span class="line"><span class="comment"># -b：二进制模式读取文件；</span></span><br><span class="line"><span class="comment"># -t或--text：把输入的文件作为文本文件看待；</span></span><br><span class="line"><span class="comment"># -c：从指定文件中读取MD5校验和，并进行校验；</span></span><br><span class="line"><span class="comment"># --status：验证成功时不输出任何信息；</span></span><br><span class="line"><span class="comment"># -w：当校验不正确时给出警告信息。</span></span><br><span class="line"></span><br><span class="line">md5sum ./0.sra/*.sra &gt; ./0.sra/sra.infor/aft.md5</span><br><span class="line"></span><br><span class="line"><span class="comment"># 对比ENA提供的md5码和下载后的数据生成的md5码</span></span><br><span class="line">diff ./0.sra/sra.infor/aft.md5 ./0.sra/sra.infor/sra.md5</span><br><span class="line"></span><br><span class="line"><span class="comment"># ENA提供的md5文件和当前sra在同一目录时</span></span><br><span class="line"><span class="comment"># md5sum -c ENA提供的md5文件</span></span><br><span class="line"><span class="comment"># 返回0/1</span></span><br></pre></td></tr></table></figure>
<center><img src="/img/Figures/MD5Check.png" alt="MD5" style="zoom:80%;" /></center>

<p>MD5码确认一致，下载的数据是完整无误的。</p>
<h2 id="2-3-ENA-Arial2-奶牛快传"><a href="#2-3-ENA-Arial2-奶牛快传" class="headerlink" title="2.3 ENA+Arial2+奶牛快传"></a>2.3 ENA+Arial2+奶牛快传</h2><p><strong>Aria2</strong><br><strong>优点</strong>:速度快、体积小、资源占用少；支持 HTTP/FTP/BT/Magnet磁力链接等类型的文件下载，据说速度超级快;<br><br><strong>缺点</strong>: 配置麻烦，上手较难。</p>
<p>教程：<br><a href="https://github.com/aria2/aria2/releases/tag/release-1.35.0">github-aria2</a><br><a href="https://cloud.tencent.com/developer/article/1142142">编译安装</a><br><a href="https://blog.readgroup.cn/m/?post=92">一键安装脚本（需要root权限）</a></p>
<center><img src="/img/Figures/Aria2-wrong.png" alt="Aria-wrong" style="zoom:80%;" /></center>

<p>另外尝试下载win版Arial2，再利用奶牛快传传至服务器<br>教程：</p>
<p>抛弃迅雷，Aria2 新手入门](<a href="https://zhuanlan.zhihu.com/p/37021947">https://zhuanlan.zhihu.com/p/37021947</a>)<br>用ftp地址，3G的数据下的超快。大概10分钟？感觉这边的速度是骗人的</p>
<center><img src="Figures/Aria2-speed.png" alt="Aria-speed" style="zoom:60%;" /></center>

<p><a href="https://cowtransfer.com/"><strong>奶牛快传</strong></a></p>
<ul>
<li>单次传输上限20GB  </li>
<li>3TB云盘空间  </li>
<li>上传下载不限速  </li>
<li>在网页上上传本地文件后，会提供下载链接和密码</li>
</ul>
<center><img src="/img/Figures/upload.png" alt="cow" style="zoom:45%;" /></center>

<p>需要下载linux版<br><a href="https://github.com/Mikubill/cowtransfer-uploader">github-cowtransfer uploader</a><br><a href="https://www.jianshu.com/p/5c29e8fcb0f0">Linux奶牛快传使用手册</a></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 从云端下载数据</span></span><br><span class="line"><span class="comment"># 输入提供的链接和密码</span></span><br><span class="line">cowtransfer-uploader --password=test1234 https://yilingzhang.cowtransfer.com/s/90c7eb9b3d1a44</span><br></pre></td></tr></table></figure>
<p>传到服务器8M/s的速度太感人了！！还可以加线程！</p>
<center><img src="/img/Figures/toserver.png" alt="cow-to-server" style="zoom:100%;" /></center>

<h1 id="三、质控与去接头"><a href="#三、质控与去接头" class="headerlink" title="三、质控与去接头"></a>三、质控与去接头</h1><h2 id="3-1-文件格式转换"><a href="#3-1-文件格式转换" class="headerlink" title="3.1 文件格式转换"></a>3.1 文件格式转换</h2><h3 id="3-1-1-fastq-dump"><a href="#3-1-1-fastq-dump" class="headerlink" title="3.1.1 fastq-dump"></a>3.1.1 fastq-dump</h3><p>官方文档：<br><a href="https://ncbi.github.io/sra-tools/fastq-dump.html">github: fastq-dump</a></p>
<p>教程：<br><a href="https://www.jianshu.com/p/a8d70b66794c">Fastq-dump: 一个神奇的软件</a></p>
<blockquote>
<p>常用参数:<br>split-spot: 将双端测序分为两份,但是都放在同一个文件中<br>split-files: 将双端测序分为两份,放在不同的文件,但是对于一方有而一方没有的reads直接丢弃<br>split-3 : 将双端测序分为两份,放在不同的文件,但是对于一方有而一方没有的reads会单独放在一个文件夹里<br>–gzip 输出文件以gz压缩<br>-A 输出文件名<br>-O 输出目录</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -------------------------------&gt;</span></span><br><span class="line"><span class="comment"># fastq-dump--sratoolkit-2.9.2</span></span><br><span class="line"><span class="comment"># -------------------------------&gt;</span></span><br><span class="line">cat 0.sra/sra.infor/sample | <span class="keyword">while</span> <span class="built_in">read</span> id</span><br><span class="line"><span class="keyword">do</span> </span><br><span class="line">time fastq-dump -A <span class="variable">$&#123;id&#125;</span> -O 1.rawfastq/ \</span><br><span class="line">--gzip --split-3 0.sra/<span class="variable">$&#123;id&#125;</span>.sra &gt; <span class="built_in">log</span>/sra2fq.log/<span class="variable">$&#123;id&#125;</span>.<span class="built_in">log</span> 2&gt;&amp;1 &amp;</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<h3 id="3-1-2-faterq-dump"><a href="#3-1-2-faterq-dump" class="headerlink" title="3.1.2 faterq-dump"></a>3.1.2 faterq-dump</h3><p>fastq-dump只能单个线程，速度特别的慢。2018年的6月份，sra-tools更新了一个新的sra解压工具，fasterq-dump,能利用临时文件和多线程加速从SRA文件提取FASTQ。</p>
<p><strong>注意：</strong><code>fasterq-dump</code>不提供–gzip的参数用于压缩文件，提取出来的fastq文件只是文本文件，记得压缩，减小存储压力。（原文：There is no –gzip|–bizp2 option, you have to compress your files explicitly after they have been written.）</p>
<p>官方文档：<br><a href="https://github.com/ncbi/sra-tools/wiki/HowTo:-fasterq-dump">github: fasterq-dump</a></p>
<p>教程：<br><a href="https://www.plob.org/article/14565.html">fasterq-dump使用介绍</a></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -------------------------------&gt;</span></span><br><span class="line"><span class="comment"># fasterq-dump-sratoolkit-2.9.2</span></span><br><span class="line"><span class="comment"># -------------------------------&gt;</span></span><br><span class="line">cat 0.sra/sra.infor/sample | <span class="keyword">while</span> <span class="built_in">read</span> id</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  time fasterq-dump -3 -e 5 ./0.sra/<span class="variable">$&#123;id&#125;</span>.sra -O ./1.rawfastq --outfile <span class="variable">$&#123;id&#125;</span>.fastq  &gt; ./<span class="built_in">log</span>/sra2fq.log/<span class="variable">$&#123;id&#125;</span>.<span class="built_in">log</span> 2&gt;&amp;1</span><br><span class="line">  time pigz -p 3 -f ./1.rawfastq/<span class="variable">$&#123;id&#125;</span>_1.fastq &gt; ./1.rawfastq/<span class="variable">$&#123;id&#125;</span>_1.fastq.gz</span><br><span class="line">  time pigz -p 3 -f ./1.rawfastq/<span class="variable">$&#123;id&#125;</span>_2.fastq &gt; ./1.rawfastq/<span class="variable">$&#123;id&#125;</span>_2.fastq.gz</span><br><span class="line"><span class="keyword">done</span> </span><br></pre></td></tr></table></figure>
<hr>
<blockquote>
<p><strong>Troubleshooting</strong><br>err: cmn_iter.c cmn_iter_open_db().VDBManagerOpenDBRead( ‘case1_germline.sra’ ) -&gt; RC(rcVFS,rcMgr,rcOpening,rcDirectory,rcNotFound)<br>2021-03-18T09:53:03 fasterq-dump.2.9.2 err: sorter.c run_producer_pool(): row_count == 0!<br>2021-03-18T09:53:03 fasterq-dump.2.9.2 err: sorter.c execute_lookup_production() -&gt; RC(rcVDB,rcNoTarg,rcConstructing,rcParam,rcInvalid)2021-03-18T09:53:03 fasterq-dump.2.9.2 err: fasterq-dump.c produce_lookup_files() -&gt;<br> RC(rcVDB,rcNoTarg,rcConstructing,rcParam,rcInvalid)#<br><strong>Replied by contributor:</strong> Perhaps it should strip the .sra from the leaf name before creating .fastq output<br></p>
</blockquote>
<hr>
<h2 id="3-2-质控"><a href="#3-2-质控" class="headerlink" title="3.2 质控"></a>3.2 质控</h2><p>通过config文件进行批量操作</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -------------------------------&gt;</span></span><br><span class="line"><span class="comment"># FastQC-v0.11.8 </span></span><br><span class="line"><span class="comment"># -------------------------------&gt;</span></span><br><span class="line">cat 0.sra/sra.infor/sample | <span class="keyword">while</span> <span class="built_in">read</span> id</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  fastqc --outdir ./2.qc/raw.qc/ --threads 5 ./1.rawfastq/<span class="variable">$&#123;id&#125;</span>*.fastq.gz &gt;&gt; ./<span class="built_in">log</span>/qc.log/rawqc/<span class="variable">$&#123;id&#125;</span>_fastqc.log 2&gt;&amp;1 &amp; </span><br><span class="line"><span class="keyword">done</span> </span><br></pre></td></tr></table></figure>
<center><img src="/img/Figures/fastqc.png" alt="fastqc" style="zoom:90%;" /></center>

<p>利用multiqc软件对所有样本的结果进行整合，方便查看。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -------------------------------&gt;</span></span><br><span class="line"><span class="comment"># MultiQC-v1.9</span></span><br><span class="line"><span class="comment"># -------------------------------&gt;</span></span><br><span class="line">multiqc  ./2.qc/raw.qc/*zip  -o ./2.qc/raw.qc/multiqc</span><br></pre></td></tr></table></figure>
<p>输出文件: ./Supplementary/raw_multiqc_report.html</p>
<center><img src="/img/Figures/raw_status_check.png" alt="raw-status" style="zoom:90%;" /></center>

<p>发现测序质量非常好，怀疑已经经过一定的处理</p>
<h2 id="3-3-fastp"><a href="#3-3-fastp" class="headerlink" title="3.3 fastp"></a>3.3 fastp</h2><center><img src="/img/Figures/adaptor.png" alt="adapter" style="zoom:90%;" /></center>

<p>fastqc和MultiQC给出的报告均显示未发现接头，这里用fastp的默认参数处理。教程中用的trim_galore之前在做ATAC-seq是使用过，跑的非常非常慢。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -------------------------------&gt;</span></span><br><span class="line"><span class="comment"># fastp-v0.20.0</span></span><br><span class="line"><span class="comment"># -------------------------------&gt; </span></span><br><span class="line">cat 0.sra/sra.infor/sample | <span class="keyword">while</span> <span class="built_in">read</span> id</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  fastp -i ./1.rawfastq/<span class="variable">$&#123;id&#125;</span>_1.fastq.gz -o ./3.cleanfastq/<span class="variable">$&#123;id&#125;</span>_1.fastq.gz \</span><br><span class="line">        -I ./1.rawfastq/<span class="variable">$&#123;id&#125;</span>_2.fastq.gz -O ./3.cleanfastq/<span class="variable">$&#123;id&#125;</span>_2.fastq.gz \</span><br><span class="line">        --thread=6 \</span><br><span class="line">        &gt; <span class="built_in">log</span>/fastp.log/<span class="variable">$&#123;id&#125;</span>.fastp.log 2&gt;&amp;1 &amp;</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<p>以case1_germline样本为例：</p>
<center><img src="/img/Figures/g1_fastp.png" alt="adapter" style="zoom:80%;" /></center>

<p>发现还是有一定效果的。</p>
<h1 id="四、比对"><a href="#四、比对" class="headerlink" title="四、比对"></a>四、比对</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -------------------------------&gt;</span></span><br><span class="line"><span class="comment"># bwa-v0.7.17</span></span><br><span class="line"><span class="comment"># -------------------------------&gt; </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 索引文件：</span></span><br><span class="line">INDEX=/public/workspace/lincs/wes_cancer/data/gatk_hg38</span><br><span class="line"></span><br><span class="line">cat 0.sra/sra.infor/sample | <span class="keyword">while</span> <span class="built_in">read</span> id</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;start bwa for <span class="variable">$&#123;id&#125;</span>&quot;</span> `date`</span><br><span class="line">  fq1=./3.cleanfastq/<span class="variable">$&#123;id&#125;</span>_1.fq.gz</span><br><span class="line">  fq2=./3.cleanfastq/<span class="variable">$&#123;id&#125;</span>_2.fq.gz</span><br><span class="line">  bwa mem -M -t 6 -R <span class="string">&quot;@RG\tID:<span class="variable">$&#123;id&#125;</span>\tSM:<span class="variable">$&#123;id&#125;</span>\tLB:WXS\tPL:Illumina&quot;</span> <span class="variable">$&#123;INDEX&#125;</span> <span class="variable">$&#123;fq1&#125;</span> <span class="variable">$&#123;fq2&#125;</span> | samtools sort -@ 6 -m 1G  -o ./4.alignment/<span class="variable">$&#123;id&#125;</span>.bam -</span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;end bwa for <span class="variable">$&#123;id&#125;</span>&quot;</span> `date`</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<center><img src="/img/Figures/bamfile.png" alt="bamfile" style="zoom:90%;" /></center>

<p>bwa比对后先产生sam文件，但是因为sam文件太大，占用空间，要转换成二进制的bam文件。因此，脚本中把比对的结果通过管道符1传给 samtools进行排序后直接生存bam文件(中划线“-”作为缓存占位符)，排序的依据是bam文件中reads比对到参考基因组的染色体和坐标。</p>
<p>bam文件格式：</p>
<center><img src="/img/Figures/bam_info.png" alt="bamfile" style="zoom:50%;" /></center>

<h1 id="五、比对结果的质控"><a href="#五、比对结果的质控" class="headerlink" title="五、比对结果的质控"></a>五、比对结果的质控</h1><h2 id="5-1-samtools-stats-plot-bamstats"><a href="#5-1-samtools-stats-plot-bamstats" class="headerlink" title="5.1 samtools stats + plot-bamstats"></a>5.1 samtools stats + plot-bamstats</h2><p>利用samtools stats对bam文件进行统计</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -------------------------------&gt;</span></span><br><span class="line"><span class="comment"># samtools-v1.9</span></span><br><span class="line"><span class="comment"># -------------------------------&gt; </span></span><br><span class="line">cat 0.sra/sra.infor/sample | <span class="keyword">while</span> <span class="built_in">read</span> id</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  bam=./4.alignment/<span class="variable">$&#123;id&#125;</span>.bam</span><br><span class="line">  samtools stats -@ 6 --reference ~/public/workspace/lincs/wes_cancer/data/Homo_sapiens_assembly38.fasta <span class="variable">$&#123;bam&#125;</span> &gt; ./4.alignment/stats/<span class="variable">$&#123;id&#125;</span>.<span class="built_in">stat</span></span><br><span class="line"></span><br><span class="line">  plot-bamstats -p ./4.alignment/stats/<span class="variable">$&#123;id&#125;</span> ./4.alignment/stats/<span class="variable">$&#123;id&#125;</span>.<span class="built_in">stat</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<p>可以查看bamfile比对的信息（以case1_germine为例）：</p>
<center><img src="/img/Figures/g1-stat.png" alt="bam-info" style="zoom:60%;" /></center>

<hr>
<p><strong>Troubleshooting</strong><br>在plot-bamstats时遇到了如下报错（用的samtools-v1.9，samtools-v1.7显示command not found）。因为plot-bamstats 需要调用<code>gnuplot</code>去画图，这里缺少了libjpeg.so.8这个库（是一款开源的jpeg解压库）。</p>
<center><img src="/img/Figures/plot-error.png" alt="plot-error" style="zoom:90%;" /></center>

<p>用conda安装libjpeg.so.8库：</p>
<center><img src="/img/Figures/conda-libjpeg.png" alt="libjpeg" style="zoom:90%;" /></center>

<p>然后报错了,用mamba install也一样是报错：<br><br><img src="/img/Figures/conda-install-error.png" alt="install-error" style="zoom:100%;" /></p>
<p>最后只能去官网下载tar.gz自己编译安装：<br>官网：<a href="http://www.ijg.org/">http://www.ijg.org/</a></p>
<p>我下载的是：<a href="http://www.ijg.org/files/jpegsrc.v8d.tar.gz">http://www.ijg.org/files/jpegsrc.v8d.tar.gz</a><br>但是一直显示编译错误，没有权限，可能要sudo? 留着明天去找邵娇娇了</p>
<center><img src="/img/Figures/make-error.png" alt="make-error" style="zoom:100%;" /></center>

<p>编译警告：warning: Clock skew detected. Your build may be incomplete. 按着教程写了这个：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">find . -<span class="built_in">type</span> f | xargs -n 5 touch</span><br></pre></td></tr></table></figure>
<p>但是还是报一样的错</p>
<p>又试了一下mamba install！！成功了！！</p>
<center><img src="/img/Figures/mamba-success.png" alt="mamba" style="zoom:100%;" /></center>

<p>但是！！libjpeg-turbo是libjpeg是的升级版，plot-bamstats不支持用libjpeg-turbo。</p>
<p>再创建新环境，重新装了gnuplot之后新报错又来了！conda gnuplot自动装上了jpeg的解压库。所以上面libjpeg.so.8库缺失这个问题算是解决了！</p>
<p>先调用gnuplot试一下（需要写全路径，相对路径会报错）：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gnuplot ~/MyCourse/CancerGenomics/WES.proj/4.alignment/stats/plot/case1_germline-quals.gp</span><br></pre></td></tr></table></figure>
<p>可以成功画图了！</p>
<center><img src="/img/Figure/case1_germline-quals.png" style="zoom:75%;" /></center>

<p>然后用plot-bamstats，虽然这里有报错，但图片都出来了</p>
<center><img src="/img/Figures/samtool1.9error.png" alt="error" style="zoom:80%;" /></center>


<p>参考：<br><a href="https://www.jieandze1314.com/post/cnposts/166/">166-为什么使用samtools检查bam质量时报错？</a><br><a href="https://blog.csdn.net/wp133716/article/details/107197125">libjpeg.so.8: cannot open shared object file: No such file or directory.</a><br><a href="https://www.linuxquestions.org/questions/linux-newbie-8/error-clock-skew-detected-make-may-be-incomplete-what%27s-wrong-125912/?__cf_chl_jschl_tk__=cfbca89553aa9c176c35b0156876e5b800ec1c51-1617019792-0-AZ3wgOYkBndrrNqbZ2jUZh3XuYSB1HGsI9OaMmmL0cPqIrKE2XFuDAYw-UufXgiH8ArtnWymYKCGqM8C4mbGIaE7zSFwS2d4QSLFAadibrZLkjNxWVHMFsWah0IBlhOQg-LruE45VXiyVrY1g-DQbSib83JEEaV86GXVe4l4QHFwabMGxZgoiUJzGvvDOOFJN7qH1BvkDC0p-aPA5VjiuEunTLdiUR92A_x9ZRXQFB85eer1Zgp5d82FRB-5LjpJ3jBPXA_lSZGQED2DAv078tYyFshTQQAhfe7dM0ZYJY1hFBdEURdlGF9QUEhx54i30OQe_2xnKVQrOpyTSAeWLrDZK04zCpBOQuC4RAMbefGRmQ_-3bpTZ6zpLE023V0AmkAUjQbcM6O-HDdeypZv6DPjrc7-ji7ljm4eX1llhiLBa1O8DEN6f8fM4E4BtGRXIDaJA-RP9Y-LOs5ROXVTtqs0-CGVmsA5CJw06kvS_y2xjZ_BRepHX9DgU-l4Kz5iqQ">Error -&gt;Clock Skew Detected..Make may be incomplete….What’s wrong?</a><br><a href="https://blog.csdn.net/cxq2046/article/details/50253949">安装libjpeg库后提示libjpeg.so.8不存在（linux环境）</a><br><a href="https://blog.csdn.net/jiejinquanil/article/details/106414938">编译警告：warning: Clock skew detected. Your build may be incomplete.</a></p>
<hr>
<p>以case1_germline和case1_biorep_B为例：</p>
<center><img src="/img/Figures/plot-succ.png" alt="show the plot" style="zoom:80%;" /></center>

<h2 id="5-2-qualimap"><a href="#5-2-qualimap" class="headerlink" title="5.2 qualimap"></a>5.2 qualimap</h2><p><code>qualimap</code>可用来查看覆盖深度等信息，需要py=3.9，跑的时候占用很多内存，大概跑了30分钟</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">cat 0.sra/sra.infor/sample | <span class="keyword">while</span> <span class="built_in">read</span> id</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  qualimap bamqc --java-mem-size=10G -gff /public/workspace/lincs/wes_cancer/data/hg38.exon.bed -nr 100000 -nw 500 -nt 8 -bam ./4.alignment/<span class="variable">$&#123;id&#125;</span>.bam -outdir ./4.alignment/qualimap/<span class="variable">$&#123;id&#125;</span> &amp;</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>WES</category>
      </categories>
  </entry>
</search>
