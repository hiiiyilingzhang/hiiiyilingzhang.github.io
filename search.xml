<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>AI Learning</title>
    <url>/2021/02/17/AI-Learning/</url>
    <content><![CDATA[<h1 id="界面-版本-快捷键"><a href="#界面-版本-快捷键" class="headerlink" title="界面/版本/快捷键"></a>界面/版本/快捷键</h1><h2 id="版本挑选"><a href="#版本挑选" class="headerlink" title="版本挑选"></a>版本挑选</h2><h2 id="CS6-CC2018-CC2020"><a href="#CS6-CC2018-CC2020" class="headerlink" title="CS6/CC2018/CC2020"></a>CS6/CC2018/CC2020</h2><h2 id="AI输出格式"><a href="#AI输出格式" class="headerlink" title="AI输出格式"></a>AI输出格式</h2><p>.ai 工程文件<br>.eps 矢量图<br>.tif 位图<br>.pdf 最稳定</p>
<hr>
<h2 id="设置-快捷键"><a href="#设置-快捷键" class="headerlink" title="设置+快捷键"></a>设置+快捷键</h2><ol>
<li>出血边：相当于margin，预留给打印等的装订，一般0.3px</li>
<li><code>ALT+滚动滑轮/ctrl+加减键</code>：放大缩小 (CTRL+0：恢复到默认大小)</li>
<li><code>空格键+鼠标左键</code>：抓手工具</li>
<li><code>CTRL+R</code>:标尺</li>
<li><code>CTRL+;</code>:参考线</li>
<li><code>CTRL+&quot;</code>:网格</li>
<li><code>CTRL+Y</code>：轮廓模式，可以看到轮廓边缘</li>
<li><code>CTRL+ALT+Y</code>：像素模式  </li>
</ol>
<hr>
<h1 id="选择工具组-描边-缩放工具"><a href="#选择工具组-描边-缩放工具" class="headerlink" title="选择工具组/描边/缩放工具"></a>选择工具组/描边/缩放工具</h1><h2 id="选择工具组"><a href="#选择工具组" class="headerlink" title="选择工具组"></a>选择工具组</h2><p><code>选择工具(V)</code>:选择、移动、缩放、旋转（按shift表示等比缩放）<br><code>直接选择(A)</code>:选择、移动、变形<br>显示/隐藏定界框：<code>ctrl+shift+B</code><br>显示/隐藏边缘：<code>ctrl+H</code><br>套索工具：自由选择需要的锚点</p>
]]></content>
      <categories>
        <category>toolsLearning</category>
      </categories>
      <tags>
        <tag>Adobe Illustrator</tag>
      </tags>
  </entry>
  <entry>
    <title>Functional Genomics-01-BioinfoAna of Transcriptional Regulation</title>
    <url>/2021/03/02/Functional-Genomics-01-BioinfoAna-of-Transcriptional-Regulation/</url>
    <content><![CDATA[<h1 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h1><ol>
<li><strong>表达(gene expression)</strong>:基因在生物体内的转录、剪接、翻译以及转变成具有生物活性的蛋白质分子之前的所有加工过程。<br>从一套基本不变的基因组中产生出多元化的细胞类型，是由调控基因活性的各种信号途径所控制。</li>
<li><strong>转录因子(transcr iption factor, TF)</strong>: 也称反式作用因子，有序地结合在目标基因启动子(promoter)序列中的特殊位点，启动基因的转录和控制基因的转录效率。<br> 根据转录因子的作用特点可分为二类:<ul>
<li>普遍转录因子，它们与RNA聚合酶II共同组成转录起始复合体时，转录才能在正确的位置开始。包括TFIID，TFIIA，TFIIF，TFIIE，TFIIH等;</li>
<li>组织细胞特异性转录因子，这些TF是在特异的组织细胞或是受到一些类固醇激素/生长因子的刺激后，开始表达某些特异蛋白质分子时，才需要的一类转录因子。</li>
</ul>
</li>
<li><strong>转录因子的结合位点(transcription factor binding site, TFBS)</strong>: 转录因子调节基因表达时，与基因模板链结合的区域，又被称为顺式作用元件。长度从几个到几十个碱基不等。</li>
<li>**模体(motif)**：转录因子的结合位点的特定模式。不是一段序列</li>
</ol>
<hr>
<h1 id="基因转录调节的基本模式"><a href="#基因转录调节的基本模式" class="headerlink" title="基因转录调节的基本模式"></a>基因转录调节的基本模式</h1><p><img src="/img/article/functionalgenomics/basic.png" alt="basic mode"></p>
<ol>
<li>启动子：启动子一般位于真核基因转录起始点上游 200bp以内。包括至少一个转录起始点以及一个以上的机能组件。启动子是基因的一个组成部分，控制基因表达（转录）的起始时间和表达的程度。</li>
<li>TATA盒：共有序列是TATAAAA，通常位于转录起始点上游-25~-30bp，决定转录的方向和精确的转录起始点。TATA盒是基本转录因子TFIID结合位点。</li>
<li>上游启动子元件：除TATA盒外，GC盒（GGGCGG）和 CAAT盒（GCCAAT）也是很多基因常见的，它们通常位于转录起始点上游-30~-110bp区域</li>
<li>RNA聚合酶：以一条DNA链或RNA为模板催化由核苷5′-三磷酸合成RNA的酶。是催化以DNA为模板(template)、三磷酸核糖核苷为底物、通过磷酸二酯键而聚合的合成RNA的酶。</li>
<li>顺式作用元件(cis-acting element): 存在于基因旁侧序列中能影响基因表达的序列。顺式作用元件包括启动子、增强子、调控序列和可诱导元件等，作用是参与基因表达的调控。顺式作用元件本身不编码任何蛋白质，仅仅提供一个作用位点，要与反式作用因子相互作用而起作用。</li>
</ol>
<hr>
<h1 id="基因转录调节机制的研究方法"><a href="#基因转录调节机制的研究方法" class="headerlink" title="基因转录调节机制的研究方法"></a>基因转录调节机制的研究方法</h1><h2 id="实验方法"><a href="#实验方法" class="headerlink" title="实验方法"></a>实验方法</h2><h3 id="荧光素酶报告基因-luciferase-report-gene-："><a href="#荧光素酶报告基因-luciferase-report-gene-：" class="headerlink" title="荧光素酶报告基因(luciferase report gene)："></a>荧光素酶报告基因(luciferase report gene)：</h3><p>检测转录因子与目的基因启动子区DNA相互作用，荧光素酶的表达量与转录因子的作用强度成正比。 </p>
<h3 id="凝胶迁移-EMSA-electrophoreticmobility-shift-assays"><a href="#凝胶迁移-EMSA-electrophoreticmobility-shift-assays" class="headerlink" title="凝胶迁移(EMSA, electrophoreticmobility shift assays):"></a>凝胶迁移(EMSA, electrophoreticmobility shift assays):</h3><p>是一种用于蛋白与核酸相互作用的技术，可用于定性和定量分析。最初是用于转录因子与启动子相互作用的验证性实验，也可应用与蛋白DNA、蛋白-RNA互作研究。EMSA主要基于蛋白-探针复合物在在凝胶电泳过程中迁移较慢的原理。</p>
<h3 id="DNase足迹法-DNase-footprinting-："><a href="#DNase足迹法-DNase-footprinting-：" class="headerlink" title="DNase足迹法(DNase footprinting)："></a>DNase足迹法(DNase footprinting)：</h3><p>鉴别RNA聚合酶等蛋白质在DNA上结合位点的方法。不仅能找到与特异性DNA结合的目标蛋白，而且能告知目标蛋白结合在哪些碱基部位。（原理：蛋白质结合在DNA片段上，能保护结合部位不被DNase破坏，DNA分子经酶切作用后遗留下该片段(亦称“足迹”)，进而可以确定它的序列）</p>
<h3 id="染色质免疫沉淀-ChIP-chromatin-immunoprecipitation"><a href="#染色质免疫沉淀-ChIP-chromatin-immunoprecipitation" class="headerlink" title="染色质免疫沉淀(ChIP, chromatin immunoprecipitation)"></a>染色质免疫沉淀(ChIP, chromatin immunoprecipitation)</h3><ul>
<li>创立者: 20世纪80年代末Alexander Varshavsky等人(Cell. 1988,53(6): 937-947 )</li>
<li>原理:<br>活细胞采用甲醛交联后裂解，染色体分离成为一定大小的片段，然后用特异性抗体免疫沉淀目标蛋白与DNA交联的复合物，对特定靶蛋白与DNA片段进行富集。采用低pH值反交联，DNA与蛋白质之间的Schiff键（-C=N-）水解，释放DNA片段。通过对目标片段的纯化与检测，获得DNA与蛋白质相互作用的序列信息。</li>
<li>应用: 主要用来分析目标基因有没有活性、或者分析一种已知蛋白（转录因子）的靶基因有哪些。</li>
<li>特点：<ol>
<li>针对某一特定候选转录因子，是否特异性结合于所调节的靶基因某一预定区域内，如启动子区，进行检测。</li>
<li>对同一DNA底物, 可以运用多种不同的抗体, 分别进行免疫共沉淀,以确定多种结合蛋白在同一染色质片段上的结合</li>
</ol>
</li>
</ul>
<h3 id="高通量实验测定-ChIP-chip-ChIP-seq"><a href="#高通量实验测定-ChIP-chip-ChIP-seq" class="headerlink" title="高通量实验测定(ChIP-chip, ChIP-seq)"></a>高通量实验测定(ChIP-chip, ChIP-seq)</h3><ol>
<li><strong>ChIP-chip</strong>:</li>
</ol>
<ul>
<li>创立者:2000年，Richard A. Young等人(Science.2000, 290(5500): 2306-2309)</li>
<li>原理:<br>该方法首先使用固定剂将DNA染色质断裂为0.2-1kp的碱基段;然后用针对特异性蛋白质的抗体进行ChIP，将富集的蛋白质一DNA复合物进行扩增，再将扩增的DNA片断与覆盖欲检测基因组的芯片进行杂交，使用芯片扫描仪对芯片的信息进行处理。</li>
<li>特点:<br> ChIP和芯片技术的联合运用<br> 全基因组范围内的定位分析<br> 靶基因群的高通量分析</li>
<li>不足：分辨率较低，大于200bp；只能检测已知序列</li>
</ul>
<ol start="2">
<li><strong>ChIP-seq</strong>:</li>
</ol>
<ul>
<li>创立者： 2007年，Steven J.M. Jones等人 (Science. 2000, 290(5500): 2306-2309 )</li>
<li>定义：<br>ChIP-seq是将深度测序技术与ChIP实验相结合，分析全基因组范围内DNA结合蛋白结合位点、组蛋白修饰、核小体定位或DNA甲基化的高通量方法，可以应用到任何基因组序列已知的物种，并能确切得到每一个片段的序列信息</li>
<li>原理：<ul>
<li>首先通过染色质免疫共沉淀技术（ChIP）特异性地富集目的蛋白结合的DNA片段，并对其进行纯化与文库构建；</li>
<li>然后对富集得到的DNA片段进行高通量测序。</li>
<li>研究人员通过将获得的数百万条序列标签精确定位到基因组上，从而获得全基因组范围内与组蛋白、转录因子等互作的DNA区段信息。</li>
</ul>
</li>
<li>特点：<ul>
<li>染色质免疫沉淀后的DNA，直接进行高通量测序 </li>
<li>是一个“开放系统”。它可以检测更小的结合区段、未知的结合位点、结合位点内的突变情况和蛋白亲合力较低的区段</li>
<li>成本低，周期短，省去了标记和杂交等步骤，并且无需多次重复实验，效率高</li>
<li>分辨率可提高到30～50bp</li>
</ul>
</li>
</ul>
<h2 id="转录因子结合位点的信息学预测方法"><a href="#转录因子结合位点的信息学预测方法" class="headerlink" title="转录因子结合位点的信息学预测方法"></a>转录因子结合位点的信息学预测方法</h2><p>问题：转录因子结合位点一般在6-12bp间，ChIPchip分辨率200-800bp, ChIP-seq在100bp或更高， 因此要对现有的高通量数据进行处理。<br>1.转录因子结合位点定位：根据若干个motif，在所研究的某个基因启动子区域内，搜索相应转录因子可能的结合位点。<br>2.转录因子结合位点的识别：通过收集多个基因启动子序列，在其中寻找具有统计显著性的短片段，作为同一转录因子可能的结合位点。</p>
<h3 id="转录因子结合位点的表示方式"><a href="#转录因子结合位点的表示方式" class="headerlink" title="转录因子结合位点的表示方式"></a>转录因子结合位点的表示方式</h3><h4 id="（一）共性序列-consensus-sequence"><a href="#（一）共性序列-consensus-sequence" class="headerlink" title="（一）共性序列(consensus sequence)"></a>（一）共性序列(consensus sequence)</h4><ul>
<li>将能与同一个转录因子结合的所有DNA片段按照对应位置进行排列，在每个位置上选择最可能出现的碱基,就组成了该转录因子结合位点的共性序列。</li>
<li>共性序列中用A、C、G、T之外的字母来表示结合位点中各个位置上可能出现的碱基组合，这些字母称为IUPAC简并码。</li>
<li>共性序列的表示方法简明易懂，却不能够反映每个位置上不同碱基出现的概率。</li>
</ul>
<p><img src="/img/article/functionalgenomics/IUPAC.png" alt="IUPAC"></p>
<h4 id="（二）位置频率矩阵-position-frequency-matrix"><a href="#（二）位置频率矩阵-position-frequency-matrix" class="headerlink" title="（二）位置频率矩阵(position frequency matrix)"></a>（二）位置频率矩阵(position frequency matrix)</h4><p>位置频率矩阵可以反映出每个位置上不同碱基出现的概率。</p>
<ul>
<li>该模型的一个前提假设是各个位置上碱基出现的概率相互独立。</li>
<li>矩阵每一列表示模体相应位置上四种碱基出现的概率。</li>
</ul>
<p><img src="/img/article/functionalgenomics/PFM.png" alt="PFM"></p>
<h3 id="三-序列标识图-sequence-logo"><a href="#三-序列标识图-sequence-logo" class="headerlink" title="(三)序列标识图(sequence logo)"></a>(三)序列标识图(sequence logo)</h3><ul>
<li>序列标识图依次绘出模体中各个位置上出现的碱基，每个位置上所有碱基的高度和反映了该位置上碱基的一致性，每个碱基字母的大小与碱基在该位置上出现<br>的频率成正比。</li>
<li>这种表示方法直观地给出模体各个位置上碱基出现的倾向性和整个模体的序列的一致性。</li>
</ul>
<p><img src="/img/article/functionalgenomics/methods.png" alt="methods"></p>
]]></content>
      <categories>
        <category>Functional Genomics</category>
      </categories>
      <tags>
        <tag>Functional Genomics</tag>
      </tags>
  </entry>
  <entry>
    <title>Stat-01-MDS</title>
    <url>/2021/02/22/Stat-01-MDS/</url>
    <content><![CDATA[<p><strong>MDS(Multi-dimetional Scaling, 多维标度法)</strong></p>
<ul>
<li><p>核心目的:<br>对于距离矩阵D,在低维空间中寻找一个矩阵Z，使得Z构成的欧式距离矩阵B尽可能和原来矩阵D保持一致。此种多维标度法也被称为主坐标分析。（把所有的距离矩阵，找一个低维的欧氏距离去接近）</p>
</li>
<li><p>具体推导详见goodnote笔记</p>
</li>
<li><p>R语言通过MDS对GTEx数据进行降维</p>
</li>
<li><p>当dist矩阵本身为欧氏距离时，MDS == PCA<br>MDS更强调对不同种类的dist转换<br>PCA强调用线性组合表示variable</p>
</li>
</ul>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment">#########################</span></span><br><span class="line"><span class="comment"># Data 2021-02-22</span></span><br><span class="line"><span class="comment"># Author zhangyl</span></span><br><span class="line"><span class="comment"># MDS</span></span><br><span class="line"><span class="comment">#########################</span></span><br><span class="line"></span><br><span class="line">rm(<span class="built_in">list</span> = ls())</span><br><span class="line"></span><br><span class="line"><span class="comment"># -----------------------------------&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</span></span><br><span class="line"><span class="comment"># MDS</span></span><br><span class="line"><span class="comment"># -----------------------------------&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;</span></span><br><span class="line">load(<span class="string">&quot;./data/GTEx.RData&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># tissue的注释文件</span></span><br><span class="line">accession.df = read.csv(file=<span class="string">&quot;./data/GTEx_accession_table.csv&quot;</span>)</span><br><span class="line">annotation.df = read.csv(file=<span class="string">&quot;./data/GTEx_v7_Annotations_SampleAttributesDS.txt&quot;</span>,header = <span class="built_in">T</span>,sep = <span class="string">&quot;\t&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># make matrix </span></span><br><span class="line">GTEx.TPM.gene.mat.only_TPM = log2(GTEx.TPM.gene.mat[,<span class="built_in">c</span>(-<span class="number">1</span>,-<span class="number">2</span>)]+<span class="number">1</span>)</span><br><span class="line">rownames(GTEx.TPM.gene.mat.only_TPM) = <span class="built_in">as.character</span>(GTEx.TPM.gene.mat$Name)</span><br><span class="line"></span><br><span class="line"><span class="comment"># get tissue info </span></span><br><span class="line">tissue_info = <span class="built_in">as.character</span>(annotation.df$SMTS[match(accession_id_vec,annotation.df$SAMPID)])</span><br><span class="line"></span><br><span class="line"><span class="comment"># run MDS</span></span><br><span class="line">dist.mat = dist(t(GTEx.TPM.gene.mat.only_TPM), method = <span class="string">&quot;minkowski&quot;</span>, p=<span class="number">5</span>)</span><br><span class="line">dist.mat = <span class="built_in">sqrt</span>(<span class="number">2</span>*(<span class="number">1</span> - <span class="built_in">abs</span>(cor(GTEx.TPM.gene.mat.only_TPM,method = <span class="string">&quot;kendall&quot;</span>))))</span><br><span class="line"></span><br><span class="line">MDS_res = cmdscale(dist.mat,eig=<span class="literal">TRUE</span>, k=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">MDS_xy.df = data.frame(MDS_1 = MDS_res$points[,<span class="number">1</span>],</span><br><span class="line">                       MDS_2 = MDS_res$points[,<span class="number">2</span>],</span><br><span class="line">                       tissue = factor(tissue_info))</span><br><span class="line"></span><br><span class="line"><span class="comment"># plot with ggplot2</span></span><br><span class="line">library(ggplot2)</span><br><span class="line"></span><br><span class="line">ggplot(data = MDS_xy.df, aes(MDS_1,MDS_2,color=tissue)) + </span><br><span class="line">  geom_point()  + </span><br><span class="line">  geom_text(aes(label=tissue)) + </span><br><span class="line">  theme_bw()</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>Bioinfo</category>
      </categories>
      <tags>
        <tag>Stat</tag>
      </tags>
  </entry>
  <entry>
    <title>Stat-02-tSNE</title>
    <url>/2021/02/23/Stat-02-tSNE/</url>
    <content><![CDATA[<h1 id="线性降维与非线性降维"><a href="#线性降维与非线性降维" class="headerlink" title="线性降维与非线性降维"></a><strong>线性降维与非线性降维</strong></h1><ul>
<li>线性降维(Linear dimensionality reduction)<ul>
<li>主成分分析(PCA)</li>
<li>多维坐标变换(MDS)</li>
<li>聚类分析(Clustering)</li>
</ul>
</li>
<li>非线性降维(Nonlinear dimensionality reduction)<ul>
<li>lsomap (等度量映射)</li>
<li>LLE (局部线性嵌入)</li>
<li>t-SNE (t分布-随机近邻嵌入)</li>
</ul>
</li>
</ul>
<p>非线性降维属于流形学习的一部分（流形是局部具有欧几里得空间性质的空间，流形学习是指把高位空间整到低维去，使得欧氏距离重新生效，MDS是保留原有距离特征）</p>
<hr>
<h1 id="t-SNE的直观理解"><a href="#t-SNE的直观理解" class="headerlink" title="t-SNE的直观理解"></a>t-SNE的直观理解</h1><p><a href="https://www.seas.harvard.edu/courses/cs281/papers/tsne.pdf">Visualizing data using t-SNE, Laurens van der Maaten and Geoffrey Hintton, Journel of machine learning research, 2008.</a></p>
<ol>
<li>随机选择起始点;</li>
<li>计算高维空间这些样本点的概率分布F1;</li>
<li>计算低维空间这些样本点的概率分布F2;</li>
<li>迭代:如果能够使F1与F2概率分布尽可能的接近则降维成功</li>
</ol>
<hr>
<h1 id="信息熵与KL散度"><a href="#信息熵与KL散度" class="headerlink" title="信息熵与KL散度"></a>信息熵与KL散度</h1><h2 id="信息熵"><a href="#信息熵" class="headerlink" title="信息熵"></a>信息熵</h2><p>衡量不确定性的大小，信息熵越大，携带的不确定性越多</p>
<h2 id="KL散度-Kullback-Leibler-Divergence"><a href="#KL散度-Kullback-Leibler-Divergence" class="headerlink" title="KL散度(Kullback-Leibler Divergence)"></a>KL散度(Kullback-Leibler Divergence)</h2><p>也叫相对熵，利用KL散度来衡量两个分布是否相似</p>
<p>e.g. 正常样本与癌症样本 D(KL)计算dist——&gt; MDS可视化 D(KL)&gt;0.5发生变化</p>
<hr>
<h1 id="SNE的数学过程"><a href="#SNE的数学过程" class="headerlink" title="SNE的数学过程"></a>SNE的数学过程</h1><ol>
<li>先通过欧氏距离表示点的概率分布，分低维和高维情况；</li>
<li>目标是希望高维和低维之间的分布尽可能相同；</li>
<li>初始化时需要设置参数<strong>困惑度</strong>(perplrxity),SNE会通过二分搜索的方法计算最佳的初始化方差，一般困惑度选择5~50；</li>
<li>对目标函数进行迭代优化，可以增加扰动，防止局部最优；</li>
</ol>
<hr>
<h1 id="t-SNE相对于SNE的提升"><a href="#t-SNE相对于SNE的提升" class="headerlink" title="t-SNE相对于SNE的提升"></a>t-SNE相对于SNE的提升</h1><ol>
<li>t-SNE解决了概率不对成的问题，高位情况下Pij为对称；</li>
<li>t-SNE使用t分布作为降维后的概率分布（SNE用的是正态分布）</li>
</ol>
<hr>
<h1 id="t-SNE的优缺点"><a href="#t-SNE的优缺点" class="headerlink" title="t-SNE的优缺点"></a>t-SNE的优缺点</h1><ul>
<li>优点:<ul>
<li>非常优秀的降维可视化方法，对各种数据集的表现都非常好!</li>
</ul>
</li>
<li>缺点:<ul>
<li>基本只用于可视化;</li>
<li>t-SNE倾向保留局部特征，有的时候会“只见树木不见森林”（可以先做pca）;</li>
<li>t-SNE结果中的距离没有太大意义，因为都是计算的概率;</li>
<li>t-SNE训练速度比较慢</li>
</ul>
</li>
<li>特点:<ul>
<li>受初值影响（调试时需要set.seed）</li>
</ul>
</li>
</ul>
<hr>
<h1 id="R语言计算t-SNE"><a href="#R语言计算t-SNE" class="headerlink" title="R语言计算t-SNE"></a>R语言计算t-SNE</h1><figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment">#########################</span></span><br><span class="line"><span class="comment"># Data 2021-02-27</span></span><br><span class="line"><span class="comment"># Author zhangyl</span></span><br><span class="line"><span class="comment"># t-SNE</span></span><br><span class="line"><span class="comment">#########################</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># load package </span></span><br><span class="line">library(Rtsne)</span><br><span class="line"></span><br><span class="line">SD.vector &lt;- apply(GTEx.TPM.gene.mat[,<span class="built_in">c</span>(-<span class="number">1</span>,-<span class="number">2</span>)],<span class="number">1</span>,FUN=<span class="keyword">function</span>(x)&#123;sd(x)&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># select top3000</span></span><br><span class="line">GTEx.TPM.gene.mat.log2 &lt;- log2(GTEx.TPM.gene.mat[,<span class="built_in">c</span>(-<span class="number">1</span>,-<span class="number">2</span>)]+<span class="number">1</span>)</span><br><span class="line">GTEx.TPM.gene.mat.log2.top3000 &lt;- GTEx.TPM.gene.mat.log2[order(SD.vector,decreasing = <span class="built_in">F</span>),]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Rtsne()</span></span><br><span class="line"><span class="comment"># matrix 行是基因，列是variables</span></span><br><span class="line"><span class="comment"># perplexity 5~50</span></span><br><span class="line"></span><br><span class="line">set.seed(<span class="number">20210227</span>)</span><br><span class="line">tSNE_res &lt;- Rtsne(t(GTEx.TPM.gene.mat.log2.top3000),dims = <span class="number">3</span>,perplexity = <span class="number">10</span>,pca = <span class="built_in">T</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># plot region </span></span><br><span class="line">tSNE_res.df &lt;- as.data.frame(tSNE_res$Y)</span><br><span class="line">colnames(tSNE_res.df) &lt;- <span class="built_in">c</span>(<span class="string">&quot;tSNE1&quot;</span>,<span class="string">&quot;tSNE2&quot;</span>,<span class="string">&quot;tSNE3&quot;</span>)</span><br><span class="line">tSNE_res.df$tissue &lt;- tissue_info</span><br><span class="line"></span><br><span class="line">ggplot(data = tSNE_res.df, aes(tSNE1,tSNE2,color=tissue)) + </span><br><span class="line">  geom_point()  + </span><br><span class="line">  geom_text(aes(label=tissue)) + </span><br><span class="line">  theme_bw()</span><br><span class="line"></span><br><span class="line">ggplot(data = tSNE_res.df, aes(tSNE1,tSNE3,color=tissue)) + </span><br><span class="line">  geom_point()  + </span><br><span class="line">  geom_text(aes(label=tissue)) + </span><br><span class="line">  theme_bw()</span><br><span class="line"></span><br><span class="line">ggplot(data = tSNE_res.df, aes(tSNE2,tSNE3,color=tissue)) + </span><br><span class="line">  geom_point()  + </span><br><span class="line">  geom_text(aes(label=tissue)) + </span><br><span class="line">  theme_bw()</span><br><span class="line"></span><br><span class="line"><span class="comment"># use plotly (3D)</span></span><br><span class="line">library(plotly)</span><br><span class="line"></span><br><span class="line">p &lt;- plot_ly(tSNE_res.df, x = ~tSNE1, y = ~tSNE2, z = ~tSNE3, color = ~tissue) %&gt;%</span><br><span class="line">  add_markers() %&gt;%</span><br><span class="line">  layout(scene = <span class="built_in">list</span>(xaxis = <span class="built_in">list</span>(title = <span class="string">&#x27;tSNE1&#x27;</span>),</span><br><span class="line">                      yaxis = <span class="built_in">list</span>(title = <span class="string">&#x27;tSNE2&#x27;</span>),</span><br><span class="line">                      zaxis = <span class="built_in">list</span>(title = <span class="string">&#x27;tSNE3&#x27;</span>)))</span><br><span class="line">p</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>Bioinfo</category>
      </categories>
      <tags>
        <tag>Stat</tag>
      </tags>
  </entry>
  <entry>
    <title>TOEFL-Wordlist</title>
    <url>/2021/02/20/TOEFL-Wordlist/</url>
    <content><![CDATA[<p>210220</p>
<ol>
<li><p><strong>sentence</strong> n./vt. 判决，宣判<br>serve a sentence 服刑</p>
<ul>
<li>Tom will be sentenced to death/life imprisonment/three years in prison.</li>
</ul>
</li>
<li><p><strong>impact</strong> vi./vt.  影响(on, upon); 对。。。有影响；（天文）撞击</p>
</li>
<li><p><strong>complex</strong> == system n. 复合体；综合设施<br>a sports complex/building complex建筑群/to suffer from a guilt complex 内疚感</p>
<ul>
<li>This is just one of a whole complex of issue.</li>
</ul>
</li>
<li><p><strong>amount</strong> v. 总计，合计；等于，相当于；发展成，变成</p>
<ul>
<li>The bill amounts to $10.</li>
<li>They gave me some help in the beginning but it did not amount to much(== they did not give me much help)</li>
</ul>
</li>
<li><p><strong>outgassing</strong>  n.除气；脱气  adj. 除气的；释气的</p>
<ul>
<li>The origin of our present atmosphere is therefore a combination of terrestrial outgassing and interplanetary assault (further changed by later biological events). (20190810真题)</li>
<li>Little by little, the planet generated a new, secondary atmosphere by volcanic outgassing of volatile（挥发性的，不稳定的） materials from its interior. (2015年真题Earth’s Atmosphere)</li>
</ul>
</li>
<li><p>易混词</p>
<ul>
<li><p><strong>vary</strong></p>
<ul>
<li>variety: a variety ofbeedback mechanisms vs. a myriad of 大量的，无数的</li>
<li>various/varied</li>
<li>variable n.变量/invariable n.常量</li>
<li>invariable：不变地，一定地(== always/constantly/customarily/regularly)</li>
</ul>
</li>
<li><p><strong>effect</strong></p>
<ul>
<li>effect:  n.结果 v.造成  the oppposite effect</li>
<li>effective:  adj,有效性  vs. efficient有效率的/ineffective无效的</li>
<li>effectiveness:  n. 效力</li>
<li>affect:  vt.影响  affect my decision</li>
<li>affection:  n. 喜爱(for sb./sth.)</li>
</ul>
</li>
<li><p><strong>object</strong></p>
<ul>
<li>object:  n. 目标；物体；客体；宾语  v. 反对  Many local people object to the building of the new airport</li>
<li>objective:  n. 目的，目标  adj.客观的  an objective analysis</li>
<li>objection:  n. 异议  I have no objection to him coming to stay.</li>
<li>subject:  n. 主题；起因；科目；国民；主旋律  adj.易遭受…的  v.(使)臣服 </li>
<li>subjective:  adj. 主观的；个人的</li>
</ul>
</li>
<li><p><strong>economy</strong></p>
<ul>
<li>economy:  n.经济  The economy is in recession</li>
<li>economic:  adj.经济上的；合算的</li>
<li>economical:  adj.节俭的  an economical car to run/ He was economical in all areas of his life</li>
<li>economically:  adv.节俭的</li>
<li>econimics:  n.经济学</li>
</ul>
</li>
<li><p><strong>technique</strong></p>
<ul>
<li>technique:  n.技巧，技法  (==method/approach/means/craft)</li>
<li>technical:  adj.技术上的  offer technical support</li>
<li>technology(-ies):  n.技术；工艺  high technology/information technology</li>
<li>technological:  adj.技术的；工艺的  technological innovation  (== industrial/mechanical) </li>
</ul>
</li>
</ul>
</li>
</ol>
<hr>
<p>210221</p>
]]></content>
      <categories>
        <category>TOEFL</category>
      </categories>
      <tags>
        <tag>TOEFL</tag>
      </tags>
  </entry>
  <entry>
    <title>TOEFL-writing-00</title>
    <url>/2021/02/19/TOEFL-writing-00/</url>
    <content><![CDATA[<h1 id="题型"><a href="#题型" class="headerlink" title="题型"></a>题型</h1><ol>
<li>综合写作 20 min 150-225字</li>
</ol>
<ul>
<li>阅读：3分钟 300词<br>话题关于什么，分论点是什么</li>
<li>听力：2分钟 330词<br>针对阅读短文进行他的论点阐述，理由最重要的点<br>记笔记很重要!!!!</li>
</ul>
<ol start="2">
<li>独立写作 30 min 400字左右</li>
</ol>
<ul>
<li><p>题型分类</p>
<ul>
<li><p>维度1：内容<br> <strong>利弊题：好不好</strong><br> People <strong>should</strong> relax with hobbies or physical activities that are different from what they do in Work.</p>
<p> 逻辑起点(A or B or C)——&gt;逻辑终点</p>
<p> <strong>现象题：现象存在还是不存在，古今对比题</strong><br> Agree or disagree? Students nowadays do not respect their teachers as much as they did in the past.</p>
</li>
<li><p>维度2：选项<br> <strong>二选一</strong><br> It is better to relax by watching a movie or reading a book than relax by doing physical exercise</p>
<p> <strong>三选一</strong><br> In times of an econimic crisis, in which area should governments reduce its spending? 1)Arts. 2)Scientific research. 3)Parks and public gardens </p>
<p> <strong>一个选项</strong><br> It is a waste of money for government to fund space travel. </p>
<p> The best way for the government to improve health care is cleaning the enivironment.</p>
</li>
</ul>
</li>
<li><p>练习</p>
<blockquote>
<p>例1：People should relax with hobbies or physical activities that are different from what they do in work</p>
</blockquote>
<p>  利弊题+二选一：<br>  different hobbies and physical activities ——&gt; good</p>
<blockquote>
<p>例2：Which one is the most important for teacher of high school:   1) The ability to help students plan for their future;    2) The ability to find the students who need help most and help them;    3) Teach students how to learn outside the classroom.</p>
</blockquote>
<p>  利弊题+三选一：<br>  learn outside classrooms  ——&gt; good</p>
<blockquote>
<p>例3：Agree or disagree? Students nowadays do not respect their teachers as much as they did in the past.</p>
</blockquote>
<p>  现象题：now respect teachers</p>
</li>
</ul>
<hr>
<h1 id="破题方法"><a href="#破题方法" class="headerlink" title="破题方法"></a>破题方法</h1><h2 id="利弊题"><a href="#利弊题" class="headerlink" title="利弊题"></a>利弊题</h2><p>论证<strong>逻辑起点</strong>对于<strong>逻辑终点</strong>的好处</p>
<blockquote>
<p>例1：Compared with people who live in <strong>cities</strong>, people who live in rural areas can <strong>take better care of families</strong>.<br>逻辑起点：住在城市<br>逻辑终点：住在城市能更好的照顾家人</p>
</blockquote>
<p>理由说两大论点：</p>
<ol>
<li>cities ——&gt; more money：<br>education,<br>medical care</li>
<li>cities ——&gt; infrastructure:<br>supermarkert,<br>transportation </li>
</ol>
<blockquote>
<p>例2：If your teacher says something incorrect in a class, what will you do? 1) Interrupt your teacher right away; 2) keep silent;  3) correct your teacher after class.</p>
</blockquote>
<p>after class ——&gt; good<br>理由说两大论点：</p>
<ol>
<li>after class ——&gt; relationship:<br>respect<br>communicate;</li>
<li>after class ——&gt; academic performance:<br>errors<br>knowledge</li>
</ol>
<blockquote>
<p>例3：The best way for the government to improve health care is cleaning the environmment.</p>
</blockquote>
<p>法一：<br>clean environ. ——&gt; health care<br>方面说把health care 下切:</p>
<ol>
<li>clean environ. ——&gt; physical health: 理由说<br>air quality<br>food quality</li>
<li>clean environ. ——&gt; mental health: 理由说<br>less pressure<br>happiness</li>
</ol>
<p>法二:<br>需要重点与clean envirn.对比，扣题</p>
<ol>
<li>health education ——&gt; health care：(方面说)<br>knowledge<br>exercise</li>
<li>medical care ——&gt; health care: (方面说)<br>hopistals<br>experts</li>
</ol>
<h2 id="现象题"><a href="#现象题" class="headerlink" title="现象题"></a>现象题</h2><p>写法1：现象产生的原因——why<br>写法2：现象的具体体现——切点</p>
<blockquote>
<p>例1：Nowadays, younger people spend more time on improving the world than in the past.</p>
</blockquote>
<p>法一：<br>现象产生的两大原因（理由说）：</p>
<ol>
<li>busy ——&gt; now less time improve world: 忙于什么方面(方面说)<br>study<br>work</li>
<li>incapable ——&gt; now less time improve world：没有能力的具体体现(方面说)<br>money<br>knowledge</li>
</ol>
<p>法二：<br>有更多的时间改善环境，投身于科技(方面说)</p>
<ol>
<li>now less time improve world ——&gt; environment：改善环境的具体体现（方面说）<br>air quality<br>water quality</li>
<li>now less time improve world ——&gt; technology：投身科技的集体体现（方面说）<br>majors<br>suggestion</li>
</ol>
<h2 id="天使题"><a href="#天使题" class="headerlink" title="天使题"></a>天使题</h2><p>题目本身包含了两个点<br>作为两个总论点或某一段的两个分论点</p>
<blockquote>
<p>例1：The <strong>personal and work-related challenges</strong> we face now are different from those our parents and grandparents faced when they were young.</p>
</blockquote>
<blockquote>
<p>例2：Children should <strong>play and study</strong> rather than learn how to do household chores.</p>
</blockquote>
<blockquote>
<p>例3：People should relax with <strong>hobbies or physical activities</strong> that are different from what they do in work.</p>
</blockquote>
<blockquote>
<p>例4：The opinions of celebrities, such as <strong>entertainers and athletes</strong>, are more impor tant to the younger people than they are to the older people.</p>
</blockquote>
<p>celebrities ——&gt; young people<br>把young people分为stu和young adults</p>
<ol>
<li>celebrities ——&gt; students<br>entertainer: fashion<br>athlete: persistence</li>
<li>celebrities ——&gt; young adults<br>entertainer: friendship<br>athlete: value exercise</li>
</ol>
<h2 id="魔鬼题"><a href="#魔鬼题" class="headerlink" title="魔鬼题"></a>魔鬼题</h2><p>题目包含从句，破题时所有思路都落在逻辑终点上</p>
<blockquote>
<p>例1：Do you agree or disagree with the following statement? To <strong>truly enjoy a vacation (holiday)</strong>, people should leave their mobile phones at home.</p>
</blockquote>
<blockquote>
<p>例2：<strong>In order to attract good students</strong>, many universities spend a lot of money in society activities.</p>
</blockquote>
<blockquote>
<p>例3：To <strong>improve health</strong>, which aspect will you change in life? 1) kinds of food to eat 2 ) the amount of exercise 3 ) the amount of stress (15.12.20) </p>
</blockquote>
<p>more exercise ——&gt; health（全部指向health,方面说）</p>
<ol>
<li>more exercise ——&gt; physical health:<br>muscle<br>eyestrain</li>
<li>more exercise ——&gt; mental health<br>less worries<br>happiness</li>
</ol>
<hr>
<h1 id="题型写法"><a href="#题型写法" class="headerlink" title="题型写法"></a>题型写法</h1><p>核心原则：让题目的key words均匀分散在文章中，特别是自己的观点，要不断出现</p>
<h2 id="key-word选取-反面对比"><a href="#key-word选取-反面对比" class="headerlink" title="key word选取+反面对比"></a>key word选取+反面对比</h2><p>删除法：删除后对句子影响很大</p>
<ol>
<li><p>A or B<br>Compared with people who live in <strong>cities</strong>, people who live in <strong>rural areas</strong> can <strong>take better care of families.</strong><br>认为A重要，对比B</p>
</li>
<li><p>A orB or C<br>If your teacher says something <strong>incorrect</strong> in a class, what will you do?  1.) <strong>Interrupt</strong> your teacher <strong>right away</strong>;  2.) keep <strong>silent</strong>;  3.) correct your <strong>teacher after class</strong>.<br>相反，interrupt/silent…</p>
</li>
<li><p>A<br>The best way for the <strong>government</strong> to improve <strong>health care</strong> is <strong>cleaning the environment.</strong><br>如果不改善环境…</p>
</li>
</ol>
<h2 id="现象题-1"><a href="#现象题-1" class="headerlink" title="现象题"></a>现象题</h2><ol>
<li>自己观点</li>
</ol>
<p><strong>Contrary to these people’s opinions is my perspective that …. due to ..</strong> (e.g. due to the contributions to果/ due to因/ including小)</p>
<ul>
<li><p>现象产生的原因:<br>  <strong>Contrary to these people’s opinions is my perspective that …</strong>, due to因<br>  eg. due to less time and capability</p>
</li>
<li><p>现象的具体体现:<br>  <strong>Contrary to these people’s opinions is my perspective that …</strong>, including小<br>  eg. including the field of environment and technology</p>
</li>
</ul>
<ol start="2">
<li>观点总结<br> <strong>To conclude, only by considering those mentioned above can we draw the conclusio that…</strong></li>
</ol>
]]></content>
      <categories>
        <category>TOEFL</category>
      </categories>
      <tags>
        <tag>TOEFL</tag>
      </tags>
  </entry>
  <entry>
    <title>TOEFL-writing-01</title>
    <url>/2021/02/18/TOEFL-writing-01/</url>
    <content><![CDATA[<h1 id="全文结构"><a href="#全文结构" class="headerlink" title="全文结构"></a>全文结构</h1><p> 开头段&lt;60&gt;<br>     总论点1&lt;160&gt;（分论点1+分论点2）<br>     总论点2&lt;160&gt;（分论点1+分论点2）<br> 结尾段&lt;60&gt;</p>
<blockquote>
<p>例1：Some students enjoy taking distance learning courses on the computer or television. Other students would rather take all of their courses with a teacher in classroom. Which is these options do you think is better?</p>
</blockquote>
<p>破题：</p>
<ol>
<li>why：理由说（在线教育为什么好）</li>
<li>切逻辑终点(good)：方面说（好在什么方面）</li>
<li>切逻辑起点(distance learning)：方面说（有哪些种在线教育）</li>
</ol>
<p>观点：在线教育好</p>
<ul>
<li>对学生学习好<ul>
<li>能获得很多的知识</li>
<li>能激发学生学习兴趣</li>
</ul>
</li>
<li>对学生个人发展好<ul>
<li>培养人际交往能力</li>
<li>培养坚持不懈</li>
</ul>
</li>
</ul>
<hr>
<h1 id="开头段"><a href="#开头段" class="headerlink" title="开头段"></a>开头段</h1><h2 id="现象引入"><a href="#现象引入" class="headerlink" title="现象引入"></a>现象引入</h2><p>N，同位语，has been valued and even triggers a heated discussion over…题目改写：</p>
<ul>
<li><p>N：</p>
<ul>
<li>话题词汇（在线教育）</li>
<li>从题目中选择的中性词汇（教育、上课方式等）</li>
</ul>
</li>
<li><p>同位语</p>
<ul>
<li>N为中性词：the fundation of a quality life</li>
<li>N为褒义词：the objective everyone strives for</li>
</ul>
</li>
<li><p>over(whether/what引导的)名词性从句</p>
</li>
</ul>
<blockquote>
<p>Education, the foundation of a quality life, <strong>has been valued and even triggers a heated discussion over</strong> whether students should take courses online or in classrooms. (现象引入)</p>
</blockquote>
<h2 id="对方观点"><a href="#对方观点" class="headerlink" title="对方观点"></a>对方观点</h2><p>主语， in some people’s view,…<br>仅需阐明现象，不用加理由</p>
<blockquote>
<p>Learning in traditional classrooms, <strong>in some people’s views</strong>, continues to be an effective way.</p>
</blockquote>
<h2 id="自己观点"><a href="#自己观点" class="headerlink" title="自己观点"></a>自己观点</h2><p>Contrary to these people’s opinions is my perspective that …, due to … (e.g. due to the contributions to果/ due to因/ including小)</p>
<blockquote>
<p><strong>Contrary to these people’s opinions is my perspective that</strong> online learning, which requires students to attend classes on computers or televisions, is superior, <strong>due to the contributions to</strong> their academic performance <strong>and</strong> personal development. (自己观点)</p>
</blockquote>
<hr>
<h1 id="中间段"><a href="#中间段" class="headerlink" title="中间段"></a>中间段</h1><h2 id="总论点1"><a href="#总论点1" class="headerlink" title="总论点1"></a>总论点1</h2><p>看图说话：在线教育对学生学习好<br>加对比和分论点</p>
<blockquote>
<p><strong>What must be prioritized is that</strong> taking distance-learning courses, instead of having courses in traditional classrooms, is beneficial to students’ academic learning, by offering them more knowledge and triggering their enthusiasm in learning. (总论点)</p>
</blockquote>
<h3 id="分论点1"><a href="#分论点1" class="headerlink" title="分论点1"></a>分论点1</h3><p>短句</p>
<blockquote>
<p>**To begin with,**it is online education that provides students with the access to a large quantity of expertises. </p>
</blockquote>
<h3 id="解释1"><a href="#解释1" class="headerlink" title="解释1"></a>解释1</h3><p>长句<br>diatance learning ——&gt; knowledge<br>理由说：有search engine<br>方面说：学生能获得什么知识</p>
<p>针对正面的论证写反面</p>
<blockquote>
<p><strong>To begin with,</strong> it is online education that provides students with the access to a large quantity of expertise. (分论点1) <strong>In detail,</strong> on the Internet, students can acquire a wide range of knowledge in history, art and science, enlarging their knowledge base; <strong>in contrast,</strong> such a large amount of knowledge cannot be obtained when they are instructed by only one teacher in concrete classrooms. (解释1+反面对比)</p>
</blockquote>
<h3 id="分论点2"><a href="#分论点2" class="headerlink" title="分论点2"></a>分论点2</h3><p>短句</p>
<blockquote>
<p><strong>Moreover,</strong> never can we ignore the significance of distance ducation to students’ interest in learning. (分论点2 ) </p>
</blockquote>
<h3 id="解释2"><a href="#解释2" class="headerlink" title="解释2"></a>解释2</h3><p>长句<br>diatance learning ——&gt; interests<br>对于学习哪些方面有兴趣</p>
<blockquote>
<p><strong>To explain it further,</strong> by receiving education on the Internet, students will find it more interesting to deal with mathematical problems, do research, and write proposals; <strong>on the other hand,</strong> will they be passionate about these tasks when teachers always lecture in brick-and-mortar classrooms? ( 解释2 )</p>
</blockquote>
<h2 id="总论点2"><a href="#总论点2" class="headerlink" title="总论点2"></a>总论点2</h2><p>personal deve.</p>
<blockquote>
<p><strong>What should be equally worth discussing is that</strong> receiving distance education, rather than having traditional face-to-face courses, can promote students’ personal development, by honing their interpersonal skills and cultivating their persistence. ( 总论点)</p>
</blockquote>
<h3 id="分论点1-1"><a href="#分论点1-1" class="headerlink" title="分论点1"></a>分论点1</h3><blockquote>
<p><strong>To begin with,</strong> it is well-acknowledged taht educated on the Internet, students can practice their communication skills.</p>
</blockquote>
<h3 id="解释1-1"><a href="#解释1-1" class="headerlink" title="解释1"></a>解释1</h3><p>distance ——&gt; interpersonal<br>为什么能够培养社交能力</p>
<blockquote>
<p><strong>Specifically,</strong> only in online learning environments will students come across peop;e from diverse backgrounds, such as classmates, instructors and school administrators, with whom they can practice their tactics of socializing; <strong>on the contrary</strong>, under no circumstances will they interact with such a variety of people if they are educated in traditional classroom settings.</p>
</blockquote>
<h3 id="分论点2-1"><a href="#分论点2-1" class="headerlink" title="分论点2"></a>分论点2</h3><p>distance learning ——&gt; persistence<br>理由说：为什么会变的persistence</p>
<blockquote>
<p><strong>Additionally</strong>, when having a distance education program,students will become more determined. ( 分论点2 ) </p>
</blockquote>
<h3 id="解释2-1"><a href="#解释2-1" class="headerlink" title="解释2"></a>解释2</h3><p><strong>To be more specific</strong>, the more distance-learning courses they take on the Internet, the more distractions they will be exposed to, stimulating them to resist temptations and foster their persistence; however, it is impossible for them to encounter these lures in traditional classrooms.</p>
<h1 id="结尾段"><a href="#结尾段" class="headerlink" title="结尾段"></a>结尾段</h1><blockquote>
<p>Academic performance, <strong>the foundation of students’ future development</strong>, will be boosted when they receive online education. (总结总论点1) Personal development, <strong>essential contributors to students’ future success</strong>, will be<br>facilitated, if they are educated on the Internet. (总结总论<br>点2) <strong>To conclude, only by</strong> having distance education,<br><strong>instead of</strong> being taught in classrooms, <strong>can</strong> students reap numerous benefits. (总结全文)</p>
</blockquote>
<h1 id="模板总结"><a href="#模板总结" class="headerlink" title="模板总结"></a>模板总结</h1><h2 id="开头段-1"><a href="#开头段-1" class="headerlink" title="开头段"></a>开头段</h2><ol>
<li>…, 同位语, has been valued and even triggers a heated discussion over …</li>
<li>…, in some/many people’s view,…</li>
<li>Contrary to these people’s opinions is my perspective that …, due to the contributions to … and …<h2 id="中间段-1"><a href="#中间段-1" class="headerlink" title="中间段"></a>中间段</h2></li>
<li>What must be prioritized is that … /What is equally worth discussion is that…</li>
<li>Initially/ Firstly /To begin with,</li>
<li>To be more specific, /Specifically, / In detail, /To explain it further… + however, /in contrast, /on the contrary,/on the other hand,<h2 id="结尾段-1"><a href="#结尾段-1" class="headerlink" title="结尾段"></a>结尾段</h2></li>
<li>第一个理由，同位语，will…</li>
<li>第二个理由，同位语，will…</li>
<li>In conclusion, only + 状语 + 半倒装</li>
</ol>
]]></content>
      <categories>
        <category>TOEFL</category>
      </categories>
      <tags>
        <tag>TOEFL</tag>
      </tags>
  </entry>
  <entry>
    <title>TOEFL-writing-02</title>
    <url>/2021/02/20/TOEFL-writing-02/</url>
    <content><![CDATA[<h1 id="笔记概述"><a href="#笔记概述" class="headerlink" title="笔记概述"></a>笔记概述</h1><ol>
<li>专有名词<br> 固定说法，很难找到同义词的名词（eg. 电脑、台灯…）</li>
<li>意思（逻辑）<br>转折逻辑: however, but, although<br>并列逻辑: and, also, moreover, in addition<br>总分逻辑: such as, for example, one of which<br>因果逻辑: because, so, thus, therefore<br>顺序逻辑: first, and then, when, after</li>
</ol>
<hr>
<h1 id="阅读笔记"><a href="#阅读笔记" class="headerlink" title="阅读笔记"></a>阅读笔记</h1><p>topic sentence关键词：支持topic sentence的专有名词</p>
<h2 id="开头段："><a href="#开头段：" class="headerlink" title="开头段："></a>开头段：</h2><p>主题词，（3个）xxx（reason,goal…）</p>
<h2 id="中间段："><a href="#中间段：" class="headerlink" title="中间段："></a>中间段：</h2><p>如果有小标题，小标题就是TS<br>细节只记录支持TS的名词</p>
<hr>
<h1 id="听力笔记"><a href="#听力笔记" class="headerlink" title="听力笔记"></a>听力笔记</h1><p><strong>脑记意思</strong><br>（主）对比专名<br>（次）逻辑符号<br>竖着写，每行一个词</p>
<h2 id="开头段"><a href="#开头段" class="headerlink" title="开头段"></a>开头段</h2><p>记录男女<br>关注主旨句</p>
<h2 id="中间段"><a href="#中间段" class="headerlink" title="中间段"></a>中间段</h2><p>听，脑记意思，听听力是如何<strong>反驳阅读内容</strong><br>笔,仅记录<strong>反驳阅读的专有名词</strong>，即对比专名，和<strong>明显简单的逻辑</strong>，一定要筛选信息<br>适当<strong>缩写</strong>，不要试图把单词都能拼写完整</p>
<hr>
<h1 id="补笔记"><a href="#补笔记" class="headerlink" title="补笔记"></a>补笔记</h1><p>按照第三段、第一段、第二段的顺序串意思、单词记全</p>
]]></content>
      <categories>
        <category>TOEFL</category>
      </categories>
      <tags>
        <tag>TOEFL</tag>
      </tags>
  </entry>
  <entry>
    <title>TOEFL-writing-03</title>
    <url>/2021/02/20/TOEFL-writing-03/</url>
    <content><![CDATA[]]></content>
  </entry>
  <entry>
    <title>RNA-seq: Spike-in/Housekeeping gene normalization</title>
    <url>/2021/03/04/RNA-seq-Spike-in-Housekeeping-gene-normalization/</url>
    <content><![CDATA[<p><strong>RNA-seq基本假设：</strong>  </p>
<ul>
<li> 绝大多数基因不发生表达量的变化  </li>
<li> 特别高表达的基因不发生表达量的变化</li>
</ul>
<p><strong>若不满足以上基本假设（癌旁组织等）：</strong>  </p>
<ol>
<li>使用ERCC RNA spike-ins，绝对定量，假设样本间ERCC的量相同  </li>
<li>假设housekeeping基因表达量变化量不大  </li>
</ol>
<hr>
<p><strong>ERCC(External RNA Controls Consortium, 外源RNA-SEQ标准库)</strong><br>建库时掺入外源rna，因为知道它的绝对量，可以计算<br>很贵<br>两种比例：Mix1，Mix2<br>分析思路：  </p>
<ul>
<li>与普通的RNA-Seq数据分析流程基本一致  </li>
<li>在构建Reference的时候需要把ERCC spike-in的序列一起添加到参考基因组，一起构建比对软件如HISAT2, STAR等的index文件;  </li>
<li>下游使用软件分析，认为sample之间spike-in的量是恒定相等的  </li>
<li>官网上下载后整理成fasta，贴到染色体后面，在构建index时把ERCC构建进去  </li>
</ul>
<hr>
<p><strong>Housekeeping gene</strong><br>RUVSeq package (Bioconductor)<br>在不同组织、器官、不同刺激下都表达，3000-4000个<br>2013-Trend in Genetics-Human housekeeping genes revisited 可以下载list of housekeeping gene  </p>
<ul>
<li>假设：sample之间housekeeping之间的表达量基本不发生变化——&gt;校正（不需要再用Quantile,RLE,TMM等做校正） </li>
<li>本质: 是对RNA-Seq数据进行矫正(Normalization),矫正过后的count数据，可以正常进行差异表达分析，如使用edgeR或者DESeq2等  </li>
<li>输入：原始表达矩阵+认为不变的gene id list   </li>
<li>输出：经过校正的表达矩阵（count/FPKM/TPM/CPM…)      </li>
</ul>
<hr>
<h1 id="spike-in-or-housekeeping-gene-normalization"><a href="#spike-in-or-housekeeping-gene-normalization" class="headerlink" title="spike-in or housekeeping gene normalization"></a>spike-in or housekeeping gene normalization</h1><figure class="highlight r"><table><tr><td class="code"><pre><span class="line">rm(<span class="built_in">list</span>=ls())</span><br><span class="line"></span><br><span class="line"><span class="comment"># BiocManager::install(&quot;RUVSeq&quot;)</span></span><br><span class="line">library(Biobase)</span><br><span class="line">library(BiocGenerics)</span><br><span class="line">library(parallel)</span><br><span class="line">library(EDASeq)</span><br><span class="line">library(ShortRead)</span><br><span class="line">library(BiocParallel)</span><br><span class="line">library(Biostrings)</span><br><span class="line">library(S4Vectors)</span><br><span class="line">library(stats4)</span><br><span class="line">library(IRanges)</span><br><span class="line">library(XVector)</span><br><span class="line">library(Rsamtools)</span><br><span class="line">library(GenomeInfoDb)</span><br><span class="line">library(GenomicAlignments)</span><br><span class="line">library(SummarizedExperiment)</span><br><span class="line">library(MatrixGenerics)</span><br><span class="line">library(matrixStats)</span><br><span class="line">library(edgeR)</span><br><span class="line">library(limma)</span><br><span class="line">library(RUVSeq)</span><br></pre></td></tr></table></figure>


<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">setwd(<span class="string">&quot;C:/Users/Surface/Desktop/Meng&#x27;s Lesson/RNA-seq/20200926-第5次直播-相关代码_数据_结果/20200926-第5次直播-相关代码_数据_结果/&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># load raw count table </span></span><br><span class="line">count_df &lt;- read.table(file = <span class="string">&quot;./293T-RNASeq-Ctrl_vs_KD.STAR.hg38.featureCounts.FixColName.tsv&quot;</span>,header = <span class="built_in">T</span>,sep = <span class="string">&quot;\t&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># load housekeeping gene list</span></span><br><span class="line">hsk_gene_df &lt;- read.table(file = <span class="string">&quot;./human_housekeeping_gene_list.txt&quot;</span>,header = <span class="built_in">T</span>,sep = <span class="string">&quot;\t&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># check in list gene number</span></span><br><span class="line"><span class="comment"># 95 genes not in the new version of housekeeping gene</span></span><br><span class="line">table(hsk_gene_df$gene_id %in% rownames(count_df))</span><br><span class="line"></span><br><span class="line"><span class="comment"># select Housekeeping gene list</span></span><br><span class="line">hsk_gene_id.count &lt;- count_df[rownames(count_df) %in% hsk_gene_df$gene_id,]</span><br><span class="line">hsk_gene_id.list &lt;- rownames(count_df)[rownames(count_df) %in% hsk_gene_df$gene_id]</span><br><span class="line"></span><br><span class="line"><span class="comment"># select upper 100~200</span></span><br><span class="line">mean.value &lt;- apply(hsk_gene_id.count, <span class="number">1</span>, mean)</span><br><span class="line"></span><br><span class="line">hsk_gene_id.list.select &lt;- hsk_gene_id.list[order(mean.value,decreasing = <span class="built_in">T</span>)][<span class="number">800</span>:<span class="number">1000</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># make sample info table</span></span><br><span class="line">sample_df &lt;- data.frame(</span><br><span class="line">  condition = as.factor(<span class="built_in">c</span>(<span class="built_in">rep</span>(<span class="string">&quot;ctrl&quot;</span>,<span class="number">2</span>), <span class="built_in">rep</span>(<span class="string">&quot;KD&quot;</span>,<span class="number">2</span>))),</span><br><span class="line">  row.names = colnames(count_df)</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># make obj</span></span><br><span class="line">set.obj &lt;- newSeqExpressionSet(counts = as.matrix(count_df), phenoData = sample_df)</span><br><span class="line">set.obj</span><br><span class="line"></span><br><span class="line">plotPCA(set.obj)</span><br><span class="line">plotRLE(set.obj,ylim=<span class="built_in">c</span>(-<span class="number">1</span>,<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># normalize by housekeeping gene</span></span><br><span class="line">set.norm.obj &lt;- RUVg(set.obj, hsk_gene_id.list.select, k=<span class="number">2</span>)</span><br><span class="line">plotPCA(set.norm.obj)</span><br><span class="line">plotRLE(set.norm.obj,ylim=<span class="built_in">c</span>(-<span class="number">1</span>,<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># check normal count</span></span><br><span class="line">count_df.norm_hsk &lt;- normCounts(set.norm.obj)</span><br><span class="line">head(count_df.norm_hsk)</span><br><span class="line"></span><br><span class="line"><span class="comment"># check normalize colSums count</span></span><br><span class="line">colSums(count_df)</span><br><span class="line">colSums(count_df.norm_hsk)</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h1 id="find-DEGs-with-edgeR"><a href="#find-DEGs-with-edgeR" class="headerlink" title="find DEGs with edgeR"></a>find DEGs with edgeR</h1><p>差异表达分析步骤：  </p>
<ol>
<li>normalization  </li>
<li>estimate dispersion  </li>
<li>fit and find DEGs  </li>
</ol>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment"># condition table</span></span><br><span class="line">group_info = <span class="built_in">c</span>(<span class="built_in">rep</span>(<span class="string">&quot;ctrl&quot;</span>,<span class="number">2</span>), <span class="built_in">rep</span>(<span class="string">&quot;KD&quot;</span>,<span class="number">2</span>))</span><br><span class="line">design.mat &lt;- model.matrix(~group_info)</span><br><span class="line"></span><br><span class="line"><span class="comment"># build obj</span></span><br><span class="line">dge.list.obj &lt;- DGEList(counts = normCounts(set.norm.obj), group = group_info)</span><br><span class="line">dge.list.obj</span><br><span class="line"></span><br><span class="line">dge.list.obj &lt;- calcNormFactors(dge.list.obj,method = <span class="string">&quot;upperquartile&quot;</span>)</span><br><span class="line">dge.list.obj$samples</span><br><span class="line"></span><br><span class="line"><span class="comment"># Norm -&gt; estimate dispersion -&gt; find DEGs</span></span><br><span class="line">dge.list.obj &lt;- estimateDisp(dge.list.obj,design.mat)</span><br><span class="line">dge.list.obj$common.dispersion</span><br><span class="line">head(dge.list.obj$tagwise.dispersion)</span><br><span class="line"></span><br><span class="line"><span class="comment"># find DEGs</span></span><br><span class="line">fit &lt;- glmFit(dge.list.obj, design.mat)</span><br><span class="line">lrt &lt;- glmLRT(fit, coef=<span class="number">2</span>)</span><br><span class="line">DEGs.res.lrt &lt;- as.data.frame(topTags(lrt,n=nrow(count_df.norm_hsk),sort.by = <span class="string">&quot;logFC&quot;</span>))</span><br><span class="line">head(DEGs.res.lrt)</span><br></pre></td></tr></table></figure>
<p>可以发现，FDR基本上都等于1<br>原因：用的管家基因太多了<br>解决：找变化最小的100，200个来做  </p>
]]></content>
      <categories>
        <category>RNA-seq</category>
      </categories>
      <tags>
        <tag>RNA-seq</tag>
      </tags>
  </entry>
  <entry>
    <title>Troubleshooting</title>
    <url>/2021/02/04/Troubleshooting/</url>
    <content><![CDATA[<h2 id="【R】"><a href="#【R】" class="headerlink" title="【R】"></a>【R】</h2><ol>
<li><p>20200312<br>outlierKD(final_ns$CS.lymph.nodes..2004..,lymph)</p>
<blockquote>
<p>报错：$ operator is invalid for atomic vectors<br>解决：赋值给对象后在放入函数<br>lymph &lt;- final_ns$CS.lymph.nodes..2004..<br>outlierKD(final_ns,lymph)</p>
</blockquote>
</li>
<li><p>20200504<br>最无语最神经病的报错！！<br>kk &lt;- paste(“Surv(final_dat$Survival.months, final_dat$status)”,insertVar,sep=”~”);<br>fit_insertVar &lt;- survfit(as.formula(kk),data = final_dat)</p>
<blockquote>
<p>报错：找不到对象kk<br>解决：两个&lt;&lt;表示将kk设在全局<br>kk &lt;&lt;- paste(“Surv(final_dat$Survival.months, final_dat$status)”,insertVar,sep=”~”);</p>
</blockquote>
</li>
<li><p>201128<br>BiocManager::install(“hgu133a2.db”)</p>
<blockquote>
<p>Warning：installation of package ‘hgu133a2.db’ had non-zero exit status<br>解决：一般是依赖包的问题，先加载完所有的dependency就可以library了</p>
</blockquote>
</li>
<li><p>201224<br>BiocManager::install(“DOSE”)</p>
<blockquote>
<p>Warning message:<br>In file.copy(savedcopy, lib, recursive = TRUE) :<br>拷贝C:\Users\Surface\Documents\R\win-library\4.0\00LOCK\vctrs\libs\x64\vctrs.dll到C:\Users\Surface\Documents\R\win-library\4.0\vctrs\libs\x64\vctrs.dll时出了问题：Permission denied<br>解决：依赖的包现在正在环境下使用，需要把它先<code>detach()</code>，再安装</p>
</blockquote>
</li>
<li><p>210103<br>有的时候RStudio会突然卡住，只有右上角的最小化、关闭、窗口大小可以点，这个时候点一下那个窗口大小，再全屏一下就可以了，超级神奇</p>
</li>
<li><p>210201<br>BiocManager::install()</p>
<blockquote>
<p>Installation path not writeable, unable to update packages: boot, class,<br>codetools, foreign, KernSmooth, Matrix, nlme, nnet, spatial<br>解决：installed.packages()[, c(“Package”, “LibPath”)] 来查看所有的R包位置。<br>Sys.chmod(“file”,’777’) 设置装在哪里，其中file是你R包安装的位置</p>
</blockquote>
</li>
</ol>
<h2 id="【Python】"><a href="#【Python】" class="headerlink" title="【Python】"></a>【Python】</h2><ol>
<li>201128<blockquote>
<p>报错：python SyntaxError: EOL while scanning string literal<br>错误原因：字符串以 \ 结尾 或者字符串缺少引号。</p>
</blockquote>
</li>
</ol>
<h2 id="【Perl】"><a href="#【Perl】" class="headerlink" title="【Perl】"></a>【Perl】</h2><p>—To Be Continue—</p>
]]></content>
      <categories>
        <category>Records</category>
      </categories>
      <tags>
        <tag>Debug</tag>
      </tags>
  </entry>
  <entry>
    <title>RNA-seq: GSEA &amp; ssGSEA</title>
    <url>/2021/03/08/RNA-seq-GSEA-ssGSEA/</url>
    <content><![CDATA[<h1 id="GSEA（Gene-Set-Enrichment-Analysis）"><a href="#GSEA（Gene-Set-Enrichment-Analysis）" class="headerlink" title="GSEA（Gene Set Enrichment Analysis）"></a><strong>GSEA（Gene Set Enrichment Analysis）</strong></h1><p>该方法发表于2005年的<a href="https://www.pnas.org/content/pnas/102/43/15545.full.pdf">Gene set enrichment analysis: a knowledge-based approach forinterpreting genome-wide expression profiles</a>，是一种基于基因集的富集分析方法。</p>
<p>在对基因表达数据分析时，首先确定分析的目的，即选择MSigDB中的一个或多个功能基因集进行分析，然后基于基因表达数据与表型的关联度（也可以理解为表达量的变化）的大小进行排序。然后判断每个基因集内的基因是否富集于表型相关度排序后基因列表的上部或下部，从而判断此基因集内基因的协同变化对表型变化的影响。</p>
<p><img src="/img/article/RNA-seq/GSEA.png" alt="GSEA"></p>
<p>GSEA的输入是一个基因表达量矩阵，其中的样本分成了A和B两组，找到两组之间差异表达的基因，然后根据foldchange进行排序，用来表示基因在两组间表达量的变化趋势。排序之后的基因列表其顶部可以看做是上调的差异基因，其底部是下调的差异基因。GSEA分析的是一个基因集下的所有基因是否在这个排序列表的顶部或者底部富集，如果在顶部富集，我们可以说，从总体上看，该基因集是上调趋势，反之，如果在底部富集，则是下调趋势。</p>
<h1 id="ssGSEA-single-sample-Gene-Set-Enrichment-Analysis）"><a href="#ssGSEA-single-sample-Gene-Set-Enrichment-Analysis）" class="headerlink" title="ssGSEA(single sample Gene Set Enrichment Analysis）"></a><strong>ssGSEA(single sample Gene Set Enrichment Analysis）</strong></h1><ul>
<li><p>定义：</p>
</li>
<li><p>原理：</p>
</li>
<li><p>实现：</p>
</li>
<li><p>输入文件：</p>
</li>
<li></li>
</ul>
]]></content>
      <categories>
        <category>RNA-seq</category>
      </categories>
      <tags>
        <tag>RNA-seq</tag>
      </tags>
  </entry>
</search>
